<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title class=title>Matroshka | ¬¨ just serendipity üçÄ</title><meta name=title content="Matroshka">
<meta name=description content="Recentemente participei de uma
CTF promovida pelo
ELT (Epic Leet Team). Uma das challs que consegui
resolver completamente foi a matroshka, e aqui est√° um breve write-up
sobre a mesma.
Dado um arquivo matroshka.tar.gz, precis√°vamos encontrar a flag.
N√£o era dif√≠cil desconfiar do que esse arquivo / chall se tratava: matroshkas
s√£o aquelas bonecas russas que se encaixam umas dentro das outras. Ent√£o&mldr;de
cara, logo j√° desconfiei: provavelmente existe um arquivo compactado dentro de
outro, dentro de outro, dentro de outro, e assim por diante&mldr;"><meta name=keywords content="dev,linux,pt,"><meta property="og:url" content="https://perrotta.dev/2016/10/matroshka/"><meta property="og:site_name" content="¬¨ just serendipity üçÄ"><meta property="og:title" content="Matroshka"><meta property="og:description" content="Recentemente participei de uma CTF promovida pelo ELT (Epic Leet Team). Uma das challs que consegui resolver completamente foi a matroshka, e aqui est√° um breve write-up sobre a mesma.
Dado um arquivo matroshka.tar.gz, precis√°vamos encontrar a flag.
N√£o era dif√≠cil desconfiar do que esse arquivo / chall se tratava: matroshkas s√£o aquelas bonecas russas que se encaixam umas dentro das outras. Ent√£o‚Ä¶de cara, logo j√° desconfiei: provavelmente existe um arquivo compactado dentro de outro, dentro de outro, dentro de outro, e assim por diante‚Ä¶"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-10-16T15:49:01-02:00"><meta property="article:modified_time" content="2016-10-16T15:49:01-02:00"><meta property="article:tag" content="Dev"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Pt"><meta name=twitter:card content="summary"><meta name=twitter:title content="Matroshka"><meta name=twitter:description content="Recentemente participei de uma CTF promovida pelo ELT (Epic Leet Team). Uma das challs que consegui resolver completamente foi a matroshka, e aqui est√° um breve write-up sobre a mesma.
Dado um arquivo matroshka.tar.gz, precis√°vamos encontrar a flag.
N√£o era dif√≠cil desconfiar do que esse arquivo / chall se tratava: matroshkas s√£o aquelas bonecas russas que se encaixam umas dentro das outras. Ent√£o‚Ä¶de cara, logo j√° desconfiei: provavelmente existe um arquivo compactado dentro de outro, dentro de outro, dentro de outro, e assim por diante‚Ä¶"><meta itemprop=name content="Matroshka"><meta itemprop=description content="Recentemente participei de uma CTF promovida pelo ELT (Epic Leet Team). Uma das challs que consegui resolver completamente foi a matroshka, e aqui est√° um breve write-up sobre a mesma.
Dado um arquivo matroshka.tar.gz, precis√°vamos encontrar a flag.
N√£o era dif√≠cil desconfiar do que esse arquivo / chall se tratava: matroshkas s√£o aquelas bonecas russas que se encaixam umas dentro das outras. Ent√£o‚Ä¶de cara, logo j√° desconfiei: provavelmente existe um arquivo compactado dentro de outro, dentro de outro, dentro de outro, e assim por diante‚Ä¶"><meta itemprop=datePublished content="2016-10-16T15:49:01-02:00"><meta itemprop=dateModified content="2016-10-16T15:49:01-02:00"><meta itemprop=wordCount content="639"><meta itemprop=keywords content="Dev,Linux,Pt"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/2016/10/matroshka/><style>:root{--color-gray:#888;--color-grayer:#666;--font-title:'Inter', 'Fira Sans', 'Lato', system-ui, -apple-system, BlinkMacSystemFont, 'Avenir Next', 'Avenir', 'Segoe UI', 'Helvetica Neue', Helvetica, Ubuntu, Roboto, Noto, Cantarell, Arial, sans-serif;--font-body:'Crimson Pro', 'Vollkorn', 'Alegreya', 'Iowan Old Style', 'Apple Garamond', 'Baskerville', 'Times New Roman', 'Noto Serif', 'Droid Serif', 'Times', 'Source Serif Pro', serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';--font-code:'Fira Code', 'PT Mono', 'IBM Plex Mono', Menlo, Consolas, Monaco, 'Liberation Mono', 'Ubuntu Mono', 'Lucida Console', monospace}body{font-family:var(--font-body);font-size:21px;margin:auto;padding:20px;max-width:840px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,strong,b{color:#222;line-height:1.2}h1{font-size:2.5rem}h2{font-size:2rem}h3{font-size:1.75rem}h4{font-size:1.5rem}h5,h6{font-size:1.25rem}h1,h2,h3,h4,h5,h6,footer,nav{font-family:var(--font-title)}footer{font-size:smaller;padding:8px;text-align:center}a{color:#3273dc}a.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.4}table{width:100%}img{max-width:100%}code{padding:3px 6px;background-color:#f2f2f2}li code,p code{font-size:.9em}pre code{color:#222;display:block;padding:25px;white-space:pre;font-size:17px;overflow-x:auto}code,pre{font-family:var(--font-code)}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:2px solid #999;color:#222;padding-left:25px;padding-right:15px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex;gap:8px;margin-bottom:8px}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}.pubdate-list{color:var(--color-gray);font-style:italic}.pubdate-single{color:var(--color-gray);font-style:italic}.social-link-wrapper{display:flex;justify-content:center;align-items:center;gap:8px;margin-top:8px}.social-link{text-decoration:none;font-size:1.4em}sup.gray{color:var(--color-gray)}.title{font-size:38px}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h1 class=title>¬¨ just serendipity üçÄ</h1></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>‚òÖ</a></nav></header><main><h2>Matroshka</h2><p><span class=pubdate-single><time datetime=2016-10-16 pubdate>16 Oct, 2016
</time>‚Ä¢ 639 words
‚Ä¢ 3 min</span></p><content><p>Recentemente participei de uma
<a href=https://ctf.tecland.com.br/Pwn2Win/game/scoreboard/>CTF</a> promovida pelo
<a href=https://ctf-br.org/elt>ELT</a> (Epic Leet Team). Uma das <em>challs</em> que consegui
resolver completamente foi a <strong>matroshka</strong>, e aqui est√° um breve <em>write-up</em>
sobre a mesma.</p><p>Dado um arquivo <code>matroshka.tar.gz</code>, precis√°vamos encontrar a <em>flag</em>.</p><p>N√£o era dif√≠cil desconfiar do que esse arquivo / <em>chall</em> se tratava: matroshkas
s√£o aquelas bonecas russas que se encaixam umas dentro das outras. Ent√£o&mldr;de
cara, logo j√° desconfiei: provavelmente existe um arquivo compactado dentro de
outro, dentro de outro, dentro de outro, e assim por diante&mldr;</p><p>Por experi√™ncia, n√£o valeria a pena tentar descompactar tudo manualmente, pois
sabe-se l√° quantos n√≠veis de compacta√ß√£o esse neg√≥cio iria ter (provavelmente
mais do que 100).</p><p>De cara logo pensei em usar o <a href=https://brettcsmith.org/2007/dtrx/>dtrx</a>, que √©
um excelente programa (n√£o perco tempo e sempre rodo um <code>port install dtrx</code>)
para extrair arquivos sem ter que ficar se lembrando das sintaxes individuais de
cada programa. Nesse caso, n√£o iria rolar: os arquivos eram renomeados de forma
a <em>trickear</em> o dtrx, que funciona atrav√©s de heur√≠sticas, uma delas √© a
&rsquo;extens√£o&rsquo; do nome do arquivo. Por exemplo, v√°rios arquivos (ap√≥s
descompactados) eram renomeados na forma <code>*.elt</code>.</p><p>A segunda alternativa foi (<strong>serendipidade</strong>, n√£o conhecia essa ferramenta
antes) tentar utilizar o <a href=http://www.nongnu.org/atool/>atool</a>. Por motivos
similares ao <code>dtrx</code>, n√£o rolou.</p><p>Pois bem, ent√£o o jeito ia ser descompactar tudo na marra. Pensei em escrever um
programa que faria o seguinte:</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#c678dd>try</span> {
</span></span><span style=display:flex><span>	<span style=color:#e06c75>unzip</span> <span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>file</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#c678dd>catch</span> {
</span></span><span style=display:flex><span>	<span style=color:#c678dd>try</span> {
</span></span><span style=display:flex><span>		<span style=color:#e06c75>tar</span> <span style=color:#e06c75>xf</span> <span style=color:#56b6c2>&lt;</span><span style=color:#e06c75>file</span><span style=color:#56b6c2>&gt;</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#c678dd>catch</span> {
</span></span><span style=display:flex><span>		<span style=color:#7f848e>// ...e assim por diante
</span></span></span><span style=display:flex><span><span style=color:#7f848e></span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Obviamente eu utilizaria os programas diretamente, ent√£o a coisa poderia ficar
um pouco mais simples, utilizando os return codes dos mesmos para detectar se
descompactaram o arquivo com sucesso. Por exemplo, <code>tar xf &lt;file></code> retorna <code>0</code>
se rodou corretamente, do contr√°rio ele retorna algo diferente de zero. Isso se
mostrou v√°lido para todos os programas de descompacta√ß√£o que utilizei, exceto o
lha, que insistia em retornar <code>0</code> de qualquer jeito, mesmo quando falhava.</p><p>Para automatizar essa tarefa, resolvi utilizar <code>python2</code>. <code>C/C++</code> provavelmente
tamb√©m seriam bons candidatos, mas eu queria praticar o meu <code>python</code>.</p><p>Ap√≥s algumas inspe√ß√µes, notei que cada arquivo continha um e somente um arquivo
dentro dele, ent√£o a ideia base seria:</p><ul><li>mantenha uma lista com todos os arquivos conhecidos at√© ent√£o (no come√ßo, s√≥
haveria um);</li><li>descompacte esse arquivo;</li><li>detecte qual arquivo acabou de ser descompactado</li><li>continue fazendo isso at√© encontrar a <code>flag</code></li></ul><p>Meu c√≥digo ficou assim:</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#7f848e>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>os</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>import</span> <span style=color:#e06c75>subprocess</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>TARGET_DIR</span> <span style=color:#56b6c2>=</span> <span style=color:#98c379>&#39;mat&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>uncompress_kgb</span>(<span style=color:#e06c75>file</span>):
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;kgb&#34;</span>, <span style=color:#e06c75>file</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>uncompress_gzip</span>(<span style=color:#e06c75>file</span>):
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;gunzip&#34;</span>, <span style=color:#98c379>&#34;-S&#34;</span>, <span style=color:#98c379>&#39;.&#39;</span> <span style=color:#56b6c2>+</span> <span style=color:#e06c75>file</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>split</span>(<span style=color:#98c379>&#39;.&#39;</span>)[<span style=color:#56b6c2>-</span><span style=color:#d19a66>1</span>], <span style=color:#e06c75>file</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>uncompress_tar</span>(<span style=color:#e06c75>file</span>):
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;tar&#34;</span>, <span style=color:#98c379>&#34;xvf&#34;</span>, <span style=color:#e06c75>file</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>uncompress_rar</span>(<span style=color:#e06c75>file</span>):
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;unrar&#34;</span>, <span style=color:#98c379>&#34;x&#34;</span>, <span style=color:#e06c75>file</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>uncompress_lha</span>(<span style=color:#e06c75>file</span>):
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;lha&#34;</span>, <span style=color:#98c379>&#34;e&#34;</span>, <span style=color:#e06c75>file</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>uncompress_zip</span>(<span style=color:#e06c75>file</span>):
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;unzip&#34;</span>, <span style=color:#e06c75>file</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>uncompress_arj</span>(<span style=color:#e06c75>file</span>):
</span></span><span style=display:flex><span>    <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;cp&#34;</span>, <span style=color:#e06c75>file</span>, <span style=color:#e06c75>file</span> <span style=color:#56b6c2>+</span> <span style=color:#98c379>&#34;.arj&#34;</span>])
</span></span><span style=display:flex><span>    <span style=color:#e06c75>err</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;arj&#34;</span>, <span style=color:#98c379>&#34;x&#34;</span>, <span style=color:#e06c75>file</span>])
</span></span><span style=display:flex><span>    <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;rm&#34;</span>, <span style=color:#e06c75>file</span> <span style=color:#56b6c2>+</span> <span style=color:#98c379>&#34;.arj&#34;</span>])
</span></span><span style=display:flex><span>    <span style=color:#c678dd>return</span> <span style=color:#e06c75>err</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>uncompress_7z</span>(<span style=color:#e06c75>file</span>):
</span></span><span style=display:flex><span>    <span style=color:#e06c75>subprocess</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>call</span>([<span style=color:#98c379>&#34;7z&#34;</span>, <span style=color:#98c379>&#34;x&#34;</span>, <span style=color:#e06c75>file</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>def</span> <span style=color:#61afef;font-weight:700>colorprint</span>(<span style=color:#e06c75>s</span>):
</span></span><span style=display:flex><span>    <span style=color:#e5c07b>print</span> <span style=color:#98c379>&#39;</span><span style=color:#98c379>\033</span><span style=color:#98c379>[93m&#39;</span> <span style=color:#56b6c2>+</span> <span style=color:#e5c07b>repr</span>(<span style=color:#e06c75>s</span>) <span style=color:#56b6c2>+</span> <span style=color:#98c379>&#39;</span><span style=color:#98c379>\033</span><span style=color:#98c379>[0m&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>os</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>chdir</span>(<span style=color:#e06c75>TARGET_DIR</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e06c75>base</span> <span style=color:#56b6c2>=</span> <span style=color:#e5c07b>set</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>while</span> <span style=color:#e5c07b>True</span>:
</span></span><span style=display:flex><span>    <span style=color:#e06c75>newbase</span> <span style=color:#56b6c2>=</span> <span style=color:#e5c07b>set</span>(<span style=color:#e06c75>os</span><span style=color:#56b6c2>.</span><span style=color:#e06c75>listdir</span>(<span style=color:#98c379>&#39;.&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>diff</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>newbase</span> <span style=color:#56b6c2>-</span> <span style=color:#e06c75>base</span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>colorprint</span>(<span style=color:#e06c75>diff</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>if</span> <span style=color:#e5c07b>len</span>(<span style=color:#e06c75>diff</span>) <span style=color:#56b6c2>&gt;</span> <span style=color:#d19a66>1</span>:
</span></span><span style=display:flex><span>        <span style=color:#c678dd>raise</span> <span style=color:#e06c75>Exception</span>(<span style=color:#98c379>&#34;len(diff) &gt; 1&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c678dd>elif</span> <span style=color:#e5c07b>len</span>(<span style=color:#e06c75>diff</span>) <span style=color:#56b6c2>==</span> <span style=color:#d19a66>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>print</span> <span style=color:#98c379>&#34;len(diff) == 0&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#c678dd>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c678dd>for</span> <span style=color:#e06c75>file</span> <span style=color:#56b6c2>in</span> <span style=color:#e06c75>diff</span>:
</span></span><span style=display:flex><span>        <span style=color:#e06c75>err</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>uncompress_kgb</span>(<span style=color:#e06c75>file</span>)
</span></span><span style=display:flex><span>        <span style=color:#c678dd>if</span> <span style=color:#e06c75>err</span> <span style=color:#56b6c2>!=</span> <span style=color:#d19a66>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#e06c75>err</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>uncompress_gzip</span>(<span style=color:#e06c75>file</span>)
</span></span><span style=display:flex><span>            <span style=color:#c678dd>if</span> <span style=color:#e06c75>err</span> <span style=color:#56b6c2>!=</span> <span style=color:#d19a66>0</span>:
</span></span><span style=display:flex><span>                <span style=color:#e06c75>err</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>uncompress_tar</span>(<span style=color:#e06c75>file</span>)
</span></span><span style=display:flex><span>                <span style=color:#c678dd>if</span> <span style=color:#e06c75>err</span> <span style=color:#56b6c2>!=</span> <span style=color:#d19a66>0</span>:
</span></span><span style=display:flex><span>                    <span style=color:#e06c75>err</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>uncompress_rar</span>(<span style=color:#e06c75>file</span>)
</span></span><span style=display:flex><span>                    <span style=color:#c678dd>if</span> <span style=color:#e06c75>err</span> <span style=color:#56b6c2>!=</span> <span style=color:#d19a66>0</span>:
</span></span><span style=display:flex><span>                        <span style=color:#e06c75>err</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>uncompress_zip</span>(<span style=color:#e06c75>file</span>)
</span></span><span style=display:flex><span>                        <span style=color:#c678dd>if</span> <span style=color:#e06c75>err</span> <span style=color:#56b6c2>!=</span> <span style=color:#d19a66>0</span>:
</span></span><span style=display:flex><span>                            <span style=color:#e06c75>err</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>uncompress_arj</span>(<span style=color:#e06c75>file</span>)
</span></span><span style=display:flex><span>                            <span style=color:#c678dd>if</span> <span style=color:#e06c75>err</span> <span style=color:#56b6c2>!=</span> <span style=color:#d19a66>0</span>:
</span></span><span style=display:flex><span>                                <span style=color:#e06c75>err</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>uncompress_7z</span>(<span style=color:#e06c75>file</span>)
</span></span><span style=display:flex><span>                                <span style=color:#c678dd>if</span> <span style=color:#e06c75>err</span> <span style=color:#56b6c2>!=</span> <span style=color:#d19a66>0</span>:
</span></span><span style=display:flex><span>                                    <span style=color:#e06c75>err</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>uncompress_lha</span>(<span style=color:#e06c75>file</span>)
</span></span><span style=display:flex><span>                                    <span style=color:#c678dd>if</span> <span style=color:#e06c75>err</span> <span style=color:#56b6c2>!=</span> <span style=color:#d19a66>0</span>:
</span></span><span style=display:flex><span>                                        <span style=color:#e5c07b>print</span> <span style=color:#98c379>&#34;lha fail&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e06c75>base</span> <span style=color:#56b6c2>=</span> <span style=color:#e06c75>newbase</span>
</span></span></code></pre></div><p>Essa ideia funcionou bastante bem. A √∫nica coisa <em>overkill</em> foi que eu n√£o
deletei arquivos anteriores; isso poderia ter simplificado significativamente o
problema (e os <em>sets</em> no python).</p><p>Ademais, uma das coisas chatas do <code>arj</code> √© que ele s√≥ √© capaz de extrair arquivos
que terminam em <code>*.arj</code>, ent√£o fui obrigado a renomear/copiar um arquivo antes
de tentar utiliz√°-lo para extrair seu conte√∫do.</p></content><div style=display:flex;justify-content:space-between><p>Reply via <a href='mailto:serendipity@perrotta.dev?subject=Reply to: Matroshka'>email</a></p><p><a href=https://perrotta.dev/tags/dev/>#dev</a>
<a href=https://perrotta.dev/tags/linux/>#linux</a>
<a href=https://perrotta.dev/tags/pt/>#pt</a></p></div></main><hr><footer><span>¬© 2021 - 2025 Thiago Perrotta ¬∑
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ¬∑
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo  ï‚Ä¢·¥•‚Ä¢ î bear</a></span><div class=social-link-wrapper><a target=_blank rel=noopener class=social-link href=mailto:serendipity@perrotta.dev title="Email address"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 24 24" height="1.3em" width="1.3em"><g transform="translate(0.000000,24.000000) scale(0.100000,-0.100000)"><path d="M26 191c-4-5 16-23 44-40l50-31 50 31c28 17 48 35 44 40-7 12-181 12-188 0z"/><path d="M22 103l3-58 93-3c104-3 105-3 1e2 71l-3 46-48-29-47-30-38 23c-20 13-43 27-50 31-10 6-12-5-10-51z"/></g></svg>
</a><a target=_blank rel=noopener class=social-link href=https://perrotta.dev/index.xml title="RSS feed"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 56.693 56.693" height="1em" width="1em"><path d="M3.428 31.085c6.19.0 12.009 2.418 16.382 6.816 4.381 4.398 6.793 10.256 6.793 16.492h9.539c0-18.113-14.676-32.848-32.714-32.848v9.54zM3.443 14.174c22.061.0 40.01 18.047 40.01 40.231h9.539c0-27.445-22.229-49.77-49.549-49.77v9.539zM16.634 47.741c0 3.648-2.959 6.607-6.607 6.607S3.42 51.39 3.42 47.741c0-3.65 2.958-6.607 6.606-6.607s6.608 2.957 6.608 6.607z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://github.com/thiagowfx title="Github profile"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://goodreads.com/user/show/7873832-thiago title="Goodreads profile"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 50 50" height="1em" width="1em"><path d="M25 2c-4.541.0-8.41336 1.9082151-11.017578 4.9453125C11.378203 9.9824099 10 14.07975 10 18.5s1.378203 8.517589 3.982422 11.554688C16.58664 33.091785 20.459 35 25 35c4.531588.0 8.395936-1.901605 11-4.927734V35c0 2.598543-.818503 4.764071-2.451172 6.339844C31.91616 42.915616 29.363725 44 25.5 44 17.784314 44 15 39.933333 15 36H11c0 6.066667 5.215686 12 14.5 12 4.636275.0 8.33384-1.377726 10.826172-3.783203C38.818503 41.811319 40 38.476457 40 35V18.5 3H36V6.9277344C33.395936 3.9016049 29.531588 2 25 2zm0 4c3.459.0 6.08664 1.3379255 7.982422 3.5488281C34.878203 11.759731 36 14.91225 36 18.5s-1.121797 6.740269-3.017578 8.951172C31.08664 29.662074 28.459 31 25 31s-6.08664-1.337926-7.982422-3.548828C15.121797 25.240269 14 22.08775 14 18.5s1.121797-6.740269 3.017578-8.9511719C18.91336 7.3379255 21.541 6 25 6z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://linkedin.com/in/thiagoperrotta title="LinkedIn profile"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 30 30" height="1.2em" width="1.2em"><path d="M24 4H6C4.895 4 4 4.895 4 6v18c0 1.105.895 2 2 2h18c1.105.0 2-.895 2-2V6c0-1.105-.895-2-2-2zM10.954 22h-2.95v-9.492h2.95V22zM9.449 11.151c-.951.0-1.72-.771-1.72-1.72s.77-1.719 1.72-1.719c.948.0 1.719.771 1.719 1.719C11.168 10.38 10.397 11.151 9.449 11.151zM22.004 22h-2.948v-4.616c0-1.101-.02-2.517-1.533-2.517-1.535.0-1.771 1.199-1.771 2.437V22h-2.948v-9.492h2.83v1.297h.04c.394-.746 1.356-1.533 2.791-1.533 2.987.0 3.539 1.966 3.539 4.522V22z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://stackoverflow.com/users/1745064/thiagowfx title="StackOverflow profile"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em"><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 3e2zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-2e2v39.7h2e2zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://instagram.com/thiagowfx title="Instagram profile"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 -50 448 512" height="1em" width="1em"><path d="M224.1 141c-63.6.0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 256s-51.3-114.9-114.9-114.9zm0 189.6c-41.2.0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.5 74.7-74.7 74.7zm146.4-194.3c0 14.3-11.6 25.9-25.9 25.9s-25.9-11.6-25.9-25.9 11.6-25.9 25.9-25.9 25.9 11.6 25.9 25.9zM446.6 144.1c-1.5-31.7-8.4-59.8-30.5-81.9S338.2 32 306.5 30.5c-31.6-1.5-128.4-1.5-160 0C114.8 32 86.7 38.9 64.6 61s-29 50.2-30.5 81.9C32 175.7 32 272.5 33.5 304.1 35 335.8 41.9 363.9 64 386s50.2 29 81.9 30.5c31.6 1.5 128.4 1.5 160 0 31.7-1.5 59.8-8.4 81.9-30.5s29-50.2 30.5-81.9c1.5-31.6 1.5-128.4.0-160zM224.1 338c-45.2.0-82-36.8-82-82s36.8-82 82-82 82 36.8 82 82-36.8 82-82 82zm148.6-198.4c-14.3.0-25.9-11.6-25.9-25.9s11.6-25.9 25.9-25.9 25.9 11.6 25.9 25.9-11.6 25.9-25.9 25.9z"/></svg></a></div><a target=_blank href=https://512kb.club title="512kb.club badge"><img src=https://perrotta.dev/green-team.gif alt="a proud member of the green team of 512KB club"></a></footer></body></html>
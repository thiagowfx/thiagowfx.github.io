<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet type="text/xsl" href="https://perrotta.dev/rss.xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Git on ¬¨ just serendipity üçÄ</title><link>https://perrotta.dev/</link><description>Recent content in Git on ¬¨ just serendipity üçÄ</description><generator>Hugo</generator><language>en</language><managingEditor>serendipity@perrotta.dev (Thiago Perrotta)</managingEditor><webMaster>serendipity@perrotta.dev (Thiago Perrotta)</webMaster><copyright>¬© 2013 - 2026 Thiago Perrotta ¬∑
[some rights reserved](https://creativecommons.org/licenses/by-nc-sa/4.0/) ¬∑
a fork of [hugo  ï‚Ä¢·¥•‚Ä¢ î bear](https://github.com/janraasch/hugo-bearblog/)</copyright><lastBuildDate>Mon, 23 Feb 2026 12:51:19 +0100</lastBuildDate><atom:link href="https://perrotta.dev/tags/git/index.xml" rel="self" type="application/rss+xml"/><item><title>ee: exit all shells</title><link>https://perrotta.dev/2026/02/ee-exit-all-shells/</link><pubDate>Mon, 23 Feb 2026 11:52:17 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2026/02/ee-exit-all-shells/</guid><description>&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: I present this to you the same way I presented it to &lt;a href="https://ampcode.com"&gt;Amp
Code&lt;/a&gt; in the context of my
&lt;a href="https://github.com/thiagowfx/.dotfiles"&gt;~/.dotfiles&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;new shell alias: ee

quit all shells

example:

$ bash
$ bash
$ zsh

Now we&amp;#39;re 3 levels deep.
&amp;#34;ee&amp;#34; should quit them all (effectively closing the underlying terminal emulator tab)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Why do I even have this issue in the first place?&lt;/strong&gt; Utilities like
&lt;a href="https://github.com/thiagowfx/pancake/tree/master/wt"&gt;wt&lt;/a&gt; (to manage git
worktrees) and &lt;a href="https://github.com/thiagowfx/pancake/tree/master/try"&gt;try&lt;/a&gt; (to
manage scratch directories) need to change directories. Alas, it&amp;rsquo;s not possible
to change the current working directly (&lt;code&gt;$PWD&lt;/code&gt;) with a script. As such, my
workaround is to open a subshell in the desired directory. As a side effect, I
end up with nested subshells.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Why &lt;code&gt;ee&lt;/code&gt;?&lt;/strong&gt; I close my shell with &lt;code&gt;C-d&lt;/code&gt; (Ctrl + D).
In this context I need to press it three times in a row.
&lt;code&gt;dd&lt;/code&gt; would have been a natural alias but I&amp;rsquo;d rather avoid the name clash with
the &lt;a href="https://wiki.archlinux.org/title/Dd"&gt;&lt;code&gt;dd&lt;/code&gt;&lt;/a&gt; disk cloning util.
&lt;code&gt;ee&lt;/code&gt; came next naturally.&lt;/p&gt;
&lt;p&gt;This version works in &lt;code&gt;bash&lt;/code&gt; but not in &lt;code&gt;zsh&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% which ee
ee () {
 pid=$$
 pids=$pid
 while ppid=$(ps -o ppid= -p &amp;#34;$pid&amp;#34; | tr -d &amp;#39; &amp;#39;) &amp;amp;&amp;amp; [ &amp;#34;$ppid&amp;#34; -gt 1 ] 2&amp;gt; /dev/null
 do
 case &amp;#34;$(ps -o comm= -p &amp;#34;$ppid&amp;#34; 2&amp;gt;/dev/null)&amp;#34; in
 (*sh) pids=&amp;#34;$pids $ppid&amp;#34;
 pid=$ppid ;;
 (*) break ;;
 esac
 done
 kill -HUP $pids
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;The issue is &lt;code&gt;zsh&lt;/code&gt; doesn&amp;rsquo;t word-split unquoted variables like &lt;code&gt;bash&lt;/code&gt;/&lt;code&gt;sh&lt;/code&gt; does.
&lt;code&gt;$pids&lt;/code&gt; is passed as a single string. Fix with &lt;code&gt;eval&lt;/code&gt;:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The version below works in &lt;strong&gt;both&lt;/strong&gt; &lt;code&gt;bash&lt;/code&gt; and &lt;code&gt;zsh&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;ee () {
 pid=$$
 pids=$pid
 while ppid=$(ps -o ppid= -p &amp;#34;$pid&amp;#34; | tr -d &amp;#39; &amp;#39;) &amp;amp;&amp;amp; [ &amp;#34;$ppid&amp;#34; -gt 1 ] 2&amp;gt; /dev/null
 do
 case &amp;#34;$(ps -o comm= -p &amp;#34;$ppid&amp;#34; 2&amp;gt;/dev/null)&amp;#34; in
 (*sh) pids=&amp;#34;$pids $ppid&amp;#34;
 pid=$ppid ;;
 (*) break ;;
 esac
 done
 eval &amp;#34;kill -HUP $pids&amp;#34;
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The only difference is the last line:&lt;/p&gt;
&lt;div class="codeblock" data-lang="diff"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;diff&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-diff"&gt;- kill -HUP $pids
&amp;#43; eval &amp;#34;kill -HUP $pids&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The resulting solution is a shell function, &lt;em&gt;not&lt;/em&gt; an alias, but that&amp;rsquo;s perfectly
acceptable.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: ee: exit all shells"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>github workflow: external script</title><link>https://perrotta.dev/2026/02/github-workflow-external-script/</link><pubDate>Sun, 22 Feb 2026 14:10:11 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><category>pre-commit</category><guid>https://perrotta.dev/2026/02/github-workflow-external-script/</guid><description>&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: execute a &lt;code&gt;.js&lt;/code&gt; script in a GitHub workflow. The script
must be stored in a separate file (than the workflow) in the same git
repository.&lt;/p&gt;
&lt;p&gt;Why store the file separately?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Inlining a big script is ugly and very non-elegant&lt;/li&gt;
&lt;li&gt;No syntax highlighting when updating the script ‚Üí error-prone&lt;/li&gt;
&lt;li&gt;Risk of messing up with string interpolation or escaping characters ‚Üí
error-prone&lt;/li&gt;
&lt;li&gt;Limited ability to use formatters and linters in inlined scripts&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The following approach, taken from a real example, works well:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% tree {repo root}/.github/
.github/
‚îú‚îÄ‚îÄ scripts
‚îÇ ‚îî‚îÄ‚îÄ drift-summary.js
‚îî‚îÄ‚îÄ workflows
 ‚îú‚îÄ‚îÄ drift-summary.yml
 [...]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="codeblock" data-lang="yaml"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;yaml&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-yaml"&gt;name: &amp;#39;Drift Summary&amp;#39;

on:
 schedule:
 - cron: &amp;#39;0 9 * * MON-FRI&amp;#39;
 workflow_dispatch:

permissions:
 issues: write

jobs:
 summarize:
 name: &amp;#39;Update drift summary issue&amp;#39;
 runs-on: ubuntu-latest
 steps:
 - name: &amp;#39;Checkout repository&amp;#39;
 uses: actions/checkout@1af3b93b6815bc44a9784bd300feb67ff0d1eeb3 # v6.0.0
 with:
 persist-credentials: false

 - name: &amp;#39;Aggregate drift and update summary&amp;#39;
 uses: actions/github-script@f28e40c7f34bde8b3046d885e986cb6290c5673b # v7
 with:
 script: |
 const script = require(&amp;#39;./.github/scripts/drift-summary.js&amp;#39;);
 await script({ github, context });&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Use &lt;a href="https://github.com/actions/github-script"&gt;&lt;code&gt;github-script&lt;/code&gt;&lt;/a&gt; + &lt;a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules"&gt;&lt;code&gt;require&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: github workflow: external script"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/pre-commit/"&gt;#pre-commit&lt;/a&gt;&lt;/p&gt;</description></item><item><title>GitHub: approve PRs from CLI</title><link>https://perrotta.dev/2026/02/github-approve-prs-from-cli/</link><pubDate>Wed, 04 Feb 2026 11:10:58 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2026/02/github-approve-prs-from-cli/</guid><description>&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: approve a given github pull request from the CLI.&lt;/p&gt;
&lt;p&gt;Why?&lt;/p&gt;
&lt;p&gt;Presumably you would do the PR review outside the GitHub web UI (it&amp;rsquo;s slow,
eh?). How to do this is out of scope of this post.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s assume the review is done, and all that is left is to approve the PR.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s also assume you have a local checkout of the repository, and your CWD is
set to it.&lt;/p&gt;
&lt;p&gt;First, check the PR out:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;thiago.perrotta ~/Corp/terraform git:main
% gh co
? Select a pull request [Use arrows to move, type to filter]
&amp;gt; 509 OPEN Change ai-resources repository visibility to internal [fix/ai-resources-visibility-internal]
[...]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Now approve it:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;thiago.perrotta ~/Corp/terraform git:fix/ai-resources-visibility-internal? #509
% gh pr review --approve
‚úì Approved pull request corp/terraform#509&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;It&amp;rsquo;s possible to approve the PR without checking it out:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% gh pr review -h
Add a review to a pull request.

Without an argument, the pull request that belongs to the current branch is reviewed.


USAGE
 gh pr review [&amp;lt;number&amp;gt; | &amp;lt;url&amp;gt; | &amp;lt;branch&amp;gt;] [flags]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% gh pr review 509 --approve&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: GitHub: approve PRs from CLI"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>starship: github PR prompt</title><link>https://perrotta.dev/2026/01/starship-github-pr-prompt/</link><pubDate>Fri, 30 Jan 2026 00:51:51 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2026/01/starship-github-pr-prompt/</guid><description>&lt;p&gt;&lt;a href="https://perrotta.dev/2025/12/starship/"&gt;Previously&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: add to &lt;a href="https://starship.rs/"&gt;starship&lt;/a&gt; the GitHub PR
associated with the current git branch.&lt;/p&gt;
&lt;p&gt;The following starship custom module does the trick:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;[custom.github_pr]
command = &amp;#34;bkt --ttl=10m --scope=\&amp;#34;$(git rev-parse --show-toplevel):$(git branch --show-current)\&amp;#34; -- gh pr view --json number --jq &amp;#39;\&amp;#34;#\&amp;#34; &amp;#43; (.number | tostring)&amp;#39; 2&amp;gt;/dev/null&amp;#34;
when = &amp;#34;git rev-parse --is-inside-work-tree 2&amp;gt;/dev/null&amp;#34;
format = &amp;#34; [$output](magenta)&amp;#34;
ignore_timeout = true&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The module is activated only within git repositories (see the &lt;code&gt;when&lt;/code&gt; variable).&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;command&lt;/code&gt; consists of the &lt;code&gt;gh&lt;/code&gt; CLI, as you would expect. There&amp;rsquo;s one major
problem: it makes a network call on every prompt. This is super inefficient.
Can&amp;rsquo;t do.&lt;/p&gt;
&lt;p&gt;That&amp;rsquo;s why we use &lt;a href="https://perrotta.dev/2024/12/bkt-cache-command-outputs/"&gt;&lt;code&gt;bkt&lt;/code&gt;&lt;/a&gt;:
it caches the PR info for a certain amount of time (10 minutes in the
aforementioned example), which makes this a feasible prompt.&lt;/p&gt;
&lt;p&gt;The full prompt (without colors) looks roughly like this:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;thiago.perrotta ~/.dotfiles git:master! ‚éá #466
‚ùØ&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The full git commit that implements and uses it:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git --no-pager show
commit d2a80f6b8edfa6a07204a1d97b278abacba57813 (HEAD -&amp;gt; master)
Author: Thiago Perrotta &amp;lt;{redacted}&amp;gt;
Date: Fri Jan 30 00:55:02 2026 &amp;#43;0100

 starship: add github pr

diff --git starship/.config/starship.toml starship/.config/starship.toml
index 2c5e78e..9fbf19b 100644
--- starship/.config/starship.toml
&amp;#43;&amp;#43;&amp;#43; starship/.config/starship.toml
@@ -1,5 &amp;#43;1,5 @@
 # Minimal starship config matching grml prompt
-format = &amp;#34;$status$sudo$username$hostname$directory$git_branch$git_state$git_status${custom.git_worktree}$line_break$character&amp;#34;
&amp;#43;format = &amp;#34;$status$sudo$username$hostname$directory$git_branch$git_state$git_status${custom.git_worktree}${custom.github_pr}$line_break$character&amp;#34;
 right_format = &amp;#34;$cmd_duration$jobs&amp;#34;
 add_newline = true

@@ -52,3 &amp;#43;52,9 @@ command = &amp;#34;printf &amp;#39;‚éá&amp;#39;&amp;#34;
 when = &amp;#34;[ -f .git ]&amp;#34;
 format = &amp;#34; [$output]($style)&amp;#34;
 style = &amp;#34;bold yellow&amp;#34;
&amp;#43;
&amp;#43;[custom.github_pr]
&amp;#43;command = &amp;#34;bkt --ttl=10m --scope=\&amp;#34;$(git rev-parse --show-toplevel):$(git branch --show-current)\&amp;#34; -- gh pr view --json number --jq &amp;#39;\&amp;#34;#\&amp;#34; &amp;#43; (.number | tostring)&amp;#39; 2&amp;gt;/dev/null&amp;#34;
&amp;#43;when = &amp;#34;git rev-parse --is-inside-work-tree 2&amp;gt;/dev/null&amp;#34;
&amp;#43;format = &amp;#34; [$output](magenta)&amp;#34;
&amp;#43;ignore_timeout = true&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: starship: github PR prompt"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git aicommit</title><link>https://perrotta.dev/2026/01/git-aicommit/</link><pubDate>Tue, 13 Jan 2026 15:58:48 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>ai</category><category>dev</category><category>git</category><guid>https://perrotta.dev/2026/01/git-aicommit/</guid><description>&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: auto-generate a commit message for &lt;code&gt;git&lt;/code&gt; from the
command-line. The solution should be vendor agnostic.&lt;/p&gt;
&lt;p&gt;Given a &lt;code&gt;git-foo.sh&lt;/code&gt; in &lt;code&gt;$PATH&lt;/code&gt;, it can be invoked as &lt;code&gt;git foo&lt;/code&gt;, as if it
were a built-in &lt;code&gt;git&lt;/code&gt; command.&lt;/p&gt;
&lt;p&gt;This is helpful to enable seamless integration with &lt;code&gt;git&lt;/code&gt;. I chose to call the
subcommand &lt;code&gt;aicommit&lt;/code&gt;. I suppose &lt;code&gt;commit-ai&lt;/code&gt; would also be sensible.&lt;/p&gt;
&lt;p&gt;The goal is to create &lt;code&gt;git-aicommit.sh&lt;/code&gt; in &lt;code&gt;~/.bin&lt;/code&gt; (which is in my &lt;code&gt;$PATH&lt;/code&gt; via
my &lt;a href="https://github.com/thiagowfx/.dotfiles/blob/018c50ebd86b70b30578d4a1393054fd04bd4553/profile/.profilerc#L42"&gt;.dotfiles&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;This initial draft worked well:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;#!/bin/bash
#
# git-aicommit - Create a commit with an AI-generated title based on staged changes

set -e

# Check if we&amp;#39;re inside a git repository
if [ &amp;#34;$(git rev-parse --is-inside-work-tree 2&amp;gt;/dev/null)&amp;#34; != &amp;#34;true&amp;#34; ]; then
 echo &amp;#34;Error: Not in a git repository&amp;#34;
 exit 1
fi

# Check if there are staged changes
if git diff --cached --quiet; then
 echo &amp;#34;Error: No staged changes to commit&amp;#34;
 exit 1
fi

# Select AI agent (default: claude)
agent=&amp;#34;${GIT_AI_AGENT:-claude}&amp;#34;
case &amp;#34;$agent&amp;#34; in
 # keep-sorted start
 amp|ampcode)
 ai_prompt() { amp -x &amp;#34;$1&amp;#34;; }
 ;;
 claude)
 ai_prompt() { claude -p &amp;#34;$1&amp;#34;; }
 ;;
 # keep-sorted end
 *)
 echo &amp;#34;Error: Unknown AI agent: $agent&amp;#34;
 exit 1
 ;;
esac

prompt=&amp;#34;Look at the staged git changes and create a summarizing git commit title. Only respond with the title and no affirmation.&amp;#34;

# Generate commit message and commit
echo &amp;#34;Generating commit message with $agent...&amp;#34;
git commit -m &amp;#34;$(ai_prompt &amp;#34;$prompt&amp;#34;)&amp;#34; &amp;#34;$@&amp;#34;

echo &amp;#34;AI commit created successfully&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Refer to &lt;a href="https://github.com/thiagowfx/.dotfiles/blob/master/git/.bin/git-aicommit-quick"&gt;this
source&lt;/a&gt;
for an up-to-date version as it evolves.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s break it down:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://perrotta.dev/2026/01/oneshot-prompting/"&gt;Previously&lt;/a&gt;: we employ an
oneshot command to call an LLM agent, so that there&amp;rsquo;s no need to do it
interactively. Initially I added only Claude Code and Amp because they are the
agents I use the most; perhaps this list will be expanded later on but it is
not intended to be exhaustive&lt;sup id="fnref:1"&gt;&lt;a href="https://perrotta.dev/2026/01/git-aicommit/#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/li&gt;
&lt;li&gt;The command is intended to run in O(seconds). If it takes too long, then it
should be simplified (via a better prompt).&lt;/li&gt;
&lt;li&gt;By default it uses Claude. To use another agent, call it like:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;GIT_AI_AGENT=&amp;#34;amp&amp;#34; git aicommit&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;This preference could be trivially made persistent on a per-repo basis by using
&lt;a href="https://perrotta.dev/2022/01/direnv-automate-your-environment-variables/"&gt;direnv&lt;/a&gt;.
For example, use Claude at work and Amp in personal git repositories&lt;sup id="fnref:2"&gt;&lt;a href="https://perrotta.dev/2026/01/git-aicommit/#fn:2" class="footnote-ref" role="doc-noteref"&gt;2&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;Later on I split the command into two: &lt;code&gt;git aicommit&lt;/code&gt; and &lt;code&gt;git aicommit-quick&lt;/code&gt;.
&amp;ldquo;Quick&amp;rdquo; populates the commit message title only (think &lt;code&gt;git commit -m &amp;quot;foo&amp;quot;&lt;/code&gt;),
whereas the non-quick version populates the body as well, accounting for &lt;a href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/creating-a-pull-request-template-for-your-repository"&gt;GitHub
PR
templates&lt;/a&gt;
when they exist. Time will tell whether I need this distinction.&lt;/p&gt;
&lt;div class="footnotes" role="doc-endnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;This gives me the idea to create a separate script for &amp;ldquo;oneshotting&amp;rdquo; LLMs
in &lt;a href="https://github.com/thiagowfx/pancake"&gt;pancake&lt;/a&gt;.&amp;#160;&lt;a href="https://perrotta.dev/2026/01/git-aicommit/#fnref:1" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;&lt;a href="https://ampcode.com/news/opus-4.5"&gt;It&amp;rsquo;s all Claude anyway&lt;/a&gt;, this
distinction is mostly for the sake of discretionary billing.&amp;#160;&lt;a href="https://perrotta.dev/2026/01/git-aicommit/#fnref:2" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git aicommit"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/ai/"&gt;#ai&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>new script: uwatch</title><link>https://perrotta.dev/2026/01/new-script-uwatch/</link><pubDate>Sat, 10 Jan 2026 22:39:53 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2026/01/new-script-uwatch/</guid><description>&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: &lt;code&gt;watch -- git diff&lt;/code&gt; / &lt;code&gt;watch -- git status&lt;/code&gt; should emit
colors. Yet it doesn&amp;rsquo;t.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://man.archlinux.org/man/watch.1"&gt;watch(1)&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;NAME

watch - execute a program periodically, showing output fullscreen

SYNOPSIS

watch [option ...] command

DESCRIPTION

watch runs command repeatedly, displaying its output and errors (the first screenful). This allows you to watch the program output change over time. By default, command is run every 2 seconds and watch will run until interrupted. A header informs of the start and running time of command as well as its exit code.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;You typically address this with &lt;code&gt;watch -c&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;-c, --color
 Interpret ANSI color and style sequences.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;And yet, &lt;code&gt;watch -c -- git status&lt;/code&gt; still won&amp;rsquo;t emit colors. This is because &lt;code&gt;git&lt;/code&gt;
&amp;ldquo;knows&amp;rdquo; the output is going through a TTY (&lt;code&gt;watch&lt;/code&gt;), and thus defensively
disables colors. Some programs control this behavior with a &lt;code&gt;--color=always&lt;/code&gt;
switch (the default is typically &lt;code&gt;auto&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Without diving deep into what&amp;rsquo;s happening underneath (terminal ANSI escape
colors, TTY output detection), the magical solution is to use
&lt;a href="https://man.archlinux.org/man/unbuffer.1"&gt;&lt;code&gt;unbuffer(1)&lt;/code&gt;&lt;/a&gt;, which was
&lt;a href="https://perrotta.dev/2024/12/unbuffer/"&gt;previously&lt;/a&gt; covered. &lt;code&gt;unbuffer&lt;/code&gt; is
agnostic of the underlying program; it doesn&amp;rsquo;t matter whether it uses &lt;code&gt;--color&lt;/code&gt;,
or &lt;code&gt;CLICOLOR&lt;/code&gt;, or another mechanism.&lt;/p&gt;
&lt;p&gt;Thus we achieve this form:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% watch -c -- unbuffer git status&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;But it&amp;rsquo;s super tedious to remember and to type out the &lt;code&gt;-c -- unbuffer&lt;/code&gt; bits.&lt;/p&gt;
&lt;p&gt;To resolve this, I created a wrapper:
&lt;a href="https://github.com/thiagowfx/pancake/tree/master/uwatch"&gt;&lt;code&gt;uwatch(1)&lt;/code&gt;&lt;/a&gt;. The &lt;code&gt;u&lt;/code&gt;
alludes to &amp;ldquo;unbuffer&amp;rdquo;:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;Run a command repeatedly using watch, preserving colored output.

Uses unbuffer to maintain color codes through watch&amp;#39;s output. Useful for monitoring git status, test output, or any command with color formatting.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Usage:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;uwatch [--] git status&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;--&lt;/code&gt; separator is optional.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: new script: uwatch"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: shell prompt: worktrees</title><link>https://perrotta.dev/2026/01/git-shell-prompt-worktrees/</link><pubDate>Sat, 10 Jan 2026 15:15:21 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>ai</category><category>dev</category><category>git</category><guid>https://perrotta.dev/2026/01/git-shell-prompt-worktrees/</guid><description>&lt;p&gt;My shell prompt displays the git branch my repository has
currently checked out:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;thiago.perrotta perrotta.dev git:master?
‚ùØ&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: augment that prompt to signal whether we&amp;rsquo;re inside a
checked out &lt;a href="https://git-scm.com/docs/git-worktree"&gt;git worktree&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This is helpful because lately multiple repository worktrees have been
popularized thanks to LLM coding agents.&lt;/p&gt;
&lt;p&gt;The following change to &lt;a href="https://perrotta.dev/2025/12/starship/"&gt;starship&lt;/a&gt; does the
trick:&lt;/p&gt;
&lt;div class="codeblock" data-lang="diff"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;diff&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-diff"&gt;commit b7de6881c0fb57c840def52189502985442842e1
Author: Thiago Perrotta &amp;lt;{redacted}&amp;gt;
Date: Fri Jan 9 21:18:09 2026 -0300

 starship: add worktree symbol

diff --git starship/.config/starship.toml starship/.config/starship.toml
index 87df9ff..ea7acc8 100644
--- starship/.config/starship.toml
&amp;#43;&amp;#43;&amp;#43; starship/.config/starship.toml
@@ -1,5 &amp;#43;1,5 @@
 # Minimal starship config matching grml prompt
-format = &amp;#34;$status$sudo$username$hostname$directory$git_branch$git_state$git_status$line_break$character&amp;#34;
&amp;#43;format = &amp;#34;$status$sudo$username$hostname$directory$git_branch$git_state$git_status${custom.git_worktree}$line_break$character&amp;#34;
 right_format = &amp;#34;$cmd_duration$jobs&amp;#34;
 add_newline = true

@@ -24,13 &amp;#43;24,13 @@ format = &amp;#34; [$path](bold) &amp;#34;

 [git_branch]
 symbol = &amp;#34;git:&amp;#34;
-format = &amp;#34;[$symbol$branch](bold cyan) &amp;#34;
&amp;#43;format = &amp;#34;[$symbol$branch](bold cyan)&amp;#34;

 [git_state]
 format = &amp;#34;|[$state]()&amp;#34;

 [git_status]
-format = &amp;#34;[$conflicted$deleted$renamed$modified$staged$untracked$ahead_behind](red) &amp;#34;
&amp;#43;format = &amp;#34;[$conflicted$deleted$renamed$modified$staged$untracked$ahead_behind](red)&amp;#34;

 [cmd_duration]
 min_time = 2000
@@ -46,3 &amp;#43;46,9 @@ format = &amp;#34;[üßô](red) &amp;#34;
 [character]
 success_symbol = &amp;#34;[‚ùØ](green)&amp;#34;
 error_symbol = &amp;#34;[x](red)&amp;#34;
&amp;#43;
&amp;#43;[custom.git_worktree]
&amp;#43;command = &amp;#34;printf &amp;#39;‚éá&amp;#39;&amp;#34; # or üå≤, but I find the emoji too distracting in this context
&amp;#43;when = &amp;#34;git rev-parse --is-inside-work-tree 2&amp;gt;/dev/null &amp;amp;&amp;amp; [ -f $(git rev-parse --git-dir)/commondir ]&amp;#34;
&amp;#43;format = &amp;#34; [$output]($style)&amp;#34;
&amp;#43;style = &amp;#34;bold yellow&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;You don&amp;rsquo;t need to use starship to adopt it. The core logic is:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;git rev-parse --is-inside-work-tree &amp;amp;&amp;gt;/dev/null &amp;amp;&amp;amp; [ -f &amp;#34;$(git rev-parse --git-dir)/commondir&amp;#34; ] &amp;amp;&amp;amp; printf &amp;#39;‚éá&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The result:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;thiago.perrotta perrotta.dev git:thiagowfx/my-custom-branch ‚éá
‚ùØ&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;It is subtle yet informative.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: shell prompt: worktrees"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/ai/"&gt;#ai&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: diff untracked</title><link>https://perrotta.dev/2026/01/git-diff-untracked/</link><pubDate>Sun, 04 Jan 2026 04:29:01 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2026/01/git-diff-untracked/</guid><description>&lt;p&gt;&lt;a href="https://perrotta.dev/2025/12/git-stash-untracked-files/"&gt;Previously&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If we can stash untracked files (&lt;code&gt;git stash -u&lt;/code&gt;), should we be able to &lt;code&gt;git diff&lt;/code&gt; untracked files?&lt;/p&gt;
&lt;p&gt;Naturally, diffing an untracked file would output the entire file contents.
Still, this can be desirable sometimes.&lt;/p&gt;
&lt;p&gt;When reviewing multiple files, some of which are modified, and some of which
are brand new, you may want to review the entire list at once.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s try it out:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% cdtmp
/var/folders/yr/6sw3yylx6gjcy5jr38d6j6000000gn/T/thiago.perrotta-2026-01-04-l8Co7f
% git init
Initialized empty Git repository in /private/var/folders/yr/6sw3yylx6gjcy5jr38d6j6000000gn/T/thiago.perrotta-2026-01-04-l8Co7f/.git/
% echo world &amp;gt; hello.md
% git status
## No commits yet on master
?? hello.md
% git diff
% git diff -u&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Err, no luck. In fact, from &lt;a href="https://man.archlinux.org/man/git-diff.1"&gt;&lt;code&gt;git-diff(1)&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-p, -u, &amp;ndash;patch&lt;/p&gt;
&lt;p&gt;Generate patch (see the section called &amp;ldquo;GENERATING PATCH TEXT WITH -P&amp;rdquo;).
This is the default.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ouch. That&amp;rsquo;s not the &lt;code&gt;-u&lt;/code&gt; we&amp;rsquo;re looking for!&lt;/p&gt;
&lt;p&gt;We can attempt a similar test with &lt;code&gt;git add -p&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% cdtmp
/var/folders/yr/6sw3yylx6gjcy5jr38d6j6000000gn/T/thiago.perrotta-2026-01-04-l8Co7f
% git init
Initialized empty Git repository in /private/var/folders/yr/6sw3yylx6gjcy5jr38d6j6000000gn/T/thiago.perrotta-2026-01-04-l8Co7f/.git/
% echo world &amp;gt; hello.md
% git status
## No commits yet on master
?? hello.md
% git add -p
No changes.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;No luck either.&lt;/p&gt;
&lt;p&gt;Not all hope is lost though.&lt;/p&gt;
&lt;p&gt;Enter &lt;a href="https://man.archlinux.org/man/git-add.1#:~:text=ignored%20removed%20files.-,%2DN%2C%20%2D%2Dintent%2Dto%2Dadd,-Record%20only%20the"&gt;&lt;code&gt;git add -N&lt;/code&gt; (&lt;code&gt;--intent-to-add&lt;/code&gt;)&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;&amp;gt; -N, --intent-to-add
&amp;gt;
&amp;gt; Record only the fact that the path will be added later. An entry for the
&amp;gt; path is placed in the index with no content. This is useful for, among other
&amp;gt; things, showing the unstaged content of such files with git diff and
&amp;gt; committing them with git commit -a.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;If we do &lt;code&gt;git add -N hello.md&lt;/code&gt;, the following happens:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git add -N hello.md
% git --no-pager diff
diff --git hello.md hello.md
new file mode 100644
index 0000000..cc628cc
--- /dev/null
&amp;#43;&amp;#43;&amp;#43; hello.md
@@ -0,0 &amp;#43;1 @@
&amp;#43;world&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Yes! There&amp;rsquo;s our diff. Now &lt;code&gt;git add -p&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git add -N hello.md
% git add -p
diff --git a/hello.md b/hello.md
new file mode 100644
index 0000000..cc628cc
--- /dev/null
&amp;#43;&amp;#43;&amp;#43; b/hello.md
@@ -0,0 &amp;#43;1 @@
&amp;#43;world
(1/1) Stage addition [y,n,q,a,d,e,p,P,?]?&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;It works too!&lt;/p&gt;
&lt;p&gt;&lt;code&gt;git reset --hard&lt;/code&gt; picks it up as well.&lt;/p&gt;
&lt;p&gt;In order to make this workflow ergonomic, run &lt;code&gt;git add -AN&lt;/code&gt; (&lt;code&gt;-A&lt;/code&gt; = &lt;code&gt;--all&lt;/code&gt;)
prior to &lt;code&gt;git diff&lt;/code&gt; or &lt;code&gt;git add -p&lt;/code&gt;, so that all new files are accounted for.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://stackoverflow.com/questions/855767/can-i-use-git-diff-on-untracked-files"&gt;See also&lt;/a&gt;, &lt;a href="https://perrotta.dev/2025/11/git-diff-interactively/"&gt;git diff interactively&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: diff untracked"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ neovim: inline git hunk control</title><link>https://perrotta.dev/2026/01/neovim-inline-git-hunk-control/</link><pubDate>Sat, 03 Jan 2026 15:41:21 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><category>vim</category><guid>https://perrotta.dev/2026/01/neovim-inline-git-hunk-control/</guid><description>&lt;p&gt;What is a
&lt;a href="https://stackoverflow.com/questions/37620729/in-the-context-of-git-and-diff-what-is-a-hunk"&gt;hunk&lt;/a&gt;?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;When comparing two files, diff finds sequences of lines common to both files,
interspersed with groups of differing lines called hunks&lt;sup id="fnref:1"&gt;&lt;a href="https://perrotta.dev/2026/01/neovim-inline-git-hunk-control/#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;There are various ways to treat git hunks as first-class citizens, manipulating
them one at a time ‚Äì staging, unstaging, or reverting them.&lt;/p&gt;
&lt;p&gt;The classic one is &lt;a href="https://millerb.co.uk/2021/11/16/git-add-patch.html"&gt;&lt;code&gt;git add [-p | --patch]&lt;/code&gt;&lt;/a&gt;. Hit yes or no
for each hunk, one by one:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git add -p
diff --git a/Justfile b/Justfile
index bbb3779a9..70840a008 100755
--- a/Justfile
&amp;#43;&amp;#43;&amp;#43; b/Justfile
@@ -175,3 &amp;#43;175,6 @@ update-pre-commit:
 # Update JSON schemas
 update-json-schemas:
 pre-commit run -a update-json-schemas --hook-stage manual
&amp;#43;
&amp;#43;hello:
&amp;#43; echo world
(1/1) Stage this hunk [y,n,q,a,d,e,p,P,?]?&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;There&amp;rsquo;s also &lt;a href="https://nuclearsquid.com/writings/git-add/"&gt;&lt;code&gt;git add [-i | --interactive]&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git add -i

*** Commands ***
 1: status 2: update 3: revert 4: add untracked
 5: patch 6: diff 7: quit 8: help
What now&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;It&amp;rsquo;s also possible to manage hunks via git TUIs (=from the terminal) such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href="https://github.com/gitui-org/gitui"&gt;gitui&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/jonas/tig"&gt;tig&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/jesseduffield/lazygit"&gt;lazygit&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;hellip;or graphically with IDEs with as VSCode.&lt;/p&gt;
&lt;p&gt;An honorable mention also goes to
&lt;a href="https://github.com/andrewshadura/git-crecord"&gt;&lt;code&gt;git-crecord&lt;/code&gt;&lt;/a&gt;, which I
originally discovered by looking for an open source alternative to Google&amp;rsquo;s
Fig&lt;sup id="fnref:2"&gt;&lt;a href="https://perrotta.dev/2026/01/neovim-inline-git-hunk-control/#fn:2" class="footnote-ref" role="doc-noteref"&gt;2&lt;/a&gt;&lt;/sup&gt; interactive commit and split commands.&lt;/p&gt;
&lt;p&gt;Now that you see how my mind is overloaded with many possibilities to manipulate
git hunks, the natural follow-up question is: how to do so right from within our
favorite text editor (&lt;code&gt;vim&lt;/code&gt;)?&lt;/p&gt;
&lt;p&gt;With classic &lt;code&gt;vim&lt;/code&gt;, Tim Pope&amp;rsquo;s
&lt;a href="https://github.com/tpope/vim-fugitive"&gt;&lt;code&gt;vim-fugitive&lt;/code&gt;&lt;/a&gt; is often touted as
best-in-class (paired with
&lt;a href="https://github.com/airblade/vim-gitgutter"&gt;&lt;code&gt;vim-gitgutter&lt;/code&gt;&lt;/a&gt;). I use it
occasionally. The workflow is as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;From an open file with modifications, run &lt;code&gt;:GDiff&lt;/code&gt; (&lt;code&gt;:GDiffsplit&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;Proceed as you normally would in &lt;code&gt;vimdiff&lt;/code&gt;. Use &lt;code&gt;:diffget&lt;/code&gt; (&lt;code&gt;do&lt;/code&gt;) and
&lt;code&gt;:diffput&lt;/code&gt; (&lt;code&gt;dp&lt;/code&gt;) for each hunk. Use &lt;code&gt;[c&lt;/code&gt; and &lt;code&gt;]c&lt;/code&gt; to navigate to the previous
/ next hunk.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Finally, we get to the meat of the post. Is there any workflow
improvement in &lt;code&gt;neovim&lt;/code&gt;, which I have recently &lt;a href="https://perrotta.dev/2025/12/vim-nvim/"&gt;switched to&lt;/a&gt;?&lt;/p&gt;
&lt;p&gt;First of all, the familiar vim-fugitive workflow still works there.&lt;/p&gt;
&lt;p&gt;Its evolution is &lt;a href="https://github.com/lewis6991/gitsigns.nvim"&gt;gitsigns.nvim&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Git integration for buffers&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Given the config below, the following becomes possible:&lt;/p&gt;
&lt;div class="codeblock" data-lang="lua"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;lua&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-lua"&gt;-- Git integration
{
&amp;#39;lewis6991/gitsigns.nvim&amp;#39;,
config = function()
 require(&amp;#39;gitsigns&amp;#39;).setup({
 on_attach = function(bufnr)
 local gs = require(&amp;#39;gitsigns&amp;#39;)
 -- ]c / [c: next/prev hunk (falls back to default in diff mode)
 -- like git-gutter in vim
 vim.keymap.set(&amp;#39;n&amp;#39;, &amp;#39;]c&amp;#39;, function()
 if vim.wo.diff then return &amp;#39;]c&amp;#39; end
 vim.schedule(function() gs.nav_hunk(&amp;#39;next&amp;#39;) end)
 return &amp;#39;&amp;lt;Ignore&amp;gt;&amp;#39;
 end, { expr = true, buffer = bufnr, desc = &amp;#39;Next hunk&amp;#39; })
 vim.keymap.set(&amp;#39;n&amp;#39;, &amp;#39;[c&amp;#39;, function()
 if vim.wo.diff then return &amp;#39;[c&amp;#39; end
 vim.schedule(function() gs.nav_hunk(&amp;#39;prev&amp;#39;) end)
 return &amp;#39;&amp;lt;Ignore&amp;gt;&amp;#39;
 end, { expr = true, buffer = bufnr, desc = &amp;#39;Prev hunk&amp;#39; })
 vim.keymap.set(&amp;#39;n&amp;#39;, &amp;#39;&amp;lt;leader&amp;gt;s&amp;#39;, gs.stage_hunk, { buffer = bufnr, desc = &amp;#39;Stage hunk&amp;#39; })
 vim.keymap.set(&amp;#39;n&amp;#39;, &amp;#39;&amp;lt;leader&amp;gt;u&amp;#39;, gs.reset_hunk, { buffer = bufnr, desc = &amp;#39;Reset hunk&amp;#39; })
 end,
 })
end,
},
&amp;#39;tpope/vim-fugitive&amp;#39;,&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Use &lt;code&gt;]c&lt;/code&gt; and &lt;code&gt;[c&lt;/code&gt; to navigate hunks (compatible with vim-gitgutter)&lt;/li&gt;
&lt;li&gt;Use &lt;code&gt;&amp;lt;leader&amp;gt;s&lt;/code&gt; (comma + s in my setup) to toggle staging/unstaging hunks.&lt;/li&gt;
&lt;li&gt;Use &lt;code&gt;&amp;lt;leader&amp;gt;u&lt;/code&gt; to do the equivalent of &lt;code&gt;git checkout -- file&lt;/code&gt; for a single
hunk.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The last two shortcuts are wherein the magic lives.&lt;/p&gt;
&lt;p&gt;It is VERY convenient to choose what to stage/unstage/revert right from the
&lt;code&gt;nvim&lt;/code&gt; buffer I am currently editing. For fine-grained control, I can always use
&lt;code&gt;:Gdiff&lt;/code&gt; to perform hunk microsurgery.&lt;/p&gt;
&lt;div class="footnotes" role="doc-endnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;Not to confound with &lt;em&gt;hook&lt;/em&gt;.&amp;#160;&lt;a href="https://perrotta.dev/2026/01/neovim-inline-git-hunk-control/#fnref:1" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;Internal mercurial VCS porcelain on top of Piper / google3.&amp;#160;&lt;a href="https://perrotta.dev/2026/01/neovim-inline-git-hunk-control/#fnref:2" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: neovim: inline git hunk control"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/vim/"&gt;#vim&lt;/a&gt;&lt;/p&gt;</description></item><item><title>myrepos: chain configs</title><link>https://perrotta.dev/2025/12/myrepos-chain-configs/</link><pubDate>Mon, 22 Dec 2025 14:45:45 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/12/myrepos-chain-configs/</guid><description>&lt;p&gt;&lt;a href="https://myrepos.branchable.com/"&gt;myrepos&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;You have a lot of version control repositories. Sometimes you want to update
them all at once. Or push out all your local changes. You use special command
lines in some repositories to implement specific workflows. Myrepos provides a
mr command, which is a tool to manage all your version control repositories.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I use &lt;code&gt;mr&lt;/code&gt; to manage my local git checkouts, see my
&lt;a href="https://github.com/thiagowfx/.dotfiles/blob/master/git/.mrconfig"&gt;&lt;code&gt;~/.mrconfig&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;From &lt;code&gt;$HOME&lt;/code&gt;, running &lt;code&gt;mr update&lt;/code&gt; keeps all managed repositories up-to-date
(&lt;code&gt;git fetch&lt;/code&gt; / &lt;code&gt;git pull&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: Extend (chain) my mrconfig with git repositories from
work.&lt;/p&gt;
&lt;p&gt;I keep my git repos from work in &lt;code&gt;~/Corp&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Changing directory to it and running &lt;code&gt;mr update&lt;/code&gt; updates work repos only.&lt;/p&gt;
&lt;p&gt;The goal is to have &lt;code&gt;mr update&lt;/code&gt; in &lt;code&gt;~&lt;/code&gt; perform updates for personal AND work
repos. We can achieve this with configuration chaining.&lt;/p&gt;
&lt;p&gt;This
&lt;a href="https://github.com/thiagowfx/.dotfiles/commit/3f5c5e02dd7cc29bbc30d74f8329ce7bf654bd5e"&gt;commit&lt;/a&gt;
addresses it:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;# chain corp repositories
include = test -f $HOME/Corp/.mrconfig &amp;amp;&amp;amp; sed &amp;#39;s|^\[\([^/DEFAULT]\)|[Corp/\1|&amp;#39; $HOME/Corp/.mrconfig || true&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Rationale&lt;/strong&gt;: If &lt;code&gt;~/Corp/.mrconfig&lt;/code&gt; exists, include it in the original
&lt;code&gt;~/.mrconfig&lt;/code&gt;. The &lt;code&gt;sed&lt;/code&gt; expression is necessary to adjust relative paths when
operating on work repos, so that they all stay within &lt;code&gt;~/Corp&lt;/code&gt;, otherwise they
would be cloned in &lt;code&gt;~&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;test&lt;/code&gt; and &lt;code&gt;|| true&lt;/code&gt; is to make this inclusion optional, with graceful
degradation in case the work &lt;code&gt;.mrconfig&lt;/code&gt; does not exist, thereby simply skipping
it.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: myrepos: chain configs"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ git: stash untracked files</title><link>https://perrotta.dev/2025/12/git-stash-untracked-files/</link><pubDate>Mon, 22 Dec 2025 02:30:06 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/12/git-stash-untracked-files/</guid><description>&lt;p&gt;As I write this very post, this is what my git repository status looks like:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git st
## master...origin/master
?? content/posts/2025-12-22-git-stash-untracked.md&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;What if I wanted to stash it?&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git stash
No local changes to save
% git st
## master...origin/master
?? content/posts/2025-12-22-git-stash-untracked.md&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Nothing happens, because this post is a new file, not yet tracked by git.&lt;/p&gt;
&lt;p&gt;The classic way to address this is to switch to another branch, commit
everything (e.g. with &lt;a href="https://perrotta.dev/2025/03/git-freeze-git-thaw/"&gt;&lt;code&gt;git-freeze&lt;/code&gt;&lt;/a&gt;), and then switch back. But this is slow.&lt;/p&gt;
&lt;p&gt;Today I learned about &lt;code&gt;git stash -u&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;-u, --include-untracked, --no-include-untracked
 When used with the push and save commands, all untracked files are also stashed and then cleaned up with git clean.

 When used with the show command, show the untracked files in the
 stash entry as part of the diff.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Let&amp;rsquo;s try it:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git stash -u
Saved working directory and index state WIP on master: 58cde6e88 hide codeblock header in RSS feeds
% git st
## master...origin/master&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The new post gets stashed indeed!&lt;/p&gt;
&lt;p&gt;I don&amp;rsquo;t know how I missed this feature ‚Äì I&amp;rsquo;ve wanted this functionality for
&lt;code&gt;stash&lt;/code&gt; since forever!&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: stash untracked files"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ git: prune stale branches</title><link>https://perrotta.dev/2025/11/git-prune-stale-branches/</link><pubDate>Thu, 27 Nov 2025 18:04:45 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/11/git-prune-stale-branches/</guid><description>&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: Delete all local git branches whose counterpart remote
branches have already been merged upstream.&lt;/p&gt;
&lt;p&gt;Update &lt;code&gt;~/.gitconfig&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;[alias]
 prune-gone = !git fetch -p &amp;amp;&amp;amp; git branch -vv | awk &amp;#39;/: gone]/{print $1}&amp;#39; | xargs -r git branch -D
 world = !git fetch --all &amp;amp;&amp;amp; git remote prune origin &amp;amp;&amp;amp; git prune &amp;amp;&amp;amp; git prune-gone&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Now simply run &lt;code&gt;git prune-gone&lt;/code&gt; ‚Äì or, even better, &lt;code&gt;git world&lt;/code&gt; for a more
complete cleanup.&lt;/p&gt;
&lt;p&gt;This is much more ergonomic than hunting down individual branches and doing &lt;code&gt;git push origin :{my branch}&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Example usage:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% ~/Workspace/pancake (git)-[master]
% git world
From github.com:thiagowfx/pancake
 - [deleted] (none) -&amp;gt; origin/thiagowfx/apkbuild-sync
 - [deleted] (none) -&amp;gt; origin/thiagowfx/wt-no-origin-graceful
remote: Enumerating objects: 13, done.
remote: Counting objects: 100% (13/13), done.
remote: Compressing objects: 100% (5/5), done.
remote: Total 8 (delta 5), reused 3 (delta 3), pack-reused 0 (from 0)
Unpacking objects: 100% (8/8), 2.61 KiB | 668.00 KiB/s, done.
 f727bd7..51f81ee master -&amp;gt; origin/master
Deleted branch thiagowfx/wt-cd-dash (was 6403261).&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: prune stale branches"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git stash -m</title><link>https://perrotta.dev/2025/11/git-stash-m/</link><pubDate>Sun, 23 Nov 2025 13:14:09 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/11/git-stash-m/</guid><description>&lt;p&gt;When running &lt;code&gt;git stash&lt;/code&gt;, it&amp;rsquo;s possible to pass a &amp;ldquo;stash message&amp;rdquo; to it with
&lt;code&gt;-m&lt;/code&gt;, just like how you give a &amp;ldquo;commit message&amp;rdquo; to &lt;code&gt;git commit&lt;/code&gt;.&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;git stash -m &amp;#34;first draft, approach #1 from design doc&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;You can view past stashes with &lt;code&gt;git stash list&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git stash list
stash@{0}: On master: first draft, approach #1 from design doc
[...]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Now your &lt;del&gt;junk&lt;/del&gt; stashes can be properly organized!&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git stash -m"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git diff interactively</title><link>https://perrotta.dev/2025/11/git-diff-interactively/</link><pubDate>Tue, 04 Nov 2025 11:21:24 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/11/git-diff-interactively/</guid><description>&lt;p&gt;It&amp;rsquo;s possible to do &lt;code&gt;git patch -p&lt;/code&gt; to review diff hunks interactively, one by
one.&lt;/p&gt;
&lt;p&gt;Can we accomplish something similar with &lt;code&gt;git diff&lt;/code&gt;? If not, is there a tool
that can accomplish that, in the same spirit of &lt;code&gt;git patch -p&lt;/code&gt;, but with a
read-only-centric workflow?&lt;/p&gt;
&lt;p&gt;The na√Øve approach is to simply run &lt;code&gt;git patch -p&lt;/code&gt; and then press &amp;rsquo;n&amp;rsquo; (no) for
each diff hunk. It does not feel particularly effective though.&lt;/p&gt;
&lt;p&gt;I found another way, which embodies the spirit of &lt;code&gt;git patch -p&lt;/code&gt; more
effectively: &lt;a href="https://jonas.github.io/tig/"&gt;&lt;code&gt;tig status&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I already use &lt;code&gt;tig&lt;/code&gt; every once in a while but wasn&amp;rsquo;t aware that it could do that.&lt;/p&gt;
&lt;p&gt;I won&amp;rsquo;t try to illustrate the command output here (it&amp;rsquo;s a TUI); simply give it a
try the next time you run &lt;code&gt;git diff&lt;/code&gt; or &lt;code&gt;git add&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s also possible to stage per file and per hunk changes in the TUI. This
operation mode somewhats resemble
&lt;a href="https://github.com/andrewshadura/git-crecord"&gt;&lt;code&gt;git-crecord&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;git subcommand to interactively select changes to commit or stage&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;hellip;which I packaged to the &lt;a href="https://aur.archlinux.org/packages/git-crecord"&gt;Arch User
Repository&lt;/a&gt; a long time ago, but
ended up barely using it. Let&amp;rsquo;s see whether &lt;code&gt;tig status&lt;/code&gt; will stick.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git diff interactively"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: reset default branch</title><link>https://perrotta.dev/2025/10/git-reset-default-branch/</link><pubDate>Thu, 16 Oct 2025 17:20:45 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/10/git-reset-default-branch/</guid><description>&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: Given an existing repository whose default branch is
&lt;code&gt;master&lt;/code&gt;, make it become &amp;ldquo;fresh&amp;rdquo; (=fully reset it), as if it had just been
created.&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;# backup the current default branch, just in case
git branch backup-old-master
git push origin backup-old-master

# create an orphan branch
git checkout --orphan temp

# remove everything ‚Äì use one or some of the following, accordingly
git reset --hard
rm {all files}
git rm {all files}

# create an initial commit ‚Äì c.f. https://perrotta.dev/2025/02/git-blank-commit/
git blank

# delete the old default branch
git branch -D master

# rename temp to master, pick one of the following
git rb master # this is my alias for &amp;#34;rename branch&amp;#34;
git branch -m master # the native way

# override the current master
git push --force origin master&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: reset default branch"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: partially cherry-pick a commit</title><link>https://perrotta.dev/2025/10/git-partially-cherry-pick-a-commit/</link><pubDate>Wed, 15 Oct 2025 11:08:27 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/10/git-partially-cherry-pick-a-commit/</guid><description>&lt;p&gt;&lt;strong&gt;OR&lt;/strong&gt;: &amp;ldquo;cherry-pick a cherry-pick&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://adamj.eu/tech/2025/09/08/git-partial-cherry-pick/"&gt;Adam Johnson&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;git cherry-pick allows you to copy a commit another branch to your current
one.&lt;/p&gt;
&lt;p&gt;[&amp;hellip;]&lt;/p&gt;
&lt;p&gt;One limitation with a straight-up git cherry-pick, as above, is that it always
copies the entire commit. If a commit contains multiple changes, but you only
want one of them, you&amp;rsquo;ll need to undo the undesired cherry-picked changes.
This can be tedious and error-prone.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The trick is to use the &lt;a href="https://git-scm.com/docs/git-cherry-pick"&gt;&lt;code&gt;-n&lt;/code&gt;
(&lt;code&gt;--no-commit&lt;/code&gt;)&lt;/a&gt; argument to prevent changes from
being committed right away.&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git cherry-pick -n {branch or SHA}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;This happens to be the default in
&lt;a href="https://mercurial-scm.org/help/commands/graft"&gt;mercurial&lt;/a&gt; with &lt;code&gt;hg graft&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;As such, another possibility is to create an alias:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;[alias]
 graft = cherry-pick -n&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git graft {branch or SHA}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: partially cherry-pick a commit"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: list branches by recent activity</title><link>https://perrotta.dev/2025/10/git-list-branches-by-recent-activity/</link><pubDate>Wed, 15 Oct 2025 10:59:58 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/10/git-list-branches-by-recent-activity/</guid><description>&lt;p&gt;Tweak &lt;code&gt;~/.gitconfig&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;[alias]
 xl = branch -vv

[branch]
	sort = -committerdate&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;: &lt;code&gt;git xl&lt;/code&gt; will print your repository branches sorted by the most
recent ones in terms of activity, instead of the alphabetical default.&lt;/p&gt;
&lt;p&gt;I have this setting for a long time, and IMHO it&amp;rsquo;s a better default.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://tekin.co.uk/2021/11/listing-most-recent-git-branches"&gt;This post&lt;/a&gt; by
Tekin S√ºleyman prompted me to share it.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: list branches by recent activity"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: commit with the wrong email</title><link>https://perrotta.dev/2025/10/git-commit-with-the-wrong-email/</link><pubDate>Tue, 14 Oct 2025 13:50:36 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/10/git-commit-with-the-wrong-email/</guid><description>&lt;p&gt;You are sending a PR upstream.&lt;/p&gt;
&lt;p&gt;You accidentally commit it with the wrong email.&lt;/p&gt;
&lt;p&gt;First, you prevent this mistake from happening again by updating your
&lt;code&gt;~/.gitconfig&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;And now you need to fix the most recent commit.&lt;/p&gt;
&lt;p&gt;You can easily do so with:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git commit --amend --reset-author --no-edit&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Alternatively, with &lt;a href="https://github.com/thiagowfx/.dotfiles"&gt;my aliases&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;git uncommit &amp;amp;&amp;amp; git recommit&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: commit with the wrong email"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: merge two repositories</title><link>https://perrotta.dev/2025/10/git-merge-two-repositories/</link><pubDate>Sun, 12 Oct 2025 15:52:06 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/10/git-merge-two-repositories/</guid><description>&lt;p&gt;Daniel Roy Greenfeld, &lt;a href="https://daniel.feldroy.com/posts/til-2025-09-merging-two-git-projects"&gt;TIL: Merging two git projects&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Of course this task can be done with copy/paste. The challenge there is the
loss of git history. All the history of struggles and tribulations are gone.
More important is the attribution ‚Äî unless any and all contributors are made
co-authors. But then the volume of attribution isn&amp;rsquo;t accurate, some one who
made one tiny change gets as much credit as the leading contributor.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Adapted to my own words: we will merge &amp;ldquo;atreides&amp;rdquo; into &amp;ldquo;harkonnen&amp;rdquo;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;cd&lt;/code&gt; to &lt;code&gt;harkonnen&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git remote add atreides {atreides git repo URL}&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git fetch atreides&lt;/code&gt; (or &lt;code&gt;git fetch --all&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git merge atreides/master --allow-unrelated-histories&lt;/code&gt; # or main, if applicable&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Fin.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: merge two repositories"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git blame: prior commits</title><link>https://perrotta.dev/2025/09/git-blame-prior-commits/</link><pubDate>Mon, 29 Sep 2025 10:41:15 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/09/git-blame-prior-commits/</guid><description>&lt;p&gt;Let&amp;rsquo;s say you want to inspect the history of a given file tracked in a git
repository. Straightforward with &lt;a href="https://man.archlinux.org/man/extra/git/git-blame.1.en"&gt;&lt;code&gt;git-blame(1)&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git --no-pager blame templates/secret-aws-info.yaml
5d478f6cb83b (Kubernetes Astronaut 2025-08-05 10:49:07 -0400 1) {{- if or (eq .Values.config.cloud.provider &amp;#34;aws&amp;#34;) (not (.Values.config.externalDNS).enabled) }}
1aeb7c4d7b9b (Thiago Perrotta 2025-04-06 13:11:45 &amp;#43;0200 2) apiVersion: v1
1aeb7c4d7b9b (Thiago Perrotta 2025-04-06 13:11:45 &amp;#43;0200 3) kind: Secret&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;I am not interested in &lt;code&gt;5d478f6cb83b&lt;/code&gt; though: it was just a refactoring change.
How can I look deeper in history? More specifically, I&amp;rsquo;d like to run &lt;code&gt;git blame&lt;/code&gt;
on a point in time
&lt;a href="https://stackoverflow.com/questions/5098256/how-can-i-view-prior-commits-with-git-blame"&gt;&lt;em&gt;before&lt;/em&gt;&lt;/a&gt; commit &lt;code&gt;5d478f6cb83b&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git --no-pager blame 5d478f6cb83b^ templates/secret-aws-info.yaml
1aeb7c4d7b9b (Thiago Perrotta 2025-04-06 13:11:45 &amp;#43;0200 1) {{- if or (eq .Values.config.cloudProvider &amp;#34;aws&amp;#34;) (not (.Values.config.externalDNS).enabled) }}
1aeb7c4d7b9b (Thiago Perrotta 2025-04-06 13:11:45 &amp;#43;0200 2) apiVersion: v1
1aeb7c4d7b9b (Thiago Perrotta 2025-04-06 13:11:45 &amp;#43;0200 3) kind: Secret&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;And I could keep going on:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git --no-pager blame 1aeb7c4d7b9b^ templates/secret-aws-info.yaml
[...]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The Chromium project has a
&lt;a href="https://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/git-hyper-blame.html"&gt;&lt;code&gt;git-hyper-blame(1)&lt;/code&gt;&lt;/a&gt; script:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Like git blame, but with the ability to ignore or bypass certain commits.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;hellip;that enables tracking refactoring/cleanup commits on a permanent basis for
skipping blame.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git blame: prior commits"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: ignore changes to tracked files</title><link>https://perrotta.dev/2025/08/git-ignore-changes-to-tracked-files/</link><pubDate>Tue, 26 Aug 2025 14:46:44 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/08/git-ignore-changes-to-tracked-files/</guid><description>&lt;p&gt;&lt;a href="https://perrotta.dev/2025/08/midnight-commander-colorscheme/"&gt;Previously&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Given this config file for &lt;a href="https://midnight-commander.org/"&gt;midnight
commander&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% head -n 2 ~/.dotfiles/mc/.config/mc/ini
[Midnight-Commander]
skin=modarin256&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;hellip;properly installed via &lt;code&gt;stow&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% (cd ~/.dotfiles &amp;amp;&amp;amp; stow mc)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Upon opening &lt;code&gt;mc&lt;/code&gt;, it writes a lot of configuration settings to that file:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;[Midnight-Commander]
skin=modarin256
verbose=true
shell_patterns=true
auto_save_setup=true
preallocate_space=false
auto_menu=false
use_internal_view=true
use_internal_edit=true
clear_before_exec=true
[...]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;I could check them into source control, but I do not want to. They are defaults.&lt;/p&gt;
&lt;p&gt;So I tell &lt;code&gt;git&lt;/code&gt; to leave these additions alone:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git update-index --skip-worktree mc/.config/mc/ini&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Now &lt;code&gt;git status&lt;/code&gt; will not show the file.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: ignore changes to tracked files"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>ArgoCD: git index.lock issue</title><link>https://perrotta.dev/2025/08/argocd-git-index.lock-issue/</link><pubDate>Sat, 23 Aug 2025 12:39:14 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><category>kubernetes</category><guid>https://perrotta.dev/2025/08/argocd-git-index.lock-issue/</guid><description>&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: Every ArgoCD application is stuck in &lt;em&gt;Unknown&lt;/em&gt; state,
with the following error:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;Failed to load target state: failed to generate manifest for source 1 of 2:
rpc error: code = Unknown desc = failed to initialize repository resources: rpc
error: code = Internal desc = Failed to checkout FETCH_HEAD: failed to checkout
FETCH_HEAD: `git checkout --force FETCH_HEAD` failed exit status 128: fatal:
Unable to create &amp;#39;&amp;lt;path to cached source&amp;gt;/.git/index.lock&amp;#39;: File exists. Another
git process seems to be running in this repository, e.g. an editor opened by
&amp;#39;git commit&amp;#39;. Please make sure all processes are terminated then try again. If
it still fails, a git process may have crashed in this repository earlier:
remove the file manually to continue.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;It is a lock contention race condition issue within the ArgoCD repo server
component, with the git &lt;code&gt;index.lock&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The easiest way to address it is to restart the repo server:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;kubectl rollout restart deploy -n argocd argocd-repo-server&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Afterwards, refresh all applications in the cluster via the web UI:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;click Applications on the left-side nav bar&lt;/li&gt;
&lt;li&gt;click Refresh apps at the top&lt;/li&gt;
&lt;li&gt;select ALL applications, set refresh type to NORMAL&lt;/li&gt;
&lt;li&gt;click refresh&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: ArgoCD: git index.lock issue"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/kubernetes/"&gt;#kubernetes&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ git ll</title><link>https://perrotta.dev/2025/08/git-ll/</link><pubDate>Tue, 12 Aug 2025 12:50:09 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/08/git-ll/</guid><description>&lt;p&gt;In my &lt;code&gt;~/.gitconfig&lt;/code&gt; there&amp;rsquo;s an alias for &lt;code&gt;git log&lt;/code&gt;, inspired by &lt;a href="https://registerspill.thorstenball.com/p/how-i-use-git"&gt;Thorsten
Ball&lt;/a&gt;&lt;sup id="fnref:1"&gt;&lt;a href="https://perrotta.dev/2025/08/git-ll/#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;[alias]
 ll = &amp;#34;!f() { git log --graph --pretty=&amp;#39;tformat:%C(always,yellow)%h%C(always,reset) %C(always,green)%ar%C(always,reset){%C(always,bold blue)%an%C(always,reset){%C(always,red)%d%C(always,reset) %s&amp;#39; \&amp;#34;$@\&amp;#34; | column -t -s &amp;#39;{&amp;#39; | less -XS; }; f&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;I wish I could get rid of the shell utilities (&lt;code&gt;column&lt;/code&gt; and &lt;code&gt;less&lt;/code&gt;), but they&amp;rsquo;re
necessary to properly align the columns.&lt;/p&gt;
&lt;p&gt;I also tried to get rid of the function wrapper (&lt;code&gt;f()&lt;/code&gt;): it works when you run
&lt;code&gt;git ll&lt;/code&gt;. However when you run &lt;code&gt;git ll .&lt;/code&gt; (=display the commit history from
files underneath the current directory only) it fails:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;% git ll .
. is a directory&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Therefore it&amp;rsquo;s better to keep it around. I am satisfied with the current form.&lt;/p&gt;
&lt;p&gt;The output looks like this (image from upstream):&lt;/p&gt;
&lt;p&gt;&lt;img src="https://substackcdn.com/image/fetch/$s_!1Mdk!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf41b48e-523f-4f82-abc0-db4b1d27c689_2310x1374.png" alt="git ll output"
 loading="lazy" decoding="async" /&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update(2025-08-21)&lt;/strong&gt;: The following modification is better&lt;sup id="fnref:2"&gt;&lt;a href="https://perrotta.dev/2025/08/git-ll/#fn:2" class="footnote-ref" role="doc-noteref"&gt;2&lt;/a&gt;&lt;/sup&gt; and has no
external dependencies:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;[alias]
 ll = log --graph --pretty=tformat:&amp;#39;%C(always,yellow)%h%C(always,reset) %C(always,green)%&amp;lt;(25,trunc)%ar%C(always,reset) %C(always,bold blue)%&amp;lt;(20,trunc)%an%C(always,reset) %C(always,red)%d%C(always,reset) %s&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="footnotes" role="doc-endnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;His original configuration is a separate shell function, which is
completely unnecessary. A git alias suffices. Keep it simple!&amp;#160;&lt;a href="https://perrotta.dev/2025/08/git-ll/#fnref:1" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;In the original implementation, &lt;code&gt;git ll .&lt;/code&gt; did not work as expected
(i.e. it did not display changes &lt;em&gt;only&lt;/em&gt; from the current directory).&amp;#160;&lt;a href="https://perrotta.dev/2025/08/git-ll/#fnref:2" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git ll"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ git: --no-pager</title><link>https://perrotta.dev/2025/08/git--no-pager/</link><pubDate>Tue, 12 Aug 2025 12:21:22 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/08/git--no-pager/</guid><description>&lt;p&gt;Let&amp;rsquo;s say you use color highlighting to visually inspect diffs with &lt;code&gt;git&lt;/code&gt;, such
as &lt;a href="https://github.com/dandavison/delta"&gt;&lt;code&gt;delta&lt;/code&gt;&lt;/a&gt; or
&lt;a href="https://github.com/git/git/blob/master/contrib/diff-highlight/README"&gt;&lt;code&gt;diff-highlight&lt;/code&gt;&lt;/a&gt;
or &lt;a href="https://github.com/mookid/diffr"&gt;&lt;code&gt;diffr&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Implication&lt;/strong&gt;: whenever you run &lt;code&gt;git diff&lt;/code&gt;, &lt;code&gt;git show&lt;/code&gt;, or any other &lt;code&gt;git&lt;/code&gt;
command that produces a diff, it will emit colors (typically red and green).&lt;/p&gt;
&lt;p&gt;Colors are great for local visual inspection, but they are terrible for sharing.
They won&amp;rsquo;t be carried over with copy-and-paste.&lt;/p&gt;
&lt;p&gt;If you intend to share diff output (e.g. to a Q&amp;amp;A site, with teammates), it&amp;rsquo;s
better to emit &lt;code&gt;-&lt;/code&gt; and &lt;code&gt;+&lt;/code&gt;, as vanilla &lt;code&gt;diff&lt;/code&gt; does.&lt;/p&gt;
&lt;p&gt;The easiest way to do so is to pass &lt;code&gt;--no-pager&lt;/code&gt; to &lt;code&gt;git&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;git --no-pager diff a83bc395
git --no-pager show HEAD&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;For example, a recent commit in my
&lt;a href="https://github.com/thiagowfx/.dotfiles"&gt;dotfiles&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git --no-pager show HEAD~1
commit 52b1e91b0f1d93176ec768aa6158974fc401f335
Author: Thiago Perrotta &amp;lt;{redacted}&amp;gt;
Date: Thu Aug 7 12:00:47 2025 &amp;#43;0200

 fix mr

diff --git bin/.bin/sd-world bin/.bin/sd-world
index c46be0e..44c0b47 100755
--- bin/.bin/sd-world
&amp;#43;&amp;#43;&amp;#43; bin/.bin/sd-world
@@ -58,7 &amp;#43;58,7 @@ esac
 run_if_exists &amp;#34;claude&amp;#34; claude update

 # myrepos
-run_if_exists &amp;#34;mr&amp;#34; mr -d ~ update
&amp;#43;(cd ~ &amp;amp;&amp;amp; run_if_exists &amp;#34;mr&amp;#34; mr update)

 # source corp updates if any
 run_if_exists &amp;#34;sd-world-corp&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Note that &lt;code&gt;--no-pager&lt;/code&gt; is a &lt;code&gt;git&lt;/code&gt;-level option: it should be specified before
the git subcommand. The following does not work:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git show HEAD~1 --no-pager
fatal: unrecognized argument: --no-pager&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: --no-pager"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: developer certificate of origin (DCO) sign-off</title><link>https://perrotta.dev/2025/07/git-developer-certificate-of-origin-dco-sign-off/</link><pubDate>Thu, 24 Jul 2025 12:37:31 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/07/git-developer-certificate-of-origin-dco-sign-off/</guid><description>&lt;p&gt;The &lt;a href="https://developercertificate.org/"&gt;Developer Certificate of Origin&lt;/a&gt; (DCO
for short) is often required when sending out PRs upstream.&lt;/p&gt;
&lt;p&gt;For example, contributions to the Linux kernel
&lt;a href="https://wiki.linuxfoundation.org/dco"&gt;mandate&lt;/a&gt; it.
&lt;a href="https://cert-manager.io/docs/contributing/sign-off/"&gt;Other&lt;/a&gt;
&lt;a href="https://gcc.gnu.org/dco.html"&gt;projects&lt;/a&gt;
&lt;a href="https://docs.pi-hole.net/guides/github/dco/"&gt;too&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s even possible to enforce it via &lt;a href="https://github.com/apps/dco"&gt;Github
Actions&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Suppose that you sent a PR with a single commit but forgot to sign it off. You
can amend it with:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;git rebase HEAD~1 --signoff
git push --force-with-lease origin [branch]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Or you can do it proactively, at commit time:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;git commit [-s | --signoff]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;It is
&lt;a href="https://stackoverflow.com/questions/77279077/how-to-sign-off-every-git-commit"&gt;often&lt;/a&gt;
&lt;a href="https://git-scm.com/docs/git-config#Documentation/git-config.txt-formatsignOff"&gt;discouraged&lt;/a&gt;
to have &lt;code&gt;git&lt;/code&gt; automatically do it:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Adding the Signed-off-by trailer to a patch should be a conscious act and means
that you certify you have the rights to submit this work under the same open
source license.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In practice, a sign-off is an ordinary &lt;a href="https://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/git-footers.html"&gt;git
footer&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;Signed-off-by: John Doe &amp;lt;john@example.com&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: developer certificate of origin (DCO) sign-off"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Markdown headings and git comments</title><link>https://perrotta.dev/2025/07/markdown-headings-and-git-comments/</link><pubDate>Tue, 08 Jul 2025 13:18:09 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/07/markdown-headings-and-git-comments/</guid><description>&lt;p&gt;Our team uses a PR template that resembles the following:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;% cat .github/pull_request_template.md
## Summary

&amp;lt;!-- Provide a clear and concise description of the changes.
Provide a link to the corresponding PR in other repositories if applicable. --&amp;gt;

## Jira Task

- [ ] No ticket needed

https://acme.atlassian.net/browse/XXX

## Cluster(s) Affected

&amp;lt;!-- List the clusters affected by this change --&amp;gt;

## Impact

&amp;lt;!-- Describe the impact of these changes. Will this require downtime? Are there
any performance considerations? --&amp;gt;

## Testing

&amp;lt;!-- Describe how you&amp;#39;ve tested these changes --&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a href="https://perrotta.dev/2025/05/github-pull-request-template/"&gt;Previously&lt;/a&gt; I wrote
about how to automatically incorporate github pull request templates in &lt;code&gt;git commit&lt;/code&gt; (&lt;code&gt;COMMIT_EDITMSG&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;It turns out there&amp;rsquo;s one caveat with this approach.&lt;/p&gt;
&lt;p&gt;Markdown headings&lt;sup id="fnref:1"&gt;&lt;a href="https://perrotta.dev/2025/07/markdown-headings-and-git-comments/#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt; (&lt;code&gt;##&lt;/code&gt; for &lt;code&gt;&amp;lt;h2&amp;gt;&lt;/code&gt;) use the same character as git line comments
(&lt;code&gt;#&lt;/code&gt;) for commit messages.&lt;/p&gt;
&lt;p&gt;As a side effect, when pulling up the template locally with a plain git commit,
the headings do not show up in the final commit message.&lt;/p&gt;
&lt;p&gt;This can be worked around by using &lt;code&gt;gh pr create&lt;/code&gt; instead, but it &lt;a href="https://xkcd.com/1172/"&gt;breaks my
setup&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Another workaround is to convert the headings to use &lt;code&gt;----&lt;/code&gt; markers, for example:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;Summary
-------

&amp;lt;!-- Provide a clear and concise description of the changes.
Provide a link to the corresponding PR in other repositories if applicable. --&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;: A teammate pointed out the following workaround, which is the most
elegant of them:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://git-scm.com/docs/git-config#Documentation/git-config.txt-corecommentChar"&gt;&lt;code&gt;core.commentChar&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Commands such as &lt;code&gt;commit&lt;/code&gt; and &lt;code&gt;tag&lt;/code&gt; that let you edit messages consider a line
that begins with this character commented, and removes them after the editor
returns (default &lt;code&gt;#&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;If set to &amp;ldquo;auto&amp;rdquo;, git-commit would select a character that is not the
beginning character of any line in existing commit messages.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;And that&amp;rsquo;s exactly what I did:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git config set --global core.commentChar &amp;#34;auto&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The effect, it automatically picks &lt;code&gt;;&lt;/code&gt; as the comment character:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;## Summary

&amp;lt;!-- Provide a clear and concise description of the changes.
Provide a link to the corresponding PR in other repositories if applicable. --&amp;gt;

; Please enter the commit message for your changes. Lines starting
; with &amp;#39;;&amp;#39; will be ignored, and an empty message aborts the commit.
;
; On branch master
; Your branch is up to date with &amp;#39;origin/master&amp;#39;.
;
; ------------------------ &amp;gt;8 ------------------------
; Do not modify or remove the line above.
; Everything below it will be ignored.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="footnotes" role="doc-endnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;I am always forgetting whether to call them &amp;ldquo;headings&amp;rdquo; or &amp;ldquo;headers&amp;rdquo;.&amp;#160;&lt;a href="https://perrotta.dev/2025/07/markdown-headings-and-git-comments/#fnref:1" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: Markdown headings and git comments"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Oh Shit, Git!?!</title><link>https://perrotta.dev/2025/06/oh-shit-git/</link><pubDate>Thu, 19 Jun 2025 13:55:45 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/06/oh-shit-git/</guid><description>&lt;p&gt;&lt;a href="https://ohshitgit.com/"&gt;https://ohshitgit.com/&lt;/a&gt; by Katie Sylor-Miller:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Git is hard: screwing up is easy, and figuring out how to fix your mistakes is
fucking impossible. Git documentation has this chicken and egg problem where
you can&amp;rsquo;t search for how to get yourself out of a mess, unless you already
know the name of the thing you need to know about in order to fix your
problem.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;So here are some bad situations I&amp;rsquo;ve gotten myself into, and how I eventually
got myself out of them in plain english.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I love these websites created with the sole purpose of filling in the void of
tool usability.&lt;/p&gt;
&lt;p&gt;Other notable examples from the top of my head:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://git-send-email.io/"&gt;https://git-send-email.io/&lt;/a&gt; by &lt;a href="https://drewdevault.com/"&gt;Drew DeVault&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://yaml-multiline.info/"&gt;https://yaml-multiline.info/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: Oh Shit, Git!?!"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ git delta</title><link>https://perrotta.dev/2025/06/git-delta/</link><pubDate>Mon, 16 Jun 2025 13:28:23 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/06/git-delta/</guid><description>&lt;p&gt;I&amp;rsquo;ve been using the venerable
&lt;a href="https://github.com/git/git/tree/master/contrib/diff-highlight"&gt;&lt;code&gt;diff-highlight&lt;/code&gt;&lt;/a&gt;
script to power various &lt;code&gt;git diff&lt;/code&gt; operations in the terminal. It is a decent
improvement on top of stock &lt;code&gt;git diff&lt;/code&gt;, but it&amp;rsquo;s somewhat of an
&lt;a href="https://github.com/thiagowfx/.dotfiles/blob/94fa66d62260c7c5e133f50beef6181f098b3599/git/.profile.d/git.sh#L11"&gt;annoying&lt;/a&gt;
maintenance burden to manage it across various environments, as it&amp;rsquo;s installed
in different ways on various systems:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;#!/bin/sh

if hash git &amp;gt;/dev/null 2&amp;gt;&amp;amp;1; then
	# git-diff-highlight: alpine:/usr/bin/, arch, debian
	path_munge &amp;#34;/usr/share/git/diff-highlight&amp;#34; &amp;#34;/usr/share/doc/git/contrib/diff-highlight&amp;#34;

	# brew
	if hash brew &amp;gt;/dev/null 2&amp;gt;&amp;amp;1; then
		path_munge &amp;#34;$(brew --prefix)&amp;#34;/share/git-core/contrib/diff-highlight
	fi

fi&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Thus I decided to migrate to &lt;a href="https://github.com/dandavison/delta"&gt;&lt;code&gt;git-delta&lt;/code&gt;&lt;/a&gt;,
which is:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;quite popular&lt;/li&gt;
&lt;li&gt;written in Rust‚Ñ¢&lt;sup id="fnref:1"&gt;&lt;a href="https://perrotta.dev/2025/06/git-delta/#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://repology.org/project/git-delta/versions"&gt;available&lt;/a&gt; in all package
managers I&amp;rsquo;m interested in ‚Äì hence it&amp;rsquo;s &lt;strong&gt;one install command away from my
system&lt;/strong&gt;, no need for extra configs &amp;lt;== And this is the main reason I wanted
to migrate to it.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;On macOS, the package is called &lt;code&gt;git-delta&lt;/code&gt; whereas the binary is called
&lt;code&gt;delta&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% brew install git-delta
% brew ls git-delta | grep bin/
/opt/homebrew/Cellar/git-delta/0.18.2_3/bin/delta&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The integration with &lt;code&gt;git&lt;/code&gt; is as follows:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% grep -E &amp;#39;\[core\]|pager =|delta&amp;#39; ~/.gitconfig
[core]
 # delta &amp;gt; diff-highlight &amp;gt; plain cat
 pager = &amp;#34;delta --diff-highlight 2&amp;gt;/dev/null || ((diff-highlight 2&amp;gt;/dev/null || cat) | ${PAGER:-less})&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;It falls back to &lt;code&gt;diff-highlight&lt;/code&gt; when &lt;code&gt;delta&lt;/code&gt; is not available.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;delta&lt;/code&gt; is quite
&lt;a href="https://dandavison.github.io/delta/configuration.html"&gt;configurable&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% grep -EA3 &amp;#39;\[delta\]&amp;#39; ~/.gitconfig
[delta]
 navigate = true
 side-by-side = false
 line-numbers = true&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;One caveat of using &lt;code&gt;delta&lt;/code&gt;: the &lt;code&gt;git diff&lt;/code&gt; output is not suitable for sharing,
as it does not contain diff markers, relying on colors instead.
See &lt;a href="https://perrotta.dev/2025/08/git--no-pager/"&gt;this post&lt;/a&gt; for a workaround.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update(2025-09-07)&lt;/strong&gt;: I&amp;rsquo;ve been finding &lt;code&gt;delta&lt;/code&gt; quite pleasant to use.&lt;/p&gt;
&lt;div class="footnotes" role="doc-endnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;Always an (over)hyped reason to migrate, but, oh well&amp;hellip;&amp;#160;&lt;a href="https://perrotta.dev/2025/06/git-delta/#fnref:1" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git delta"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>.gitignore .claude/settings.local.json</title><link>https://perrotta.dev/2025/06/.gitignore-.claude/settings.local.json/</link><pubDate>Thu, 12 Jun 2025 22:17:43 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/06/.gitignore-.claude/settings.local.json/</guid><description>&lt;p&gt;The initial attempt:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% cat ~/.gitignore
.claude/settings.local.json&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;However, it doesn&amp;rsquo;t work when you run &lt;a href="https://www.anthropic.com/claude-code"&gt;claude
code&lt;/a&gt; in a subdirectory of your git
repository root. &lt;code&gt;git diff&lt;/code&gt; still surfaces it.&lt;/p&gt;
&lt;p&gt;The correct form is:&lt;/p&gt;
&lt;div class="codeblock" data-lang="diff"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;diff&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-diff"&gt;-.claude/settings.local.json
&amp;#43;**/.claude/settings.local.json&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Add &lt;code&gt;**&lt;/code&gt; to include subdirectories as well.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: .gitignore .claude/settings.local.json"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ git commit: automatically add pull request template</title><link>https://perrotta.dev/2025/06/git-commit-automatically-add-pull-request-template/</link><pubDate>Thu, 12 Jun 2025 21:09:36 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/06/git-commit-automatically-add-pull-request-template/</guid><description>&lt;p&gt;GitHub supports &lt;a href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/creating-a-pull-request-template-for-your-repository"&gt;pull request
templates&lt;/a&gt;.
Define a &lt;code&gt;.github/PULL_REQUEST_TEMPLATE.md&lt;/code&gt; directory in your git repo, and it
will be automatically used when creating PRs via the GitHub web UI and via the
CLI tool (&lt;a href="https://cli.github.com/"&gt;&lt;code&gt;gh&lt;/code&gt;&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;But what about commits created locally, via a plain &lt;code&gt;git commit&lt;/code&gt;?&lt;/p&gt;
&lt;p&gt;As per &lt;a href="https://git-scm.com/docs/git-commit/2.49.0#Documentation/git-commit.txt-code--templateltfilegtcode"&gt;git
docs&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;commit.template&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Specify the pathname of a file to use as the template for new commit messages.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Therefore, the following &lt;code&gt;~/.gitconfig&lt;/code&gt; works:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;[commit]
 template = .github/PULL_REQUEST_TEMPLATE.md&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The file path (pathname) is relative to the git repository root.&lt;/p&gt;
&lt;p&gt;However, this will fail in repositories that do not have a template:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;% git commit
fatal: could not read &amp;#39;.github/PULL_REQUEST_TEMPLATE.md&amp;#39;: No such file or directory&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;There&amp;rsquo;s a workaround: use &lt;a href="https://git-scm.com/docs/git-config#_includes"&gt;&lt;code&gt;includeIf&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% tail -3 ~/.gitconfig
# Import corp configs if any.
[include]
 path = .gitconfig_corp&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% cat ~/.gitconfig_corp
[includeIf &amp;#34;gitdir:~/mycompany/**&amp;#34;]
 path = .gitconfig_mycompany

[includeIf &amp;#34;hasconfig:remote.*.url:git@github.com:mycompany/**&amp;#34;]
 path = .gitconfig_mycompany&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% cat ~/.gitconfig_mycompany
[commit]
 template = .github/PULL_REQUEST_TEMPLATE.md&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;This way, the github PR template is only included for git repositories from my
company.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git commit: automatically add pull request template"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git pull: authentication issues</title><link>https://perrotta.dev/2025/06/git-pull-authentication-issues/</link><pubDate>Tue, 03 Jun 2025 14:35:04 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><category>security</category><category>ssh</category><guid>https://perrotta.dev/2025/06/git-pull-authentication-issues/</guid><description>&lt;p&gt;&lt;code&gt;git pull&lt;/code&gt; authentication issues is &lt;em&gt;really&lt;/em&gt; a disguise for &lt;code&gt;ssh&lt;/code&gt; auth issues.&lt;/p&gt;
&lt;p&gt;Today a teammate could not &lt;code&gt;git pull&lt;/code&gt; one of our internal repos:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;% git pull
Enter passphrase for key &amp;#39;/Users/user/.ssh/id_ed25519&amp;#39;:
git@github.com: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The first thing we verified was that his public key was
&lt;a href="https://github.com/settings/keys"&gt;added&lt;/a&gt; to his github profile, and that the
private key was present in &lt;code&gt;~/.ssh/id_ed25519&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Next, verify &lt;code&gt;~/.ssh/config&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;Host github.com
AddKeysToAgent yes
UseKeychain yes
IdentityFile ~/.ssh/id_ed25519&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Looks fine. Then:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% export GIT_SSH_COMMAND=&amp;#34;ssh -vvv&amp;#34;
% git pull
[...]
debug3: Search for item with query: {
 acct = &amp;#34;/Users/user/.ssh/id_ed25519&amp;#34;;
 agrp = &amp;#34;com.apple.ssh.passphrases&amp;#34;;
 class = genp;
 labl = &amp;#34;SSH: /Users/user/.ssh/id_ed25519&amp;#34;;
 nleg = 1;
 &amp;#34;r_Data&amp;#34; = 1;
 svce = OpenSSH;
 &amp;#34;u_AuthUI&amp;#34; = &amp;#34;u_AuthUIF&amp;#34;;
}
debug2: Unexpected keychain error while searching for an item: User interaction is not allowed.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Herein lies the error! The interaction with the system keychain in macOS was not
successful.&lt;/p&gt;
&lt;p&gt;I suggested him to remove &lt;code&gt;AddKeysToAgent&lt;/code&gt; and &lt;code&gt;UseKeychain&lt;/code&gt; from this config
file, but that did not work either:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git pull
[...]
Enter passphrase for key &amp;#39;/Users/user/.ssh/id_ed25519&amp;#39;:
debug2: no passphrase given, try next key
debug2: we did not send a packet, disable method
debug1: No more authentication methods to try.
git@github.com: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The ssh key is protected with a passphrase.&lt;/p&gt;
&lt;p&gt;In this case, it&amp;rsquo;s better to fix the keychain issue. We readd the two deleted
lines.&lt;/p&gt;
&lt;p&gt;Restart the &lt;code&gt;ssh-agent&lt;/code&gt; and readd the key there:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% eval &amp;#34;$(ssh-agent -s)&amp;#34;
% ssh-add -K ~/.ssh/id_ed25519&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Problem resolved! &lt;code&gt;git pull&lt;/code&gt; works now.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git pull: authentication issues"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/security/"&gt;#security&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/ssh/"&gt;#ssh&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: prefer switch over checkout</title><link>https://perrotta.dev/2025/03/git-prefer-switch-over-checkout/</link><pubDate>Thu, 20 Mar 2025 13:29:15 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/03/git-prefer-switch-over-checkout/</guid><description>&lt;p&gt;&lt;a href="https://stackoverflow.com/questions/57265785/whats-the-difference-between-git-switch-and-git-checkout-branch#57266005"&gt;Preliminaries&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;What&amp;rsquo;s the difference between &amp;lsquo;git switch&amp;rsquo; and &amp;lsquo;git checkout&amp;rsquo; &lt;branch&gt;?&lt;/p&gt;
&lt;p&gt;Git 2.23 introduces a new command &lt;code&gt;git switch&lt;/code&gt;. After reading the
documentation, it seems pretty much the same as &lt;code&gt;git checkout &amp;lt;branchname&amp;gt;&lt;/code&gt;.
What is the difference or use case?&lt;/p&gt;
&lt;p&gt;&lt;code&gt;git switch&lt;/code&gt; can now be used to change branches, as git checkout &lt;branchname&gt;
does&lt;/p&gt;
&lt;p&gt;People are confused by these different ways to use git checkout, as you can
see from the many questions regarding git checkout here on Stack Overflow. Git
developers seem to have taken this into account.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href="https://git-scm.com/docs/git-switch/2.23.0"&gt;&lt;code&gt;git switch&lt;/code&gt;&lt;/a&gt; is the idiomatic way
to switch branches these days. &lt;code&gt;git checkout&lt;/code&gt; can be ambiguous; not only it
switches branches, it can also revert/reset files and directories.&lt;/p&gt;
&lt;p&gt;I unexpectedly hit this ambiguity today.&lt;/p&gt;
&lt;p&gt;I have this &lt;code&gt;git bd&lt;/code&gt; alias:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;% grep -E &amp;#39;(bd|default\b)&amp;#39; ~/.gitconfig
 bd = !branch=&amp;#34;$(git branch --show-current)&amp;#34; &amp;amp;&amp;amp; git default &amp;amp;&amp;amp; git branch -D &amp;#34;${branch:-$1}&amp;#34;
 default = !git checkout main &amp;amp;&amp;gt;/dev/null || git checkout master&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;hellip;which is short for &amp;ldquo;branch delete&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt;: I am working on branch &lt;code&gt;thiagowfx/my-branch&lt;/code&gt;, then the commit/PR is
eventually merged. My next action is &lt;code&gt;git bd&lt;/code&gt;, which a) switches to the default
branch (main or master these days) and b) deletes the previous branch.&lt;/p&gt;
&lt;p&gt;This works well most of the time.&lt;/p&gt;
&lt;p&gt;Today, when
&lt;a href="https://gitlab.alpinelinux.org/alpine/aports/-/merge_requests/81638"&gt;bumping&lt;/a&gt;
the &lt;code&gt;yamlfmt&lt;/code&gt;
&lt;a href="https://pkgs.alpinelinux.org/package/edge/testing/x86_64/yamlfmt"&gt;package&lt;/a&gt; for
Alpine Linux, I was in the &lt;code&gt;yamlfmt&lt;/code&gt; branch and then ran &lt;code&gt;git bd&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;That didn&amp;rsquo;t do anything. Here&amp;rsquo;s the problem:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;% tree -L 1
.
‚îú‚îÄ‚îÄ CODINGSTYLE.md
‚îú‚îÄ‚îÄ COMMITSTYLE.md
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ community
‚îú‚îÄ‚îÄ main
‚îú‚îÄ‚îÄ scripts
‚îî‚îÄ‚îÄ testing&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;hellip;there&amp;rsquo;s a &lt;code&gt;main/&lt;/code&gt; directory in the repository root.&lt;/p&gt;
&lt;p&gt;Thus &lt;code&gt;git default&lt;/code&gt;, which calls &lt;code&gt;git checkout main&lt;/code&gt;, treats &lt;code&gt;main&lt;/code&gt; as a
directory in this context, instead of a branch.&lt;/p&gt;
&lt;p&gt;One solution is to call &lt;code&gt;git checkout main --&lt;/code&gt; instead, which explicitly denotes
&lt;code&gt;main&lt;/code&gt; as a branch&lt;sup id="fnref:1"&gt;&lt;a href="https://perrotta.dev/2025/03/git-prefer-switch-over-checkout/#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt;. However, that&amp;rsquo;s hard to remember and it&amp;rsquo;s also
confusing. It&amp;rsquo;s easier to simply do &lt;code&gt;git switch main&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;So here&amp;rsquo;s my updated alias, which works as originally intended:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;% grep -E &amp;#39;(bd|default\b)&amp;#39; ~/.gitconfig
 bd = !branch=&amp;#34;$(git branch --show-current)&amp;#34; &amp;amp;&amp;amp; git default &amp;amp;&amp;amp; git branch -D &amp;#34;${branch:-$1}&amp;#34;
 default = !git switch main &amp;amp;&amp;gt;/dev/null || git switch master&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="footnotes" role="doc-endnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;To explicitly denote it as a directory / file, call &lt;code&gt;git checkout -- main&lt;/code&gt;
instead. I use this variant often to revert file modifications back to the
original state.&amp;#160;&lt;a href="https://perrotta.dev/2025/03/git-prefer-switch-over-checkout/#fnref:1" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: prefer switch over checkout"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ git freeze, git thaw</title><link>https://perrotta.dev/2025/03/git-freeze-git-thaw/</link><pubDate>Wed, 19 Mar 2025 13:27:43 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><category>pre-commit</category><guid>https://perrotta.dev/2025/03/git-freeze-git-thaw/</guid><description>&lt;p&gt;Now I am becoming one of the snobs‚Ñ¢ with the first sentence in the following
paragraph. Here we go.&lt;/p&gt;
&lt;p&gt;I had &lt;a href="https://docs.anthropic.com/en/docs/agents-and-tools/claude-code/overview"&gt;Claude
Code&lt;/a&gt;&lt;sup id="fnref:1"&gt;&lt;a href="https://perrotta.dev/2025/03/git-freeze-git-thaw/#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt;
write me a pair of &lt;code&gt;git&lt;/code&gt; utilities: &lt;code&gt;git freeze&lt;/code&gt; and &lt;code&gt;git thaw&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;First of all: &amp;ldquo;to thaw&amp;rdquo; means &amp;ldquo;to defrost&amp;rdquo;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;To change from a frozen solid to a liquid by gradual warming.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Perhaps &lt;code&gt;git unfreeze&lt;/code&gt; would have been more intuitive, let&amp;rsquo;s leave the
bikeshedding to another day though.&lt;/p&gt;
&lt;p&gt;What should these utilities do? They are inspired by the ones with the same name
in Chromium
&lt;a href="https://www.chromium.org/developers/how-tos/install-depot-tools/"&gt;depot_tools&lt;/a&gt;.
&lt;a href="https://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/depot_tools_tutorial.html#_setting_up"&gt;Direct
link&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="https://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/git-freeze.html"&gt;&lt;code&gt;git-freeze(1)&lt;/code&gt;&lt;/a&gt;
allows you to put the current branch in &amp;lsquo;suspended animation&amp;rsquo; by committing
your changes to a specially-named commit on the top of your current branch.
When you come back to your branch later, you can just run
&lt;a href="https://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/git-thaw.html"&gt;&lt;code&gt;git-thaw(1)&lt;/code&gt;&lt;/a&gt;
to get your work-in-progress changes back to what they were.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Installing
&lt;a href="https://commondatastorage.googleapis.com/chrome-infra-docs/flat/depot_tools/docs/html/depot_tools.html"&gt;&lt;code&gt;depot_tools(7)&lt;/code&gt;&lt;/a&gt;
just to get these two utilities is too bloated though. The security software at
work flagged it as malware&lt;sup id="fnref:2"&gt;&lt;a href="https://perrotta.dev/2025/03/git-freeze-git-thaw/#fn:2" class="footnote-ref" role="doc-noteref"&gt;2&lt;/a&gt;&lt;/sup&gt;. And they didn&amp;rsquo;t even bother to package it for
Linux distributions in the first place.&lt;/p&gt;
&lt;h2 id="git-freeze"&gt;&lt;a href="https://github.com/thiagowfx/.dotfiles/blob/master/git/.bin/git-freeze"&gt;&lt;code&gt;git-freeze&lt;/code&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;#!/bin/sh
#
# git-freeze - Stage all files and create a git-freeze commit

set -e

# Check if we&amp;#39;re inside a git repository
if [ &amp;#34;$(git rev-parse --is-inside-work-tree 2&amp;gt;/dev/null)&amp;#34; != &amp;#34;true&amp;#34; ]; then
 echo &amp;#34;Error: Not in a git repository&amp;#34;
 exit 1
fi

# Stage all changes (tracked and untracked)
git add -A

# Create a commit with the freeze message
git commit -m &amp;#34;git-freeze&amp;#34; -n

echo &amp;#34;Git freeze created successfully&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h2 id="git-thaw"&gt;&lt;a href="https://github.com/thiagowfx/.dotfiles/blob/master/git/.bin/git-thaw"&gt;&lt;code&gt;git-thaw&lt;/code&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;#!/bin/sh
#
# git-thaw - Undo a git-freeze operation

set -e

# Check if we&amp;#39;re inside a git repository
if [ &amp;#34;$(git rev-parse --is-inside-work-tree 2&amp;gt;/dev/null)&amp;#34; != &amp;#34;true&amp;#34; ]; then
 echo &amp;#34;Error: Not in a git repository&amp;#34;
 exit 1
fi

# Check if there&amp;#39;s at least one commit
if ! git rev-parse --verify HEAD &amp;gt;/dev/null 2&amp;gt;&amp;amp;1; then
 echo &amp;#34;Error: No commits yet&amp;#34;
 exit 1
fi

# Check if the last commit is a git-freeze commit
if ! git log -n 1 --pretty=%B | grep -q &amp;#34;^git-freeze$&amp;#34;; then
 echo &amp;#34;Error: Last commit is not a git-freeze commit&amp;#34;
 exit 1
fi

# Undo the git-freeze commit
if git rev-parse --verify HEAD^ &amp;gt;/dev/null 2&amp;gt;&amp;amp;1; then
 # If there&amp;#39;s a parent commit, reset to it
 git reset &amp;#34;HEAD^&amp;#34;
else
 # If it&amp;#39;s the initial commit, delete the reference and unstage everything
 git update-ref -d HEAD
 git restore --staged .
fi

echo &amp;#34;Git freeze thawed successfully&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h2 id="post-ai-cleanup"&gt;Post-AI cleanup&lt;/h2&gt;
&lt;p&gt;The only change I had to make was to add &lt;code&gt;-n&lt;/code&gt; to &lt;code&gt;git commit&lt;/code&gt; in &lt;code&gt;git-freeze&lt;/code&gt; so
that pre-commit hooks would be skipped upon freeze.&lt;/p&gt;
&lt;h2 id="usage"&gt;Usage&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Within an existing &lt;code&gt;git&lt;/code&gt; repository, do some work in a custom branch.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Decide that something else more important and/or urgent needs your attention.
Let go of &lt;a href="https://git-scm.com/docs/git-worktree"&gt;git worktrees&lt;/a&gt; in this
instance.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;git freeze&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Switch to a new branch. Do whatever. Done.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;git checkout &amp;lt;your previous branch&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;git thaw&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Resume your previous work. Profit.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Edit(2025-03-20)&lt;/strong&gt;: A friend asked that is the difference between &lt;code&gt;git freeze&lt;/code&gt;
and &lt;code&gt;git stash&lt;/code&gt;. The main difference is that &lt;code&gt;git stash&lt;/code&gt; does not handle files
not yet tracked by &lt;code&gt;git&lt;/code&gt;, whereas &lt;code&gt;git freeze&lt;/code&gt; does. I think of &lt;code&gt;freeze&lt;/code&gt; as the
equivalent of completely clearing up my physical desk of all objects so that I
can focus on something else.&lt;/p&gt;
&lt;div class="footnotes" role="doc-endnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;&lt;em&gt;An agentic coding tool made by Anthropic. Currently in beta as a research
preview.&lt;/em&gt;&amp;#160;&lt;a href="https://perrotta.dev/2025/03/git-freeze-git-thaw/#fnref:1" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;In hindsight that&amp;rsquo;s not even surprising.&amp;#160;&lt;a href="https://perrotta.dev/2025/03/git-freeze-git-thaw/#fnref:2" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git freeze, git thaw"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/pre-commit/"&gt;#pre-commit&lt;/a&gt;&lt;/p&gt;</description></item><item><title>How core git developers configure git</title><link>https://perrotta.dev/2025/03/how-core-git-developers-configure-git/</link><pubDate>Mon, 10 Mar 2025 15:03:24 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/03/how-core-git-developers-configure-git/</guid><description>&lt;p&gt;&lt;a href="https://blog.gitbutler.com/how-git-core-devs-configure-git/"&gt;How Core Git Developers Configure
Git&lt;/a&gt; by Git Butler:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In this post, I&amp;rsquo;ll go through some of the perhaps obscure Git config settings
that I have personally globally enabled and go into them to explain what they
do and why they should probably be the default settings.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Lots of good defaults to adopt from there.&lt;/p&gt;
&lt;p&gt;I
&lt;a href="https://github.com/thiagowfx/.dotfiles/commit/31974676944732b91588e6604a29778ffa33099e"&gt;adopted&lt;/a&gt;
a few. It turns out I already had most of them in my
&lt;a href="https://github.com/thiagowfx/.dotfiles/blob/master/git/.gitconfig"&gt;&lt;code&gt;~/.gitconfig&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: How core git developers configure git"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ Using keep-sorted to keep your ~/.gitconfig tidy</title><link>https://perrotta.dev/2025/03/using-keep-sorted-to-keep-your-~/.gitconfig-tidy/</link><pubDate>Thu, 06 Mar 2025 22:53:23 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><category>pre-commit</category><guid>https://perrotta.dev/2025/03/using-keep-sorted-to-keep-your-~/.gitconfig-tidy/</guid><description>&lt;p&gt;I tend to sort my
&lt;a href="https://github.com/thiagowfx/.dotfiles/blob/master/git/.gitconfig"&gt;&lt;code&gt;~/.gitconfig&lt;/code&gt;&lt;/a&gt;
headings to keep the config tidy.&lt;/p&gt;
&lt;p&gt;An example:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;[...]
# https://git-scm.com/docs/git-rerere
[rerere]
	autoUpdate = true
	enabled = true

[status]
	# Show individual files in untracked directories.
	showUntrackedFiles = all
	short = true
	branch = true

[submodule]
	# Clone new submodules in parallel with as many jobs.
	fetchJobs = 0
[...]&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;This was done manually. Until&amp;hellip;today.&lt;/p&gt;
&lt;p&gt;It has just occurred to me&lt;sup id="fnref:1"&gt;&lt;a href="https://perrotta.dev/2025/03/using-keep-sorted-to-keep-your-~/.gitconfig-tidy/#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt; I could use
&lt;a href="https://github.com/google/keep-sorted"&gt;keep-sorted&lt;/a&gt; with the headings.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Previously:&lt;/p&gt;
&lt;p&gt;‚Äî &lt;a href="https://perrotta.dev/2024/12/keep-sorted/"&gt;keep-sorted&lt;/a&gt;
‚Äî &lt;a href="https://perrotta.dev/2024/12/pre-commit/"&gt;pre-commit&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;But&amp;hellip;how?!&lt;/p&gt;
&lt;p&gt;The usage to sort, say, aliases, is quite straightforward&lt;sup id="fnref:2"&gt;&lt;a href="https://perrotta.dev/2025/03/using-keep-sorted-to-keep-your-~/.gitconfig-tidy/#fn:2" class="footnote-ref" role="doc-noteref"&gt;2&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;[alias]
	# keep-sorted begin
	bd = !branch=&amp;#34;$(git branch --show-current)&amp;#34; &amp;amp;&amp;amp; git default &amp;amp;&amp;amp; git branch -D &amp;#34;${branch:-$1}&amp;#34;
	blank = desc -m \&amp;#34;blank commit\&amp;#34;
	cm = commit
	co = checkout
	cp = cherry-pick
	dc = diff --cached
	default = !git checkout main &amp;amp;&amp;gt;/dev/null || git checkout master
	desc = commit --allow-empty -n
	emerge = !git add -A . &amp;amp;&amp;amp; git amend -n &amp;amp;&amp;amp; git pushm --force-with-lease
	nb = switch --create
 [...]
	# keep-sorted finish&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;How can you apply the same technique to headings?&lt;/p&gt;
&lt;p&gt;The out-of-the-box utilization is OK-ish, but not great:&lt;/p&gt;
&lt;p&gt;From:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;# keep-sorted begin
[fetch]
	prune = true

[help]
	autocorrect = 10

[format]
	# Automatically sign-off patches when using format-patch.
	signoff = true
# keep-sorted finish&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;To:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;# keep-sorted start

[fetch]
	prune = true
[format]
	# Automatically sign-off patches when using format-patch.
	signoff = true
[help]
	autocorrect = 10
# keep-sorted end&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;(including the blank line at the top)&lt;/p&gt;
&lt;p&gt;It turns out all we have to do is a little bit of tweaking:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;# keep-sorted begin block=yes newline_separated=yes
[fetch]
	prune = true

[help]
	autocorrect = 10

[format]
	# Automatically sign-off patches when using format-patch.
	signoff = true
# keep-sorted finish&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&amp;hellip;which then becomes:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;# keep-sorted begin block=yes newline_separated=yes
[fetch]
	prune = true

[format]
	# Automatically sign-off patches when using format-patch.
	signoff = true

[help]
	autocorrect = 10
# keep-sorted finish&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;How nice!&lt;/p&gt;
&lt;div class="footnotes" role="doc-endnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;Can you even imagine? Having original ideas? In 2025? Without LLMs?! Is
this even real??&amp;#160;&lt;a href="https://perrotta.dev/2025/03/using-keep-sorted-to-keep-your-~/.gitconfig-tidy/#fnref:1" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;I replaced &lt;code&gt;start -&amp;gt; begin&lt;/code&gt; and &lt;code&gt;end -&amp;gt; finish&lt;/code&gt; otherwise &lt;code&gt;keep-sorted&lt;/code&gt;
would sort this blog post itself. If you copy and paste this example,
remember to change the words back to the original ones.&amp;#160;&lt;a href="https://perrotta.dev/2025/03/using-keep-sorted-to-keep-your-~/.gitconfig-tidy/#fnref:2" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: Using keep-sorted to keep your ~/.gitconfig tidy"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/pre-commit/"&gt;#pre-commit&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Create a git commit with multiple contributors</title><link>https://perrotta.dev/2025/03/create-a-git-commit-with-multiple-contributors/</link><pubDate>Mon, 03 Mar 2025 14:55:23 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/03/create-a-git-commit-with-multiple-contributors/</guid><description>&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Step 1&lt;/strong&gt;: Create a commit / pull request as usual.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Step 2&lt;/strong&gt;: Collaborate ü™Ñ. Different people push to the same remote branch.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Step 3&lt;/strong&gt;: Once it&amp;rsquo;s done, add as many git footer elements as needed, like in
the following commit message example:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;feat: adopt time machine API

Address one of our main feature requests.

Allow users to go back in time by integrating with gravitational://infty.improbability/

Co-authored-by: Marvin &amp;lt;marv_is_happy@in.space&amp;gt;
Co-authored-by: Zaphod Beeblebrox &amp;lt;zaph@in.space&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Ideally, sort the &lt;code&gt;Co-authored-by&lt;/code&gt; field alphabetically.&lt;/p&gt;
&lt;p&gt;Sources:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://docs.github.com/en/pull-requests/committing-changes-to-your-project/creating-and-editing-commits/creating-a-commit-with-multiple-authors"&gt;https://docs.github.com/en/pull-requests/committing-changes-to-your-project/creating-and-editing-commits/creating-a-commit-with-multiple-authors&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/7442112/how-to-attribute-a-single-commit-to-multiple-developers"&gt;https://stackoverflow.com/questions/7442112/how-to-attribute-a-single-commit-to-multiple-developers&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: Create a git commit with multiple contributors"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: prune gone upstream branches</title><link>https://perrotta.dev/2025/02/git-prune-gone-upstream-branches/</link><pubDate>Thu, 20 Feb 2025 11:43:04 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/02/git-prune-gone-upstream-branches/</guid><description>&lt;p&gt;&lt;strong&gt;Problem statement&lt;/strong&gt;: Delete all local git branches whose upstream counterparts
have already been merged (&amp;ldquo;gone&amp;rdquo; in git lingo).&lt;/p&gt;
&lt;p&gt;Augment your &lt;code&gt;~/.gitconfig&lt;/code&gt;:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;[alias]
	prune-gone = !git fetch -p &amp;amp;&amp;amp; git branch -vv | awk &amp;#39;/: gone]/{print $1}&amp;#39; | xargs -r git branch -D&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Run &lt;code&gt;git prune-gone&lt;/code&gt;. That&amp;rsquo;s it.&lt;/p&gt;
&lt;p&gt;It lists all branches that are &amp;ldquo;gone&amp;rdquo; and deletes them.&lt;/p&gt;
&lt;p&gt;I have another git alias (&lt;code&gt;'world'&lt;/code&gt;) to do all this sort of &lt;em&gt;clean-up&lt;/em&gt; tasks at
once:&lt;/p&gt;
&lt;div class="codeblock" data-lang="ini"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;ini&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-ini"&gt;[alias]
 world = !git fetch --all &amp;amp;&amp;amp; git remote prune origin &amp;amp;&amp;amp; git prune-gone&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: prune gone upstream branches"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>git: blank commit</title><link>https://perrotta.dev/2025/02/git-blank-commit/</link><pubDate>Fri, 14 Feb 2025 13:50:36 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><guid>https://perrotta.dev/2025/02/git-blank-commit/</guid><description>&lt;h2 id="how-can-we-create-an-empty-commit-in-git"&gt;How can we create an empty commit in &lt;code&gt;git&lt;/code&gt;?&lt;/h2&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;mkdir repo
cd repo
git init
git commit --allow-empty -n -m &amp;#34;blank commit&amp;#34;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% git log
commit effe4480543051e13838d4fbc127f01f658c07dc (HEAD -&amp;gt; master)
Author: Thiago Perrotta &amp;lt;{redacted-email}&amp;gt;
Date: Fri Feb 14 13:52:19 2025 &amp;#43;0100

 blank commit&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h2 id="why-is-this-useful"&gt;Why is this useful?&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href="https://docs.github.com/en/code-security/getting-started/dependabot-quickstart-guide"&gt;dependabot&lt;/a&gt;
&lt;a href="https://jongleberry.medium.com/accessing-github-actions-secrets-for-dependabot-pull-requests-on-private-repositories-b0dd6995f21b"&gt;cannot&lt;/a&gt;
access secrets in github actions. There&amp;rsquo;s one workaround: check out the pull
request locally, add a blank commit on top of it, then push it back. &lt;em&gt;Boom&lt;/em&gt;.
The secrets are suddenly accessible.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;create a commit &lt;em&gt;in advance&lt;/em&gt; of coding it, √† la
&lt;a href="https://en.wikipedia.org/wiki/Test-driven_development"&gt;TDD&lt;/a&gt;. Declaring your
intent first can help with focus and scope. You can always update the commit
message afterwards with &lt;code&gt;git commit --amend&lt;/code&gt;&lt;sup id="fnref:1"&gt;&lt;a href="https://perrotta.dev/2025/02/git-blank-commit/#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;2.1) create a pull request (merge request) &lt;em&gt;in advance&lt;/em&gt; of coding it. So that
you can have a PR number that can be shared with your teammates and/or linked to
from your bug tracker software.&lt;/p&gt;
&lt;h2 id="my-aliases"&gt;My aliases&lt;/h2&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;% grep -E &amp;#39;(alias|blank|desc)&amp;#39; ~/.gitconfig
[alias]
 blank = desc -m \&amp;#34;blank commit\&amp;#34;
 desc = commit --allow-empty -n&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="footnotes" role="doc-endnotes"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;Which I alias to &lt;code&gt;git reword&lt;/code&gt;.&amp;#160;&lt;a href="https://perrotta.dev/2025/02/git-blank-commit/#fnref:1" class="footnote-backref" role="doc-backlink"&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: git: blank commit"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt;&lt;/p&gt;</description></item><item><title>‚òÖ GitHub Distributed CODEOWNERS</title><link>https://perrotta.dev/2025/02/github-distributed-codeowners/</link><pubDate>Wed, 12 Feb 2025 13:57:29 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>bestof</category><category>dev</category><category>git</category><category>pre-commit</category><guid>https://perrotta.dev/2025/02/github-distributed-codeowners/</guid><description>&lt;p&gt;We recently adopted Andrew Ring&amp;rsquo;s &amp;ldquo;Distributed CODEOWNERS&amp;rdquo;
(&lt;a href="https://github.com/andrewring/github-distributed-owners"&gt;github&lt;/a&gt;) in some
parts of our codebase.&lt;/p&gt;
&lt;p&gt;You know the concept of
&lt;a href="https://chromium.googlesource.com/chromium/src/&amp;#43;/HEAD/docs/code_reviews.md"&gt;&lt;code&gt;OWNERS&lt;/code&gt;&lt;/a&gt;
if you&amp;rsquo;ve worked at Google, or in the Chromium codebase. As far as I know, they
were the pioneers of this concept.&lt;/p&gt;
&lt;p&gt;Outside Google, GitHub has popularized it with
&lt;a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/about-code-owners"&gt;CODEOWNERS&lt;/a&gt;.
It&amp;rsquo;s pretty much the same concept, it&amp;rsquo;s just implemented differently.&lt;/p&gt;
&lt;h2 id="google"&gt;Google&lt;/h2&gt;
&lt;p&gt;You have distributed &lt;code&gt;OWNERS&lt;/code&gt; files throughout the whole repository. For
example:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;java/
 OWNERS (a)
 project1/
 OWNERS (b)
 project2/
 OWNERS (c)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code&gt;OWNERS&lt;/code&gt; in (b) have CL (ChangeList) / PR (Pull Request) approval permissions
for &lt;code&gt;java/project1&lt;/code&gt;, but not for &lt;code&gt;java/project2&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;OWNERS&lt;/code&gt; in (a) have approval permissions for both projects.&lt;/p&gt;
&lt;h2 id="github"&gt;GitHub&lt;/h2&gt;
&lt;p&gt;There&amp;rsquo;s a single &lt;code&gt;.github/CODEOWNERS&lt;/code&gt; file that controls the whole repository:&lt;/p&gt;
&lt;div class="codeblock"&gt;
 &lt;pre&gt;&lt;code class="language-plaintext"&gt;* a
/java/project1 b
/java/project2 c&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h2 id="distributed-codeowners"&gt;Distributed CODEOWNERS&lt;/h2&gt;
&lt;p&gt;What if we wanted to adopt the Google approach in GitHub? Use Andrew&amp;rsquo;s tool!&lt;/p&gt;
&lt;p&gt;What does it do? It collects all scattered &lt;code&gt;OWNERS&lt;/code&gt; in the repository and
consolidates them in a single &lt;code&gt;.github/CODEOWNERS&lt;/code&gt; file, expected by GitHub.
Win-win!&lt;/p&gt;
&lt;p&gt;I like to adopt it with a &lt;a href="https://pre-commit.com"&gt;pre-commit&lt;/a&gt; hook:&lt;/p&gt;
&lt;div class="codeblock" data-lang="yaml"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;yaml&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-yaml"&gt;repos:
 - repo: https://github.com/andrewring/github-distributed-owners
 rev: v0.1.9
 hooks:
 - id: github-distributed-owners
 files: .*/OWNERS$|^\.github/CODEOWNERS$&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Then it gets automatically managed via CI and/or local commits. It can also be
triggered manually with:&lt;/p&gt;
&lt;div class="codeblock" data-lang="shell"&gt;
 &lt;div class="codeblock-header"&gt;
 &lt;span class="codeblock-language"&gt;shell&lt;/span&gt;
 &lt;/div&gt;
 &lt;pre&gt;&lt;code class="language-bash"&gt;pre-commit run -a github-distributed-codeowners&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: GitHub Distributed CODEOWNERS"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/bestof/"&gt;#bestof&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/pre-commit/"&gt;#pre-commit&lt;/a&gt;&lt;/p&gt;</description></item><item><title>.gitkeep</title><link>https://perrotta.dev/2025/01/.gitkeep/</link><pubDate>Sat, 11 Jan 2025 00:43:44 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><category>dev</category><category>git</category><category>meta</category><guid>https://perrotta.dev/2025/01/.gitkeep/</guid><description>&lt;p&gt;I&amp;rsquo;m not sure if this is well-known, so here&amp;rsquo;s a short anecdotal blog post:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;git&lt;/code&gt; cannot track empty directories.&lt;/p&gt;
&lt;p&gt;I wanted to add a &lt;code&gt;drafts/&lt;/code&gt; folder to my blog repository, alongside a
&lt;code&gt;.gitignore&lt;/code&gt; containing &lt;code&gt;drafts/*.md&lt;/code&gt; so that my staging posts wouldn&amp;rsquo;t be
accidentally checked into version control.&lt;/p&gt;
&lt;p&gt;If &lt;code&gt;drafts/&lt;/code&gt; is supposed to be empty, then how can I check it into version
control?&lt;/p&gt;
&lt;p&gt;The &lt;a href="https://stackoverflow.com/a/7229996/1745064"&gt;answer&lt;/a&gt; is to create a dummy
&lt;code&gt;.gitkeep&lt;/code&gt; file inside it with &lt;code&gt;touch drafts/.gitkeep&lt;/code&gt;. This way I can
&lt;a href="https://github.com/thiagowfx/thiagowfx.github.io/tree/master/drafts"&gt;push&lt;/a&gt; the
&lt;code&gt;drafts/&lt;/code&gt; directory to VCS. And it will remain empty (of markdown files)!&lt;/p&gt;
&lt;p&gt;‚Äî ¬ß ‚Äî&lt;/p&gt;&lt;p&gt;Reply via &lt;a href="mailto:serendipity@perrotta.dev?subject=Reply to: .gitkeep"&gt;email&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://perrotta.dev/tags/dev/"&gt;#dev&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/git/"&gt;#git&lt;/a&gt; &lt;a href="https://perrotta.dev/tags/meta/"&gt;#meta&lt;/a&gt;&lt;/p&gt;</description></item></channel></rss>
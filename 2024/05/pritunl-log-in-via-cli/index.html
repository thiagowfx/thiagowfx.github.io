<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Pritunl log in via CLI | not just serendipity</title>
<meta name=title content="Pritunl log in via CLI"><meta name=description content="Pritunl is an Enterprise Distributed OpenVPN server.
In order to run its client on macOS, an .app is provided. However, using it to
log in every day is quite tedious.
Let&rsquo;s automate it so that we can connect to the VPN with a single command.
In order to fetch the credentials in this example in a secure manner, we&rsquo;ll be
using 1password. pass would have worked just
as fine.
First, configure Pritunl via its app UI, creating a profile for your corp
credentials."><meta name=keywords content="dev,macos,"><meta property="og:url" content="https://perrotta.dev/2024/05/pritunl-log-in-via-cli/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="Pritunl log in via CLI"><meta property="og:description" content="Pritunl is an Enterprise Distributed OpenVPN server.
In order to run its client on macOS, an .app is provided. However, using it to log in every day is quite tedious.
Let’s automate it so that we can connect to the VPN with a single command.
In order to fetch the credentials in this example in a secure manner, we’ll be using 1password. pass would have worked just as fine.
First, configure Pritunl via its app UI, creating a profile for your corp credentials."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-07T16:03:27+02:00"><meta property="article:modified_time" content="2024-05-07T16:03:27+02:00"><meta property="article:tag" content="Dev"><meta property="article:tag" content="Macos"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pritunl log in via CLI"><meta name=twitter:description content="Pritunl is an Enterprise Distributed OpenVPN server.
In order to run its client on macOS, an .app is provided. However, using it to log in every day is quite tedious.
Let’s automate it so that we can connect to the VPN with a single command.
In order to fetch the credentials in this example in a secure manner, we’ll be using 1password. pass would have worked just as fine.
First, configure Pritunl via its app UI, creating a profile for your corp credentials."><meta itemprop=name content="Pritunl log in via CLI"><meta itemprop=description content="Pritunl is an Enterprise Distributed OpenVPN server.
In order to run its client on macOS, an .app is provided. However, using it to log in every day is quite tedious.
Let’s automate it so that we can connect to the VPN with a single command.
In order to fetch the credentials in this example in a secure manner, we’ll be using 1password. pass would have worked just as fine.
First, configure Pritunl via its app UI, creating a profile for your corp credentials."><meta itemprop=datePublished content="2024-05-07T16:03:27+02:00"><meta itemprop=dateModified content="2024-05-07T16:03:27+02:00"><meta itemprop=wordCount content="264"><meta itemprop=keywords content="Dev,Macos"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/><style>body{font-family:Crimson Pro,Vollkorn,Alegreya,Iowan Old Style,Apple Garamond,Baskerville,Times New Roman,Noto Serif,Droid Serif,Times,Source Serif Pro,serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:Inter,Fira Sans,Lato,system-ui,-apple-system,BlinkMacSystemFont,Avenir Next,Avenir,Segoe UI,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}footer{font-size:small}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:Fira Code,PT Mono,IBM Plex Mono,Menlo,Consolas,Monaco,Liberation Mono,Ubuntu Mono,Lucida Console,monospace}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1>Pritunl log in via CLI</h1><p><i><time datetime=2024-05-07 pubdate>07 May, 2024
</time>• 264 words</i></p><content><p><a href=https://pritunl.com/>Pritunl</a> is an Enterprise Distributed OpenVPN server.</p><p>In order to run its client on macOS, an <code>.app</code> is provided. However, using it to
log in every day is quite tedious.</p><p>Let&rsquo;s automate it so that we can connect to the VPN with a single command.</p><p>In order to fetch the credentials in this example in a secure manner, we&rsquo;ll be
using 1password. <a href=https://www.passwordstore.org/><code>pass</code></a> would have worked just
as fine.</p><p>First, configure Pritunl via its app UI, creating a profile for your corp
credentials.</p><p>Then figure out what the profile ID you just created is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>profile_id<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>/Applications/Pritunl.app/Contents/Resources/pritunl-client list --json | jq -r <span style=color:#e6db74>&#39;.[0].id&#39;</span><span style=color:#66d9ef>)</span>
</span></span></code></pre></div><p>Now, create an entry in 1Password for your Pritunl credentials associated with
the profile above.</p><p>Let&rsquo;s use the <code>op</code> official CLI tool from 1Password to fetch the password and
the OTP (one-time password) for the &ldquo;Pritunl (VPN)&rdquo; entry (change it
accordingly).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>op_id<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>op item get <span style=color:#e6db74>&#39;Pritunl (VPN)&#39;</span> --format json | jq -r <span style=color:#e6db74>&#39;.id&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>password<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>op read <span style=color:#e6db74>&#34;op://private/</span>$op_id<span style=color:#e6db74>/password&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>otp<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>op item get <span style=color:#e6db74>&#34;</span>$op_id<span style=color:#e6db74>&#34;</span> --totp<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>Now we can use the <code>pritunl-client</code> to log in programmatically:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>pritunl-client start <span style=color:#e6db74>&#34;</span>$profile_id<span style=color:#e6db74>&#34;</span> --password <span style=color:#e6db74>&#34;</span>$password$otp<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>Then verify it has indeed connected:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>pritunl-client list
</span></span></code></pre></div><p>The trick is that it accepts the concatenation of the password with the OTP as
the password. There&rsquo;s not a separate <code>--otp</code> flag.</p><p>Putting everything together, we can create a function for our favorite shell:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Log into corp VPN</span>
</span></span><span style=display:flex><span>pritunl_login<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	local profile_id<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>/Applications/Pritunl.app/Contents/Resources/pritunl-client list --json | jq -r <span style=color:#e6db74>&#39;.[0].id&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	local op_id<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>op item get <span style=color:#e6db74>&#39;Pritunl (VPN)&#39;</span> --format json | jq -r <span style=color:#e6db74>&#39;.id&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>	local password<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>op read <span style=color:#e6db74>&#34;op://private/</span>$op_id<span style=color:#e6db74>/password&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>	local otp<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>op item get <span style=color:#e6db74>&#34;</span>$op_id<span style=color:#e6db74>&#34;</span> --totp<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	pritunl-client start <span style=color:#e6db74>&#34;</span>$profile_id<span style=color:#e6db74>&#34;</span> --password <span style=color:#e6db74>&#34;</span>$password$otp<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>	pritunl-client list
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></content><p><a href=https://perrotta.dev/tags/dev/>#dev</a>
<a href=https://perrotta.dev/tags/macos/>#macos</a></p></main><footer><span>Copyright © 2021 - 2025 <a href=mailto:tbperrotta@gmail.com>Thiago Perrotta</a> · <a href=/index.xml>RSS</a> · a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
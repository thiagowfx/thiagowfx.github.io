<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>prodaccess | not just serendipity</title><meta name=title content="prodaccess">
<meta name=description content="At Google we had a prodaccess command used to log in and authenticate in all
sorts of internal corp systems1 for 20 hours. It became a daily ritual to run
prodaccess first thing in the morning when logging in upon unlocking our
physical workstations2.
During the pandemic, when heavily using our virtual workstations (dubbed
cloudtops, think of an EC2 instance or a VPS) it was common to hook
prodaccess into ssh. There was a prodcertstatus command that would tell
you when prodaccess would expire. A common pattern was to modify your ssh
startup command to automatically run prodaccess whenever prodcertstatus
indicated that access would expire within 2-4 hours, depending on the user&rsquo;s
preference."><meta name=keywords content="dev,bestof★,"><meta property="og:url" content="https://perrotta.dev/2024/10/prodaccess/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="prodaccess"><meta property="og:description" content="At Google we had a prodaccess command used to log in and authenticate in all sorts of internal corp systems1 for 20 hours. It became a daily ritual to run prodaccess first thing in the morning when logging in upon unlocking our physical workstations2.
During the pandemic, when heavily using our virtual workstations (dubbed cloudtops, think of an EC2 instance or a VPS) it was common to hook prodaccess into ssh. There was a prodcertstatus command that would tell you when prodaccess would expire. A common pattern was to modify your ssh startup command to automatically run prodaccess whenever prodcertstatus indicated that access would expire within 2-4 hours, depending on the user’s preference."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-18T14:57:27+02:00"><meta property="article:modified_time" content="2024-10-18T14:57:27+02:00"><meta property="article:tag" content="Dev"><meta property="article:tag" content="Bestof★"><meta name=twitter:card content="summary"><meta name=twitter:title content="prodaccess"><meta name=twitter:description content="At Google we had a prodaccess command used to log in and authenticate in all sorts of internal corp systems1 for 20 hours. It became a daily ritual to run prodaccess first thing in the morning when logging in upon unlocking our physical workstations2.
During the pandemic, when heavily using our virtual workstations (dubbed cloudtops, think of an EC2 instance or a VPS) it was common to hook prodaccess into ssh. There was a prodcertstatus command that would tell you when prodaccess would expire. A common pattern was to modify your ssh startup command to automatically run prodaccess whenever prodcertstatus indicated that access would expire within 2-4 hours, depending on the user’s preference."><meta itemprop=name content="prodaccess"><meta itemprop=description content="At Google we had a prodaccess command used to log in and authenticate in all sorts of internal corp systems1 for 20 hours. It became a daily ritual to run prodaccess first thing in the morning when logging in upon unlocking our physical workstations2.
During the pandemic, when heavily using our virtual workstations (dubbed cloudtops, think of an EC2 instance or a VPS) it was common to hook prodaccess into ssh. There was a prodcertstatus command that would tell you when prodaccess would expire. A common pattern was to modify your ssh startup command to automatically run prodaccess whenever prodcertstatus indicated that access would expire within 2-4 hours, depending on the user’s preference."><meta itemprop=datePublished content="2024-10-18T14:57:27+02:00"><meta itemprop=dateModified content="2024-10-18T14:57:27+02:00"><meta itemprop=wordCount content="359"><meta itemprop=keywords content="Dev,Bestof★"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/><style>body{font-family:crimson pro,vollkorn,alegreya,iowan old style,apple garamond,baskerville,times new roman,noto serif,droid serif,times,source serif pro,serif,apple color emoji,segoe ui emoji,segoe ui symbol,noto color emoji;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:inter,fira sans,lato,system-ui,-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}footer{font-size:small;padding:8px;text-align:center}a{color:#3273dc}.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:fira code,pt mono,ibm plex mono,Menlo,Consolas,Monaco,liberation mono,ubuntu mono,lucida console,monospace}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 110px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1><span>★</span>
prodaccess</h1><p><i><time datetime=2024-10-18 pubdate>18 Oct, 2024
</time>• 359 words
• 2 min</i></p><content><p>At Google we had a <code>prodaccess</code> command used to log in and authenticate in all
sorts of internal corp systems<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> for 20 hours. It became a daily ritual to run
<code>prodaccess</code> first thing in the morning when logging in upon unlocking our
physical workstations<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><p>During the pandemic, when heavily using our virtual workstations (dubbed
<em>cloudtops</em>, think of an EC2 instance or a VPS) it was common to hook
<code>prodaccess</code> into <code>ssh</code>. There was a <code>prodcertstatus</code> command that would tell
you when <code>prodaccess</code> would expire. A common pattern was to modify your <code>ssh</code>
startup command to automatically run <code>prodaccess</code> whenever <code>prodcertstatus</code>
indicated that access would expire within 2-4 hours, depending on the user&rsquo;s
preference.</p><p>Given my trained muscle memory, I wanted to continue to use this alias even in
environments other than Google:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>% cat ~/.profile.d/functions_corp.sh
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>prodaccess<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	echo <span style=color:#e6db74>&#34;--&gt; VPN&#34;</span>
</span></span><span style=display:flex><span>	vpn_login
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	echo <span style=color:#e6db74>&#34;--&gt; Teleport&#34;</span>
</span></span><span style=display:flex><span>	teleport_login
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	echo <span style=color:#e6db74>&#34;--&gt; AWS&#34;</span>
</span></span><span style=display:flex><span>	aws_login
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;--&gt; Azure&#34;</span>
</span></span><span style=display:flex><span>    azure_login
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> in
</span></span><span style=display:flex><span>		-u|--update<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>			echo <span style=color:#e6db74>&#34;--&gt; mr&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#75715e># Update all well-known corp repositories</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>(</span>cd ~/Corp <span style=color:#f92672>&amp;&amp;</span> mr update <span style=color:#f92672>&amp;&amp;</span> mr run git world<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#75715e># Package manager upgrade</span>
</span></span><span style=display:flex><span>			echo <span style=color:#e6db74>&#34;--&gt; sd-world&#34;</span>
</span></span><span style=display:flex><span>			sd-world
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			shift
</span></span><span style=display:flex><span>			;;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		-a|--all<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>			echo <span style=color:#e6db74>&#34;--&gt; Atlas Mongo&#34;</span>
</span></span><span style=display:flex><span>			atlas_login
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			shift
</span></span><span style=display:flex><span>			;;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>esac</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Notes:</p><ul><li><code>mr</code> is <a href=https://myrepos.branchable.com/>https://myrepos.branchable.com/</a> (&ldquo;a tool to manage all your version
control repositories&rdquo;)<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></li><li><code>sd-world</code> was introduced in a <a href=https://perrotta.dev/2024/01/sd-world-perform-a-full-system-upgrade/>previous post</a>: it performs a full system upgrade</li><li><code>--all</code> holds services I only need / use from time to time.</li><li><code>shift</code> is not really needed, but IMHO it&rsquo;s a good practice (and another
ingrained habit of mine), especially when inside <code>for</code> loops</li><li><code>git world</code> is an alias in my <code>~/.gitconfig</code> that runs <code>git fetch --all && git remote prune origin</code></li></ul><p>Every morning I invoke <code>prodaccess -u</code> when starting my work day. A few password
prompts and touch IDs later and I do not need to worry about logging in anymore
during the middle of the day, which reduces overall context switching and
stress.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Until someone in CorpEng decided it was a good idea to
<a href=https://killedbygoogle.com/>deprecate</a> it in favour of a new <code>gcert</code>
command, destroying many SWE-years of developed muscle memory.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Ah, the <em>good ol&rsquo; times</em>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>I should write a post about it sometime.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></content><p><a href=https://perrotta.dev/tags/dev/>#dev</a>
<a href=https://perrotta.dev/tags/bestof/>#bestof★</a></p></main><hr><footer><span>© 2021 - 2025
<a href=mailto:tbperrotta@gmail.com>Thiago Perrotta
</a>·
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ·
<a href=/index.xml>RSS</a> ·
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
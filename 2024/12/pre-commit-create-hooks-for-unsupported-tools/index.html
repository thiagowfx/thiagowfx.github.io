<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>pre-commit: create hooks for unsupported tools | not just serendipity</title><meta name=title content="pre-commit: create hooks for unsupported tools">
<meta name=description content="When using pre-commit.com, in an ideal world, every
formatter / linter / code analyzer would have a .pre-commit-config.yaml file
in its repository root.
In the real world, that&rsquo;s not always the case.
A recent example: cloudflare/pint:

Prometheus rule linter/validator

It is a golang binary that lints prometheus rules.
Can we bridge the gap?
The end goal is the ability to run pre-commit run --all-files pint in our git
repository.
For that, we&rsquo;ll need to define a local / custom hook in our
~/.pre-commit-config.yaml:"><meta name=keywords content="bestof★,dev,"><meta property="og:url" content="https://perrotta.dev/2024/12/pre-commit-create-hooks-for-unsupported-tools/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="pre-commit: create hooks for unsupported tools"><meta property="og:description" content="When using pre-commit.com, in an ideal world, every formatter / linter / code analyzer would have a .pre-commit-config.yaml file in its repository root.
In the real world, that’s not always the case.
A recent example: cloudflare/pint:
Prometheus rule linter/validator
It is a golang binary that lints prometheus rules.
Can we bridge the gap?
The end goal is the ability to run pre-commit run --all-files pint in our git repository.
For that, we’ll need to define a local / custom hook in our ~/.pre-commit-config.yaml:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-17T22:46:41-03:00"><meta property="article:modified_time" content="2024-12-17T22:46:41-03:00"><meta property="article:tag" content="Bestof★"><meta property="article:tag" content="Dev"><meta name=twitter:card content="summary"><meta name=twitter:title content="pre-commit: create hooks for unsupported tools"><meta name=twitter:description content="When using pre-commit.com, in an ideal world, every formatter / linter / code analyzer would have a .pre-commit-config.yaml file in its repository root.
In the real world, that’s not always the case.
A recent example: cloudflare/pint:
Prometheus rule linter/validator
It is a golang binary that lints prometheus rules.
Can we bridge the gap?
The end goal is the ability to run pre-commit run --all-files pint in our git repository.
For that, we’ll need to define a local / custom hook in our ~/.pre-commit-config.yaml:"><meta itemprop=name content="pre-commit: create hooks for unsupported tools"><meta itemprop=description content="When using pre-commit.com, in an ideal world, every formatter / linter / code analyzer would have a .pre-commit-config.yaml file in its repository root.
In the real world, that’s not always the case.
A recent example: cloudflare/pint:
Prometheus rule linter/validator
It is a golang binary that lints prometheus rules.
Can we bridge the gap?
The end goal is the ability to run pre-commit run --all-files pint in our git repository.
For that, we’ll need to define a local / custom hook in our ~/.pre-commit-config.yaml:"><meta itemprop=datePublished content="2024-12-17T22:46:41-03:00"><meta itemprop=dateModified content="2024-12-17T22:46:41-03:00"><meta itemprop=wordCount content="184"><meta itemprop=keywords content="Bestof★,Dev"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/><style>:root{--color-gray:#888;--font-title:'Inter', 'Fira Sans', 'Lato', system-ui, -apple-system, BlinkMacSystemFont, 'Avenir Next', 'Avenir', 'Segoe UI', 'Helvetica Neue', Helvetica, Ubuntu, Roboto, Noto, Cantarell, Arial, sans-serif;--font-body:'Crimson Pro', 'Vollkorn', 'Alegreya', 'Iowan Old Style', 'Apple Garamond', 'Baskerville', 'Times New Roman', 'Noto Serif', 'Droid Serif', 'Times', 'Source Serif Pro', serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';--font-code:'Fira Code', 'PT Mono', 'IBM Plex Mono', Menlo, Consolas, Monaco, 'Liberation Mono', 'Ubuntu Mono', 'Lucida Console', monospace}body{font-family:var(--font-body);margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:var(--font-title)}footer{font-size:small;padding:8px;text-align:center}a{color:#3273dc}a.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:var(--font-code)}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 110px}ul.blog-posts li a:visited{color:#8b6fcb}time.pubdate{color:var(--color-gray)}sup.gray{color:var(--color-gray)}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1><span>★</span>
pre-commit: create hooks for unsupported tools</h1><p><i><time datetime=2024-12-17 pubdate>17 Dec, 2024
</time>• 184 words
• 1 min</i></p><content><p>When using <a href=https://pre-commit.com/>pre-commit.com</a>, in an ideal world, every
formatter / linter / code analyzer would have a <code>.pre-commit-config.yaml</code> file
in its repository root.</p><p>In the real world, that&rsquo;s not always the case.</p><p>A recent example: <a href=https://github.com/cloudflare/pint>cloudflare/pint</a>:</p><blockquote><p>Prometheus rule linter/validator</p></blockquote><p>It is a golang binary that lints <a href=https://prometheus.io/>prometheus</a> rules.</p><p>Can we bridge the gap?</p><p>The end goal is the ability to run <code>pre-commit run --all-files pint</code> in our git
repository.</p><p>For that, we&rsquo;ll need to define a local / custom hook in our
<code>~/.pre-commit-config.yaml</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>repos</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>repo</span>: <span style=color:#ae81ff>local</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>hooks</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>pint</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Validate prometheus rules with pint</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>language</span>: <span style=color:#ae81ff>golang</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>additional_dependencies</span>:
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>github.com/cloudflare/pint/cmd/pint@v0.69.1</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>entry</span>: <span style=color:#ae81ff>pint --offline lint</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>types</span>:
</span></span><span style=display:flex><span>          - <span style=color:#ae81ff>yaml</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>files</span>: <span style=color:#ae81ff>^helm/clustermon-alerts/rules/</span>
</span></span></code></pre></div><p>That simply works™. How did I get there? Starting with the references:</p><ol><li><a href=https://adamj.eu/tech/2023/02/09/pre-commit-hooks-unsupported-tools/>https://adamj.eu/tech/2023/02/09/pre-commit-hooks-unsupported-tools/</a></li><li><a href=https://perrotta.dev/2024/11/pre-commit-additional-dependencies-in-golang/>https://perrotta.dev/2024/11/pre-commit-additional-dependencies-in-golang/</a></li><li><a href=https://stackoverflow.com/questions/62974985/go-module-latest-found-but-does-not-contain-package>https://stackoverflow.com/questions/62974985/go-module-latest-found-but-does-not-contain-package</a></li><li><a href=https://pkg.go.dev/github.com/cloudflare/pint@v0.69.1/cmd/pint>https://pkg.go.dev/github.com/cloudflare/pint@v0.69.1/cmd/pint</a></li></ol><p>The key part is <code>language: golang</code> + <code>additional_dependencies</code>.</p><p>Specifying <code>additional_dependencies</code> is a bit tricky. Initially, I did:</p><pre tabindex=0><code>github.com/cloudflare/pint@v0.69.1
</code></pre><p>&mldr;but that yields nothing. In fact:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>% go run github.com/cloudflare/pint@v0.69.1
</span></span><span style=display:flex><span>go: github.com/cloudflare/pint@v0.69.1: module github.com/cloudflare/pint@v0.69.1 found, but does not contain package github.com/cloudflare/pint
</span></span></code></pre></div><p>We must always specify the module that contains the <code>main</code> function with <code>go run</code>, and that is <code>cmd/pint</code>.</p></content><p><a href=https://perrotta.dev/tags/bestof/>#bestof★</a>
<a href=https://perrotta.dev/tags/dev/>#dev</a></p></main><hr><footer><span>© 2021 - 2025
<a href=mailto:notjustserendipity@perrotta.dev>Thiago Perrotta
</a>·
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ·
<a href=/index.xml>RSS</a> ·
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
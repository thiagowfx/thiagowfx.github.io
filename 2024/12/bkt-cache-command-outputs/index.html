<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>bkt: cache command outputs | not just serendipity</title><meta name=title content="bkt: cache command outputs">
<meta name=description content="My esteemed friend Michael Diamond wrote bkt1:

bkt (pronounced &ldquo;bucket&rdquo;) is a subprocess caching utility written in Rust.

I mentioned it previously as an example on how to create a PKGBUILD for Arch Linux.
Here is the main use case for me:
Assume you have a command that is expensive to run.
The command is intended to display information / output about some resources.
Even though it&rsquo;s expensive, its output rarely changes.
So that&mldr;caching it would be quite beneficial."><meta name=keywords content="bestof,dev,"><meta property="og:url" content="https://perrotta.dev/2024/12/bkt-cache-command-outputs/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="bkt: cache command outputs"><meta property="og:description" content="My esteemed friend Michael Diamond wrote bkt1:
bkt (pronounced “bucket”) is a subprocess caching utility written in Rust.
I mentioned it previously as an example on how to create a PKGBUILD for Arch Linux.
Here is the main use case for me:
Assume you have a command that is expensive to run. The command is intended to display information / output about some resources. Even though it’s expensive, its output rarely changes. So that…caching it would be quite beneficial."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-29T19:27:21-03:00"><meta property="article:modified_time" content="2024-12-29T19:27:21-03:00"><meta property="article:tag" content="Bestof"><meta property="article:tag" content="Dev"><meta name=twitter:card content="summary"><meta name=twitter:title content="bkt: cache command outputs"><meta name=twitter:description content="My esteemed friend Michael Diamond wrote bkt1:
bkt (pronounced “bucket”) is a subprocess caching utility written in Rust.
I mentioned it previously as an example on how to create a PKGBUILD for Arch Linux.
Here is the main use case for me:
Assume you have a command that is expensive to run. The command is intended to display information / output about some resources. Even though it’s expensive, its output rarely changes. So that…caching it would be quite beneficial."><meta itemprop=name content="bkt: cache command outputs"><meta itemprop=description content="My esteemed friend Michael Diamond wrote bkt1:
bkt (pronounced “bucket”) is a subprocess caching utility written in Rust.
I mentioned it previously as an example on how to create a PKGBUILD for Arch Linux.
Here is the main use case for me:
Assume you have a command that is expensive to run. The command is intended to display information / output about some resources. Even though it’s expensive, its output rarely changes. So that…caching it would be quite beneficial."><meta itemprop=datePublished content="2024-12-29T19:27:21-03:00"><meta itemprop=dateModified content="2024-12-29T19:27:21-03:00"><meta itemprop=wordCount content="265"><meta itemprop=keywords content="Bestof,Dev"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/2024/12/bkt-cache-command-outputs/><style>:root{--color-gray:#888;--color-grayer:#666;--font-title:'Inter', 'Fira Sans', 'Lato', system-ui, -apple-system, BlinkMacSystemFont, 'Avenir Next', 'Avenir', 'Segoe UI', 'Helvetica Neue', Helvetica, Ubuntu, Roboto, Noto, Cantarell, Arial, sans-serif;--font-body:'Crimson Pro', 'Vollkorn', 'Alegreya', 'Iowan Old Style', 'Apple Garamond', 'Baskerville', 'Times New Roman', 'Noto Serif', 'Droid Serif', 'Times', 'Source Serif Pro', serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';--font-code:'Fira Code', 'PT Mono', 'IBM Plex Mono', Menlo, Consolas, Monaco, 'Liberation Mono', 'Ubuntu Mono', 'Lucida Console', monospace}body{font-family:var(--font-body);margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:var(--font-title)}footer{font-size:small;padding:8px;text-align:center}a{color:#3273dc}a.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:var(--font-code)}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 110px}ul.blog-posts li a:visited{color:#8b6fcb}.pubdate-list{color:var(--color-gray);font-style:italic}.pubdate-single{color:var(--color-grayer);font-style:italic}sup.gray{color:var(--color-grayer)}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1><span>★</span>
bkt: cache command outputs</h1><p><span class=pubdate-single><time datetime=2024-12-29 pubdate>29 Dec, 2024
</time>• 265 words
• 2 min</span></p><content><p>My esteemed friend <a href=https://github.com/dimo414>Michael Diamond</a> wrote <a href=https://www.bkt.rs/><code>bkt</code></a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><blockquote><p>bkt (pronounced &ldquo;bucket&rdquo;) is a subprocess caching utility written in Rust.</p></blockquote><p>I mentioned it <a href=https://perrotta.dev/2022/01/arch-linux-new-pkgbuild-workflow/>previously</a> as an example on how to create a <code>PKGBUILD</code> for Arch Linux.</p><p>Here is the main use case for me:</p><p>Assume you have a command that is expensive to run.
The command is intended to display information / output about some resources.
Even though it&rsquo;s expensive, its output rarely changes.
So that&mldr;caching it would be quite beneficial.</p><p>For example, a command to list all your cluster nodes alongside some of their properties.
Perhaps you need to run that command multiple times a day<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><p>Enter <code>bkt</code>!</p><p>By creating an alias or a wrapper function in your shell (e.g. by adding it to your shell rc file) that uses <code>bkt</code>, you can make subsequent command runs complete faster, by leveraging its cache.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>active_gardens_pp <span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        bkt --ttl 7d -- <span style=color:#f92672>{</span>list clusters command<span style=color:#f92672>}</span> -o json | jq <span style=color:#e6db74>&#39;.[] | select(.active == true and .partition != &#34;private-cloud&#34; and .partition != &#34;gov-cloud&#34;)&#39;</span> | mlr --ijson --opprint --barred cat
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>The first time I run <code>active_gardens_pp</code>, it takes several seconds to complete.
The second time, it completes almost instantaneously.</p><p>The cache duration can be defined with the <code>--ttl</code> flag. One day or one week or a couple of hours can be sensible defaults, depending on how often you expect the output to change.</p><p>And then I should talk about <a href=https://github.com/johnkerl/miller><code>mlr</code></a> (Miller) another day&mldr;</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>In Rust™. And with a <a href=https://en.wikipedia.org/wiki/Domain_hack>domain hack</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Especially if, like me, you like to often close your tabs to tidy up (whether browser or terminal ones).&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></content><p><a href=https://perrotta.dev/tags/bestof/>#bestof</a>
<a href=https://perrotta.dev/tags/dev/>#dev</a></p></main><hr><footer><span>© 2021 - 2025
<a href=mailto:notjustserendipity@perrotta.dev>Thiago Perrotta
</a>·
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ·
<a href=/index.xml>RSS</a> ·
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
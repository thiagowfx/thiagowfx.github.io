<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Update DNS NS servers from Porkbun to Cloudflare | not just serendipity</title><meta name=title content="Update DNS NS servers from Porkbun to Cloudflare">
<meta name=description content="Porkbun is my registrar of choice. It is quite decent but alas it
does
not
support wildcard or catch-all emails, as per their own docs.
Cloudflare, on the other hand,
does.
Problem statement: How to migrate from Porkbun to Cloudflare?
To be more precise: I&rsquo;d still like to keep Porkbun as my registrar. They are
quite solid and I am very content with them. Cloudflare is also very solid but,
for now, I do not intend to switch my registrar to it."><meta name=keywords content="bestof★,dev,privacy,selfhosted,"><meta property="og:url" content="https://perrotta.dev/2024/12/update-dns-ns-servers-from-porkbun-to-cloudflare/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="Update DNS NS servers from Porkbun to Cloudflare"><meta property="og:description" content="Porkbun is my registrar of choice. It is quite decent but alas it does not support wildcard or catch-all emails, as per their own docs.
Cloudflare, on the other hand, does.
Problem statement: How to migrate from Porkbun to Cloudflare?
To be more precise: I’d still like to keep Porkbun as my registrar. They are quite solid and I am very content with them. Cloudflare is also very solid but, for now, I do not intend to switch my registrar to it."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-27T22:45:45-03:00"><meta property="article:modified_time" content="2024-12-27T22:45:45-03:00"><meta property="article:tag" content="Bestof★"><meta property="article:tag" content="Dev"><meta property="article:tag" content="Privacy"><meta property="article:tag" content="Selfhosted"><meta name=twitter:card content="summary"><meta name=twitter:title content="Update DNS NS servers from Porkbun to Cloudflare"><meta name=twitter:description content="Porkbun is my registrar of choice. It is quite decent but alas it does not support wildcard or catch-all emails, as per their own docs.
Cloudflare, on the other hand, does.
Problem statement: How to migrate from Porkbun to Cloudflare?
To be more precise: I’d still like to keep Porkbun as my registrar. They are quite solid and I am very content with them. Cloudflare is also very solid but, for now, I do not intend to switch my registrar to it."><meta itemprop=name content="Update DNS NS servers from Porkbun to Cloudflare"><meta itemprop=description content="Porkbun is my registrar of choice. It is quite decent but alas it does not support wildcard or catch-all emails, as per their own docs.
Cloudflare, on the other hand, does.
Problem statement: How to migrate from Porkbun to Cloudflare?
To be more precise: I’d still like to keep Porkbun as my registrar. They are quite solid and I am very content with them. Cloudflare is also very solid but, for now, I do not intend to switch my registrar to it."><meta itemprop=datePublished content="2024-12-27T22:45:45-03:00"><meta itemprop=dateModified content="2024-12-27T22:45:45-03:00"><meta itemprop=wordCount content="855"><meta itemprop=keywords content="Bestof★,Dev,Privacy,Selfhosted"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/><style>:root{--color-gray:#888;--font-title:'Inter', 'Fira Sans', 'Lato', system-ui, -apple-system, BlinkMacSystemFont, 'Avenir Next', 'Avenir', 'Segoe UI', 'Helvetica Neue', Helvetica, Ubuntu, Roboto, Noto, Cantarell, Arial, sans-serif;--font-body:'Crimson Pro', 'Vollkorn', 'Alegreya', 'Iowan Old Style', 'Apple Garamond', 'Baskerville', 'Times New Roman', 'Noto Serif', 'Droid Serif', 'Times', 'Source Serif Pro', serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';--font-code:'Fira Code', 'PT Mono', 'IBM Plex Mono', Menlo, Consolas, Monaco, 'Liberation Mono', 'Ubuntu Mono', 'Lucida Console', monospace}body{font-family:var(--font-body);margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:var(--font-title)}footer{font-size:small;padding:8px;text-align:center}a{color:#3273dc}a.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:var(--font-code)}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 110px}ul.blog-posts li a:visited{color:#8b6fcb}time.pubdate{color:var(--color-gray)}sup.gray{color:var(--color-gray)}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1><span>★</span>
Update DNS NS servers from Porkbun to Cloudflare</h1><p><i><time datetime=2024-12-27 pubdate>27 Dec, 2024
</time>• 855 words
• 5 min</i></p><content><p><a href=porkbun.com>Porkbun</a> is my registrar of choice. It is quite decent but alas it
<a href=https://kb.porkbun.com/article/10-how-to-set-up-email-forwarding-service>does
not</a>
support wildcard or catch-all emails, as per their own docs.</p><p>Cloudflare, on the other hand,
<a href=https://community.cloudflare.com/t/creating-an-email-catchall/646357>does</a>.</p><p><strong>Problem statement</strong>: How to migrate from Porkbun to Cloudflare?</p><p>To be more precise: I&rsquo;d still like to keep Porkbun as my registrar. They are
quite solid and I am very content with them. Cloudflare is also very solid but,
for now, I do not intend to switch my registrar to it.</p><p>Therefore the only transfer that should happen is the DNS management (DNS
server), via the authoritative nameservers (NS) setting.</p><p>It turns out both providers have excellent documentation on this process:</p><ul><li><strong>Porkbun</strong>: <a href=https://kb.porkbun.com/article/22-how-to-change-your-nameservers>https://kb.porkbun.com/article/22-how-to-change-your-nameservers</a></li><li><strong>Cloudflare</strong>: <a href=https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/>https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/</a></li></ul><p>Upon creating an account on Cloudflare, I imported my site and its existing DNS
records by using their <a href=https://developers.cloudflare.com/dns/zone-setups/reference/dns-quick-scan/>records quick scan
tool</a>:</p><blockquote><p>Since the DNS records quick scan is based on this predefined list of commonly
used record types and names, and is not tailored to the specific zone you are
adding to Cloudflare, there can be cases where not all records are picked up.</p></blockquote><p>Three DNS records were not automatically detected (two A records and one TXT
record)<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. I just added them manually. I chose to keep the records in Porkbun
intact in case I decide to revert back to them in the future.</p><p>For starters, I chose to <a href=https://developers.cloudflare.com/fundamentals/concepts/how-cloudflare-works/>disable
proxying</a>
via Cloudflare. It&rsquo;s quite interesting though, and it&rsquo;s a setting I would
consider to enable at some point.</p><p>From Porkbun, I had to update my <a href=https://kb.porkbun.com/article/63-how-to-switch-to-porkbuns-nameservers>NS
entries</a><sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> from:</p><pre tabindex=0><code>curitiba.ns.porkbun.com
fortaleza.ns.porkbun.com
maceio.ns.porkbun.com
salvador.ns.porkbun.com
</code></pre><p><a href=https://blog.cloudflare.com/whats-the-story-behind-the-names-of-cloudflares-name-servers/>To</a>:</p><pre tabindex=0><code>anirban.ns.cloudflare.com
celine.ns.cloudflare.com
</code></pre><p>During the transfer, it&rsquo;s
<a href=https://developers.cloudflare.com/dns/dnssec/>important</a> to delete
<a href=https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/#before-you-begin>DNSSEC</a>
records at Porkbun:</p><blockquote><p>If you are onboarding an existing domain to Cloudflare, make sure DNSSEC is
disabled at your registrar (where you purchased your domain name). Otherwise,
your domain will experience connectivity errors when you change your
nameservers.</p></blockquote><p>Then I can keep an eye on
<a href=https://www.whatsmydns.net/#NS/perrotta.dev>WhatsMyDNS</a> to monitor the NS
propagation. It may take up to 48 hours to be fully rolled out.</p><p>Or via CLI:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>% dig perrotta.dev +trace @1.1.1.1 | grep perrotta.dev
</span></span><span style=display:flex><span>; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; perrotta.dev +trace @1.1.1.1
</span></span><span style=display:flex><span>perrotta.dev.		10800	IN	NS	anirban.ns.cloudflare.com.
</span></span><span style=display:flex><span>perrotta.dev.		10800	IN	NS	celine.ns.cloudflare.com.
</span></span><span style=display:flex><span>perrotta.dev.		300	IN	A	185.199.110.153
</span></span><span style=display:flex><span>perrotta.dev.		300	IN	A	185.199.111.153
</span></span><span style=display:flex><span>perrotta.dev.		300	IN	A	185.199.108.153
</span></span><span style=display:flex><span>perrotta.dev.		300	IN	A	185.199.109.153
</span></span></code></pre></div><p>Just a few minutes after the update I could already see some nameservers picking
up the changes:</p><pre tabindex=0><code>Paris, France
France Telecom
id 22228
opcode QUERY
rcode NOERROR
flags QR RD RA
;QUESTION
perrotta.dev. IN NS
;ANSWER
perrotta.dev. 10800 IN NS anirban.ns.cloudflare.com.
perrotta.dev. 10800 IN NS celine.ns.cloudflare.com.
;AUTHORITY
;ADDITIONAL
</code></pre><pre tabindex=0><code>Seoul, South Korea
KT
id 14115
opcode QUERY
rcode NOERROR
flags QR RD RA
;QUESTION
perrotta.dev. IN NS
;ANSWER
perrotta.dev. 10800 IN NS anirban.ns.cloudflare.com.
perrotta.dev. 10800 IN NS celine.ns.cloudflare.com.
;AUTHORITY
;ADDITIONAL
anirban.ns.cloudflare.com. 50728 IN A 108.162.193.64
anirban.ns.cloudflare.com. 50728 IN A 172.64.33.64
anirban.ns.cloudflare.com. 50728 IN A 173.245.59.64
anirban.ns.cloudflare.com. 50728 IN AAAA 2606:4700:58::adf5:3b40
anirban.ns.cloudflare.com. 50728 IN AAAA 2803:f800:50::6ca2:c140
anirban.ns.cloudflare.com. 50728 IN AAAA 2a06:98c1:50::ac40:2140
celine.ns.cloudflare.com. 137333 IN A 108.162.194.98
celine.ns.cloudflare.com. 137333 IN A 162.159.38.98
celine.ns.cloudflare.com. 137333 IN A 172.64.34.98
celine.ns.cloudflare.com. 702 IN AAAA 2606:4700:50::a29f:2662
celine.ns.cloudflare.com. 702 IN AAAA 2803:f800:50::6ca2:c262
celine.ns.cloudflare.com. 702 IN AAAA 2a06:98c1:50::ac40:2262
</code></pre><p>Once the transfer is done, go to your Cloudflare dashboard. You should see the
following message:</p><blockquote><p>Great news! Cloudflare is now protecting your site</p></blockquote><p>I also got an email from Cloudflare confirming it:</p><blockquote><p>perrotta.dev is now active on a Cloudflare Free plan</p></blockquote><p>Now it&rsquo;s time to <a href=https://developers.cloudflare.com/dns/dnssec/>re-enable
DNSSEC</a>. Porkbun instructions are
<a href=https://kb.porkbun.com/article/93-how-to-install-dnssec>here</a>: do not fill out
<strong>keyData</strong>. It&rsquo;s possible to verify it was properly configured via <a href=https://dnssec-analyzer.verisignlabs.com/perrotta.dev>DNSSEC
Analyzer</a> by VeriSign
Labs, wherein all checkboxes should be green. Furthermore, from Cloudflare,
verify that <code>DNS > Settings > DNSSEC</code> is properly configured.</p><p>If you choose to <a href=https://developers.cloudflare.com/cloudflare-one/policies/gateway/proxy/>proxy your traffic through
Cloudflare</a>,
you can verify whether it&rsquo;s hiding your origin IP address with <a href=https://ping.eu>https://ping.eu</a>.
Or, alternatively, <code>ping &lt;hostname></code> from the terminal. Beware of DNS caching.
It seems a no-brainer and sensible idea to enable it for your VPS instances<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>. I
would not enable it for <a href=https://community.cloudflare.com/t/github-pages-require-disabling-cfs-http-proxy/147401/21>Github
Pages</a>
though.</p><p>Up to this point everything was a no-op in terms of feature parity. The optional
Cloudflare goodies (e.g. proxying, blocking AI bots, caching, etc.) are just
cherries on top.</p><p>The most exciting part comes now: configuring email and MX records to use
Cloudflare&rsquo;s, with the final goal of supporting catch-all / wildcard emails.</p><h2 id=email>Email</h2><p>Follow the steps at
<a href=https://developers.cloudflare.com/dns/manage-dns-records/how-to/email-records/>https://developers.cloudflare.com/dns/manage-dns-records/how-to/email-records/</a>
to configure MX, SPF and DMARC. It&rsquo;s mostly a point-and-click process.
Cloudflare makes it easy and boring™.</p><p>Once the MX record is configured, verify it&rsquo;s working via <a href=https://www.whatsmydns.net/#MX/perrotta.dev>WhatsMyDNS</a>.</p><p>Verify DMARC is working via <a href="https://mxtoolbox.com/SuperTool.aspx?action=dmarc%3aperrotta.dev&amp;run=toolpage">MX
Toolbox</a>.</p><p>Then create custom routing rules. If desired, add a catch-all rule.</p><p>Once it is working test it by sending an email to yourself. And we&rsquo;re done!</p><p>More references on DKIM and DMARC:</p><ul><li><strong>Porkbun</strong>: <a href=https://kb.porkbun.com/article/179-how-to-turn-on-dkim-dmarc>https://kb.porkbun.com/article/179-how-to-turn-on-dkim-dmarc</a> (for
comparison only)</li><li><strong>Cloudflare</strong>: <a href=https://www.cloudflare.com/en-ca/learning/email-security/dmarc-dkim-spf/>https://www.cloudflare.com/en-ca/learning/email-security/dmarc-dkim-spf/</a></li></ul><h2 id=references>References</h2><ul><li><a href=https://developers.cloudflare.com/learning-paths/get-started-free/>https://developers.cloudflare.com/learning-paths/get-started-free/</a></li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>The A records were subdomains of my domain, and the TXT record was the
github pages site / domain verification.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://www.reddit.com/r/PorkBun/comments/170d6ve/unimportant_nameserver_naming_question/>Fun
fact</a>:
The nameservers are named after Brazilian cities: &ldquo;our CTO is a big fan of
Brazil&rdquo;. Huh.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>However it didn&rsquo;t work for my instances out-of-the-box. That&rsquo;s a problem
for another day: <code>ERR_TOO_MANY_REDIRECTS</code>.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></content><p><a href=https://perrotta.dev/tags/bestof/>#bestof★</a>
<a href=https://perrotta.dev/tags/dev/>#dev</a>
<a href=https://perrotta.dev/tags/privacy/>#privacy</a>
<a href=https://perrotta.dev/tags/selfhosted/>#selfhosted</a></p></main><hr><footer><span>© 2021 - 2025
<a href=mailto:notjustserendipity@perrotta.dev>Thiago Perrotta
</a>·
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ·
<a href=/index.xml>RSS</a> ·
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
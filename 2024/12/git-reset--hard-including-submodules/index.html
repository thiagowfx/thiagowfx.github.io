<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>git reset --hard including submodules | not just serendipity</title><meta name=title content="git reset --hard including submodules">
<meta name=description content='Problem statement: Whenever I open Rancher
Desktop it insists on modifying my shell rc files.
Make it stop!
bash:
# diff --git bash/.bash_profile bash/.bash_profile
index c3962b2..89f475b 100644
--- bash/.bash_profile
+++ bash/.bash_profile
@@ -7,3 +7,7 @@
 #
 # The following line sources .bashrc and is recommended by http://mywiki.wooledge.org/DotFiles
 [ -r ~/.bashrc ] && . ~/.bashrc
+
+### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT)
+export PATH="/Users/thiago.perrotta/.rd/bin:$PATH"
+### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT)
diff --git bash/.bashrc bash/.bashrc
index 7074bca..9ca8ffa 100644
--- bash/.bashrc
+++ bash/.bashrc
@@ -61,3 +61,7 @@ src_files "/etc/bash_completion"
 # Load user scripts and functions if existing. Order is important.
 # Corp config is handled as part of .bashrc.d.
 src_files "$HOME/.profile.d" "$HOME/.bashrc.d"
+
+### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT)
+export PATH="/Users/thiago.perrotta/.rd/bin:$PATH"
+### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT)
zsh:'><meta name=keywords content="dev,"><meta property="og:url" content="https://perrotta.dev/2024/12/git-reset--hard-including-submodules/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="git reset --hard including submodules"><meta property="og:description" content='Problem statement: Whenever I open Rancher Desktop it insists on modifying my shell rc files. Make it stop!
bash:
# diff --git bash/.bash_profile bash/.bash_profile index c3962b2..89f475b 100644 --- bash/.bash_profile +++ bash/.bash_profile @@ -7,3 +7,7 @@ # # The following line sources .bashrc and is recommended by http://mywiki.wooledge.org/DotFiles [ -r ~/.bashrc ] && . ~/.bashrc + +### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT) +export PATH="/Users/thiago.perrotta/.rd/bin:$PATH" +### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT) diff --git bash/.bashrc bash/.bashrc index 7074bca..9ca8ffa 100644 --- bash/.bashrc +++ bash/.bashrc @@ -61,3 +61,7 @@ src_files "/etc/bash_completion" # Load user scripts and functions if existing. Order is important. # Corp config is handled as part of .bashrc.d. src_files "$HOME/.profile.d" "$HOME/.bashrc.d" + +### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT) +export PATH="/Users/thiago.perrotta/.rd/bin:$PATH" +### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT) zsh:'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-26T13:04:27-03:00"><meta property="article:modified_time" content="2024-12-26T13:04:27-03:00"><meta property="article:tag" content="Dev"><meta name=twitter:card content="summary"><meta name=twitter:title content="git reset --hard including submodules"><meta name=twitter:description content='Problem statement: Whenever I open Rancher Desktop it insists on modifying my shell rc files. Make it stop!
bash:
# diff --git bash/.bash_profile bash/.bash_profile index c3962b2..89f475b 100644 --- bash/.bash_profile +++ bash/.bash_profile @@ -7,3 +7,7 @@ # # The following line sources .bashrc and is recommended by http://mywiki.wooledge.org/DotFiles [ -r ~/.bashrc ] && . ~/.bashrc + +### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT) +export PATH="/Users/thiago.perrotta/.rd/bin:$PATH" +### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT) diff --git bash/.bashrc bash/.bashrc index 7074bca..9ca8ffa 100644 --- bash/.bashrc +++ bash/.bashrc @@ -61,3 +61,7 @@ src_files "/etc/bash_completion" # Load user scripts and functions if existing. Order is important. # Corp config is handled as part of .bashrc.d. src_files "$HOME/.profile.d" "$HOME/.bashrc.d" + +### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT) +export PATH="/Users/thiago.perrotta/.rd/bin:$PATH" +### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT) zsh:'><meta itemprop=name content="git reset --hard including submodules"><meta itemprop=description content='Problem statement: Whenever I open Rancher Desktop it insists on modifying my shell rc files. Make it stop!
bash:
# diff --git bash/.bash_profile bash/.bash_profile index c3962b2..89f475b 100644 --- bash/.bash_profile +++ bash/.bash_profile @@ -7,3 +7,7 @@ # # The following line sources .bashrc and is recommended by http://mywiki.wooledge.org/DotFiles [ -r ~/.bashrc ] && . ~/.bashrc + +### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT) +export PATH="/Users/thiago.perrotta/.rd/bin:$PATH" +### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT) diff --git bash/.bashrc bash/.bashrc index 7074bca..9ca8ffa 100644 --- bash/.bashrc +++ bash/.bashrc @@ -61,3 +61,7 @@ src_files "/etc/bash_completion" # Load user scripts and functions if existing. Order is important. # Corp config is handled as part of .bashrc.d. src_files "$HOME/.profile.d" "$HOME/.bashrc.d" + +### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT) +export PATH="/Users/thiago.perrotta/.rd/bin:$PATH" +### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT) zsh:'><meta itemprop=datePublished content="2024-12-26T13:04:27-03:00"><meta itemprop=dateModified content="2024-12-26T13:04:27-03:00"><meta itemprop=wordCount content="333"><meta itemprop=keywords content="Dev"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/><style>body{font-family:crimson pro,vollkorn,alegreya,iowan old style,apple garamond,baskerville,times new roman,noto serif,droid serif,times,source serif pro,serif,apple color emoji,segoe ui emoji,segoe ui symbol,noto color emoji;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:inter,fira sans,lato,system-ui,-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}footer{font-size:small;padding:12px;text-align:center}a{color:#3273dc}.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:fira code,pt mono,ibm plex mono,Menlo,Consolas,Monaco,liberation mono,ubuntu mono,lucida console,monospace}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 110px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1>git reset --hard including submodules</h1><p><i><time datetime=2024-12-26 pubdate>26 Dec, 2024
</time>• 333 words
• 2 minutes</i></p><content><p><strong>Problem statement</strong>: Whenever I open <a href=https://rancherdesktop.io/>Rancher
Desktop</a> it insists on modifying my shell rc files.
Make it stop!</p><p>bash:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span># diff --git bash/.bash_profile bash/.bash_profile
</span></span><span style=display:flex><span>index c3962b2..89f475b 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- bash/.bash_profile
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ bash/.bash_profile
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -7,3 +7,7 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> #
</span></span><span style=display:flex><span> # The following line sources .bashrc and is recommended by http://mywiki.wooledge.org/DotFiles
</span></span><span style=display:flex><span> [ -r ~/.bashrc ] &amp;&amp; . ~/.bashrc
</span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+export PATH=&#34;/Users/thiago.perrotta/.rd/bin:$PATH&#34;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>diff --git bash/.bashrc bash/.bashrc
</span></span><span style=display:flex><span>index 7074bca..9ca8ffa 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- bash/.bashrc
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ bash/.bashrc
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -61,3 +61,7 @@ src_files &#34;/etc/bash_completion&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> # Load user scripts and functions if existing. Order is important.
</span></span><span style=display:flex><span> # Corp config is handled as part of .bashrc.d.
</span></span><span style=display:flex><span> src_files &#34;$HOME/.profile.d&#34; &#34;$HOME/.bashrc.d&#34;
</span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+export PATH=&#34;/Users/thiago.perrotta/.rd/bin:$PATH&#34;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT)
</span></span></span></code></pre></div><p>zsh:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git etc/zsh/zshrc etc/zsh/zshrc
</span></span><span style=display:flex><span>index efe5f79..02e0539 100644
</span></span><span style=display:flex><span><span style=color:#f92672>--- etc/zsh/zshrc
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ etc/zsh/zshrc
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -3959,3 +3959,7 @@ unfunction grml_status_feature
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> # Local variables:
</span></span><span style=display:flex><span> # mode: sh
</span></span><span style=display:flex><span> # End:
</span></span><span style=display:flex><span><span style=color:#a6e22e>+
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+### MANAGED BY RANCHER DESKTOP START (DO NOT EDIT)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+export PATH=&#34;/Users/thiago.perrotta/.rd/bin:$PATH&#34;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+### MANAGED BY RANCHER DESKTOP END (DO NOT EDIT)
</span></span></span></code></pre></div><p>You could say it&rsquo;s well-intentioned, but I think it&rsquo;s rude to change the
developer&rsquo;s rc files without telling them so, and without providing an opt-out
mechanism<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><p>Thus I wanted to revert their changes whenever I was done using Rancher Desktop.
This worked:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cd ~/.dotfiles <span style=color:#f92672>&amp;&amp;</span> git reset --hard
</span></span><span style=display:flex><span>cd vendor/grml-etc-core <span style=color:#f92672>&amp;&amp;</span> git reset --hard
</span></span></code></pre></div><p>The second <code>git reset --hard</code> is needed because I employ a submodule for my
<code>zsh</code> config.</p><p>However, after doing this many times in a row, it became tedious. And somehow I
have the urge to improve this workflow&mldr;</p><figure><a href=https://xkcd.com/1205/><img src=https://imgs.xkcd.com/comics/is_it_worth_the_time.png alt="Don't forget the time you spend finding the chart to look up what you save. And the time spent reading this reminder about the time spent. And the time trying to figure out if either of those actually make sense. Remember, every second counts toward your life total, including these right now."></a><figcaption><p>XKCD Courtesy of Randall Munroe</p></figcaption></figure><p>Then I found out it&rsquo;s possible to do it with an one-shot command, via:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>% git reset --hard --recurse-submodules
</span></span></code></pre></div><p>I knew of <code>--recurse-submodules</code> for <code>git clone</code>, but it never occurred to me it
would also exist for <code>git reset</code>.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>I ended up finding an opt-out mechanism, which isn&rsquo;t very intuitive to
self-discover:
<a href=https://github.com/rancher-sandbox/rancher-desktop/issues/7315>rancher-sandbox/rancher-desktop#7315</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></content><p><a href=https://perrotta.dev/tags/dev/>#dev</a></p></main><hr><footer><span>© 2021 - 2025
<a href=mailto:tbperrotta@gmail.com>Thiago Perrotta
</a>·
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ·
<a href=/index.xml>RSS</a> ·
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
<!doctype html><html lang=en-us><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><title>helm: list recent chart upgrades | not just serendipity</title>
<meta name=title content="helm: list recent chart upgrades"><meta name=description content="Problem statement: Given a kubernetes cluster with many helm charts in
different namespaces, how to use helm to query the list of the last recently
&ldquo;touched&rdquo; charts?
By &ldquo;touched&rdquo; we mean either installed (via helm install) or upgraded (via
helm upgrade).
Something like: helm ls --all --sort-by updated. Using kubectl directly
would also be OK."><meta name=keywords content="dev,"><meta property="og:url" content="https://perrotta.dev/2024/09/helm-list-recent-chart-upgrades/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="helm: list recent chart upgrades"><meta property="og:description" content="Problem statement: Given a kubernetes cluster with many helm charts in different namespaces, how to use helm to query the list of the last recently “touched” charts?
By “touched” we mean either installed (via helm install) or upgraded (via helm upgrade).
Something like: helm ls --all --sort-by updated. Using kubectl directly would also be OK."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-24T14:21:20+02:00"><meta property="article:modified_time" content="2024-09-24T14:21:20+02:00"><meta property="article:tag" content="Dev"><meta name=twitter:card content="summary"><meta name=twitter:title content="helm: list recent chart upgrades"><meta name=twitter:description content="Problem statement: Given a kubernetes cluster with many helm charts in different namespaces, how to use helm to query the list of the last recently “touched” charts?
By “touched” we mean either installed (via helm install) or upgraded (via helm upgrade).
Something like: helm ls --all --sort-by updated. Using kubectl directly would also be OK."><meta itemprop=name content="helm: list recent chart upgrades"><meta itemprop=description content="Problem statement: Given a kubernetes cluster with many helm charts in different namespaces, how to use helm to query the list of the last recently “touched” charts?
By “touched” we mean either installed (via helm install) or upgraded (via helm upgrade).
Something like: helm ls --all --sort-by updated. Using kubectl directly would also be OK."><meta itemprop=datePublished content="2024-09-24T14:21:20+02:00"><meta itemprop=dateModified content="2024-09-24T14:21:20+02:00"><meta itemprop=wordCount content="159"><meta itemprop=keywords content="Dev"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px;overflow-x:auto}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png><style>body{font-family:Crimson Pro,Vollkorn,Alegreya,Iowan Old Style,Apple Garamond,Baskerville,Times New Roman,Noto Serif,Droid Serif,Times,Source Serif Pro,serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}h1,h2,h3,h4,h5,h6,footer,nav{font-family:Inter,Fira Sans,Lato,system-ui,-apple-system,BlinkMacSystemFont,Avenir Next,Avenir,Segoe UI,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}code,pre{font-family:Fira Code,PT Mono,IBM Plex Mono,Menlo,Consolas,Monaco,Liberation Mono,Ubuntu Mono,Lucida Console,monospace}</style></head><body><header><a href=/ class=title><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Posts</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1>helm: list recent chart upgrades</h1><p><i><time datetime=2024-09-24 pubdate>24 Sep, 2024</time></i></p><content><p><strong>Problem statement</strong>: Given a kubernetes cluster with many helm charts in
different namespaces, how to use <code>helm</code> to query the list of the last recently
&ldquo;touched&rdquo; charts?</p><p>By &ldquo;touched&rdquo; we mean either installed (via <code>helm install</code>) or upgraded (via
<code>helm upgrade</code>).</p><p>Something like: <code>helm ls --all --sort-by updated</code>. Using <code>kubectl</code> directly
would also be OK.</p><h2 id=solution>Solution</h2><p>The brute force way:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>helm ls --max <span style=color:#ae81ff>99999</span> -A -o json | jq -r <span style=color:#e6db74>&#39;.[] | &#34;\(.updated)\t\(.name)&#34;&#39;</span> | sort | tail | column -t
</span></span></code></pre></div><ul><li><code>-A</code> for all namespaces</li><li><code>--max 99999</code> to &ldquo;disable&rdquo; <a href=https://github.com/helm/helm/issues/3322>paging</a> (there&rsquo;s no better way as of 2024-09-24)</li><li><code>jq</code> to filter out on the &ldquo;updated&rdquo; field</li></ul><p>Note that a sample json entry looks like the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;hoth-cb7f8a327&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;namespace&#34;</span>: <span style=color:#e6db74>&#34;default&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;revision&#34;</span>: <span style=color:#e6db74>&#34;2&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;updated&#34;</span>: <span style=color:#e6db74>&#34;2024-06-14 15:02:16.775174131 +0000 UTC&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;deployed&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;chart&#34;</span>: <span style=color:#e6db74>&#34;hoth-0.1.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;app_version&#34;</span>: <span style=color:#e6db74>&#34;1.0.0&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Sample output of the aforementioned command:</p><pre tabindex=0><code>2024-09-24  10:56:15.655674586  +0000  UTC  geonosis
2024-09-24  10:56:15.731630075  +0000  UTC  coruscant
2024-09-24  11:01:35.156973247  +0000  UTC  endor
2024-09-24  11:02:30.314014351  +0000  UTC  hoth
</code></pre></content><p><a href=https://perrotta.dev/tags/dev/>#dev</a></p></main><footer><span>Copyright © 2021 - 2025 Thiago Perrotta · <a href=/index.xml>RSS</a> · <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>helm: list recent chart upgrades | not just serendipity</title>
<meta name=keywords content="dev"><meta name=description content="Problem statement: Given a kubernetes cluster with many helm charts in
different namespaces, how to use helm to query the list of the last recently
&ldquo;touched&rdquo; charts?
By &ldquo;touched&rdquo; we mean either installed (via helm install) or upgraded (via
helm upgrade).
Something like: helm ls --all --sort-by updated. Using kubectl directly
would also be OK."><meta name=author content="Thiago Perrotta"><link rel=canonical href=https://www.perrotta.dev/2024/09/helm-list-recent-chart-upgrades/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://www.perrotta.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.perrotta.dev/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://www.perrotta.dev/favicon.ico><link rel=apple-touch-icon href=https://www.perrotta.dev/apple-touch-icon.png><link rel=mask-icon href=https://www.perrotta.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.perrotta.dev/2024/09/helm-list-recent-chart-upgrades/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><style>body{font-family:Crimson Pro,Vollkorn,Alegreya,Iowan Old Style,Apple Garamond,Baskerville,Times New Roman,Noto Serif,Droid Serif,Times,Source Serif Pro,serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}h1,h2,h3,h4,h5,h6,footer,nav,.toc,.post-meta{font-family:Inter,Fira Sans,Lato,system-ui,-apple-system,BlinkMacSystemFont,Avenir Next,Avenir,Segoe UI,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}code,pre{font-family:Fira Code,PT Mono,IBM Plex Mono,Menlo,Consolas,Monaco,Liberation Mono,Ubuntu Mono,Lucida Console,monospace}</style><meta property="og:url" content="https://www.perrotta.dev/2024/09/helm-list-recent-chart-upgrades/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="helm: list recent chart upgrades"><meta property="og:description" content="Problem statement: Given a kubernetes cluster with many helm charts in different namespaces, how to use helm to query the list of the last recently “touched” charts?
By “touched” we mean either installed (via helm install) or upgraded (via helm upgrade).
Something like: helm ls --all --sort-by updated. Using kubectl directly would also be OK."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-24T14:21:20+02:00"><meta property="article:modified_time" content="2024-09-24T14:21:20+02:00"><meta property="article:tag" content="Dev"><meta name=twitter:card content="summary"><meta name=twitter:title content="helm: list recent chart upgrades"><meta name=twitter:description content="Problem statement: Given a kubernetes cluster with many helm charts in
different namespaces, how to use helm to query the list of the last recently
&ldquo;touched&rdquo; charts?
By &ldquo;touched&rdquo; we mean either installed (via helm install) or upgraded (via
helm upgrade).
Something like: helm ls --all --sort-by updated. Using kubectl directly
would also be OK."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.perrotta.dev/posts/"},{"@type":"ListItem","position":2,"name":"helm: list recent chart upgrades","item":"https://www.perrotta.dev/2024/09/helm-list-recent-chart-upgrades/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"helm: list recent chart upgrades","name":"helm: list recent chart upgrades","description":"Problem statement: Given a kubernetes cluster with many helm charts in different namespaces, how to use helm to query the list of the last recently \u0026ldquo;touched\u0026rdquo; charts?\nBy \u0026ldquo;touched\u0026rdquo; we mean either installed (via helm install) or upgraded (via helm upgrade).\nSomething like: helm ls --all --sort-by updated. Using kubectl directly would also be OK.\n","keywords":["dev"],"articleBody":"Problem statement: Given a kubernetes cluster with many helm charts in different namespaces, how to use helm to query the list of the last recently “touched” charts?\nBy “touched” we mean either installed (via helm install) or upgraded (via helm upgrade).\nSomething like: helm ls --all --sort-by updated. Using kubectl directly would also be OK.\nSolution The brute force way:\nhelm ls --max 99999 -A -o json | jq -r '.[] | \"\\(.updated)\\t\\(.name)\"' | sort | tail | column -t -A for all namespaces --max 99999 to “disable” paging (there’s no better way as of 2024-09-24) jq to filter out on the “updated” field Note that a sample json entry looks like the following:\n{ \"name\": \"hoth-cb7f8a327\", \"namespace\": \"default\", \"revision\": \"2\", \"updated\": \"2024-06-14 15:02:16.775174131 +0000 UTC\", \"status\": \"deployed\", \"chart\": \"hoth-0.1.0\", \"app_version\": \"1.0.0\" } Sample output of the aforementioned command:\n2024-09-24 10:56:15.655674586 +0000 UTC geonosis 2024-09-24 10:56:15.731630075 +0000 UTC coruscant 2024-09-24 11:01:35.156973247 +0000 UTC endor 2024-09-24 11:02:30.314014351 +0000 UTC hoth ","wordCount":"159","inLanguage":"en","datePublished":"2024-09-24T14:21:20+02:00","dateModified":"2024-09-24T14:21:20+02:00","author":{"@type":"Person","name":"Thiago Perrotta"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.perrotta.dev/2024/09/helm-list-recent-chart-upgrades/"},"publisher":{"@type":"Person","name":"not just serendipity","logo":{"@type":"ImageObject","url":"https://www.perrotta.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.perrotta.dev/ accesskey=h title="not just serendipity (Alt + H)"><img src=https://www.perrotta.dev/apple-touch-icon.png alt aria-label=logo height=32>not just serendipity</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.perrotta.dev/posts/ title=posts><span>posts</span></a></li><li><a href=https://www.perrotta.dev/tags/bestof/ title="★ bestof"><span>★ bestof</span></a></li><li><a href=https://www.perrotta.dev/tags/serenity/ title=serenity><span>serenity</span></a></li><li><a href=https://www.perrotta.dev/archives/ title=archives><span>archives</span></a></li><li><a href=https://www.perrotta.dev/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://www.perrotta.dev/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">helm: list recent chart upgrades</h1><div class=post-meta><span title='2024-09-24 14:21:20 +0200 +0200'>September 24, 2024</span>&nbsp;·&nbsp;159 words&nbsp;·&nbsp;Thiago Perrotta</div></header><div class=post-content><p><strong>Problem statement</strong>: Given a kubernetes cluster with many helm charts in
different namespaces, how to use <code>helm</code> to query the list of the last recently
&ldquo;touched&rdquo; charts?</p><p>By &ldquo;touched&rdquo; we mean either installed (via <code>helm install</code>) or upgraded (via
<code>helm upgrade</code>).</p><p>Something like: <code>helm ls --all --sort-by updated</code>. Using <code>kubectl</code> directly
would also be OK.</p><h2 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h2><p>The brute force way:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>helm ls --max <span style=color:#ae81ff>99999</span> -A -o json | jq -r <span style=color:#e6db74>&#39;.[] | &#34;\(.updated)\t\(.name)&#34;&#39;</span> | sort | tail | column -t
</span></span></code></pre></div><ul><li><code>-A</code> for all namespaces</li><li><code>--max 99999</code> to &ldquo;disable&rdquo; <a href=https://github.com/helm/helm/issues/3322>paging</a> (there&rsquo;s no better way as of 2024-09-24)</li><li><code>jq</code> to filter out on the &ldquo;updated&rdquo; field</li></ul><p>Note that a sample json entry looks like the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;hoth-cb7f8a327&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;namespace&#34;</span>: <span style=color:#e6db74>&#34;default&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;revision&#34;</span>: <span style=color:#e6db74>&#34;2&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;updated&#34;</span>: <span style=color:#e6db74>&#34;2024-06-14 15:02:16.775174131 +0000 UTC&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;deployed&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;chart&#34;</span>: <span style=color:#e6db74>&#34;hoth-0.1.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;app_version&#34;</span>: <span style=color:#e6db74>&#34;1.0.0&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Sample output of the aforementioned command:</p><pre tabindex=0><code>2024-09-24  10:56:15.655674586  +0000  UTC  geonosis
2024-09-24  10:56:15.731630075  +0000  UTC  coruscant
2024-09-24  11:01:35.156973247  +0000  UTC  endor
2024-09-24  11:02:30.314014351  +0000  UTC  hoth
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.perrotta.dev/tags/dev/>Dev</a></li></ul></footer></article></main><footer class=footer><span>Copyright © 2021 - 2024 Thiago Perrotta · <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a> · <a href=/index.xml>RSS</a> · Made with ♥ in 🇨🇦</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
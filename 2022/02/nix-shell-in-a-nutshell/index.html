<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>nix-shell in a nutshell | Not Just Serendipity</title>
<meta name=keywords content="dev,linux,macos"><meta name=description content="As soon as we finish installing Nix on
Darwin, we&rsquo;re greeted with a call to action:
Alright! We're done!
Try it! Open a new terminal, and type:

  $ nix-shell -p nix-info --run &#34;nix-info -m&#34;

Thank you for using this installer. If you have any feedback or need
help, don't hesitate:

You can open an issue at https://github.com/nixos/nix/issues
"><meta name=author content="Thiago Perrotta"><link rel=canonical href=https://www.perrotta.dev/2022/02/nix-shell-in-a-nutshell/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://www.perrotta.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.perrotta.dev/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://www.perrotta.dev/favicon.ico><link rel=apple-touch-icon href=https://www.perrotta.dev/apple-touch-icon.png><link rel=mask-icon href=https://www.perrotta.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.perrotta.dev/2022/02/nix-shell-in-a-nutshell/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><style>body{font-family:Crimson Pro,Vollkorn,Alegreya,Iowan Old Style,Apple Garamond,Baskerville,Times New Roman,Noto Serif,Droid Serif,Times,Source Serif Pro,serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}h1,h2,h3,h4,h5,h6,footer,nav,.toc,.post-meta{font-family:Inter,Fira Sans,Lato,system-ui,-apple-system,BlinkMacSystemFont,Avenir Next,Avenir,Segoe UI,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}code,pre{font-family:Fira Code,PT Mono,IBM Plex Mono,Menlo,Consolas,Monaco,Liberation Mono,Ubuntu Mono,Lucida Console,monospace}</style><meta property="og:title" content="nix-shell in a nutshell"><meta property="og:description" content="As soon as we finish installing Nix on
Darwin, we&rsquo;re greeted with a call to action:
Alright! We're done!
Try it! Open a new terminal, and type:

  $ nix-shell -p nix-info --run &#34;nix-info -m&#34;

Thank you for using this installer. If you have any feedback or need
help, don't hesitate:

You can open an issue at https://github.com/nixos/nix/issues
"><meta property="og:type" content="article"><meta property="og:url" content="https://www.perrotta.dev/2022/02/nix-shell-in-a-nutshell/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-10T20:48:02-05:00"><meta property="article:modified_time" content="2022-02-10T20:48:02-05:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="nix-shell in a nutshell"><meta name=twitter:description content="As soon as we finish installing Nix on
Darwin, we&rsquo;re greeted with a call to action:
Alright! We're done!
Try it! Open a new terminal, and type:

  $ nix-shell -p nix-info --run &#34;nix-info -m&#34;

Thank you for using this installer. If you have any feedback or need
help, don't hesitate:

You can open an issue at https://github.com/nixos/nix/issues
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.perrotta.dev/posts/"},{"@type":"ListItem","position":2,"name":"nix-shell in a nutshell","item":"https://www.perrotta.dev/2022/02/nix-shell-in-a-nutshell/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"nix-shell in a nutshell","name":"nix-shell in a nutshell","description":"As soon as we finish installing Nix on Darwin, we\u0026rsquo;re greeted with a call to action:\nAlright! We\u0026#39;re done! Try it! Open a new terminal, and type: $ nix-shell -p nix-info --run \u0026#34;nix-info -m\u0026#34; Thank you for using this installer. If you have any feedback or need help, don\u0026#39;t hesitate: You can open an issue at https://github.com/nixos/nix/issues ","keywords":["dev","linux","macos"],"articleBody":"As soon as we finish installing Nix on Darwin, we’re greeted with a call to action:\nAlright! We're done! Try it! Open a new terminal, and type: $ nix-shell -p nix-info --run \"nix-info -m\" Thank you for using this installer. If you have any feedback or need help, don't hesitate: You can open an issue at https://github.com/nixos/nix/issues Hello world (bloated) All right then, let’s do it!\n$ nix-shell -p nix-info --run \"nix-info -m\" - system: `\"aarch64-darwin\"` - host os: `Darwin 21.3.0, macOS 12.2` - multi-user?: `yes` - sandbox: `no` - version: `nix-env (Nix) 2.6.0` - channels(root): `\"nixpkgs\"` - nixpkgs: `/nix/var/nix/profiles/per-user/root/channels/nixpkgs` Cool, it works. Let’s break it down a bit.\nHello world (classic) Nix shell creates an ephemeral shell environment with the customizations you want. The most basic customization is to make a given set of packages available. There’s a hello package:\n$ nix-shell -p hello $ hello Hello, world! In case you’re curious, this is a GNU binary:\n$ hello --version hello (GNU Hello) 2.10 Copyright (C) 2014 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. I have no idea why they are in version 2.10 and what their changelog is. It’s such a simple binary…\nIf you exit the shell, hello seemingly vanishes:\n$ exit exit $ hello zsh: command not found: hello An easy way to think of nix-shell is like an ephemeral sandbox where all your desired packages are made available when you enter it. It’s possible to provide more than one package, naturally. It’s also possible to provide a shell.nix file with the package declarations, so that when you can nix-shell without any arguments.\n$ cat shell.nix { pkgs ? import {} }: pkgs.mkShell { # nativeBuildInputs is usually what you want -- tools you need to run nativeBuildInputs = [ pkgs.buildPackages.hello ]; } $ nix-shell $ hello Hello, world! Hello world (oneshot) $ nix-shell -p hello --run hello Hello, world! This oneshot style doesn’t enter the shell, it just runs the given --run command and then exits.\nThis post just scratched the surface of what nix-shell can do. See the references below for more in-depth guides about it.\nReferences Tools You Should Know About: nix-shell An introduction to nix-shell NixOS manual: nix-shell ","wordCount":"395","inLanguage":"en","datePublished":"2022-02-10T20:48:02-05:00","dateModified":"2022-02-10T20:48:02-05:00","author":{"@type":"Person","name":"Thiago Perrotta"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.perrotta.dev/2022/02/nix-shell-in-a-nutshell/"},"publisher":{"@type":"Person","name":"Not Just Serendipity","logo":{"@type":"ImageObject","url":"https://www.perrotta.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.perrotta.dev/ accesskey=h title="Not Just Serendipity (Alt + H)"><img src=https://www.perrotta.dev/apple-touch-icon.png alt aria-label=logo height=32>Not Just Serendipity</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.perrotta.dev/posts/ title=posts><span>posts</span></a></li><li><a href=https://www.perrotta.dev/archives/ title=archives><span>archives</span></a></li><li><a href=https://www.perrotta.dev/tags/bestof/ title=bestof><span>bestof</span></a></li><li><a href=https://www.perrotta.dev/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://www.perrotta.dev/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">nix-shell in a nutshell</h1><div class=post-meta><span title='2022-02-10 20:48:02 -0500 -0500'>February 10, 2022</span>&nbsp;·&nbsp;395 words&nbsp;·&nbsp;Thiago Perrotta</div></header><div class=post-content><p>As soon as we finish installing <a href=https://nixos.org/download.html><code>Nix</code></a> on
Darwin, we&rsquo;re greeted with a call to action:</p><pre tabindex=0><code>Alright! We&#39;re done!
Try it! Open a new terminal, and type:

  $ nix-shell -p nix-info --run &#34;nix-info -m&#34;

Thank you for using this installer. If you have any feedback or need
help, don&#39;t hesitate:

You can open an issue at https://github.com/nixos/nix/issues
</code></pre><h2 id=hello-world-bloated>Hello world (bloated)<a hidden class=anchor aria-hidden=true href=#hello-world-bloated>#</a></h2><p>All right then, let&rsquo;s do it!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ nix-shell -p nix-info --run <span style=color:#e6db74>&#34;nix-info -m&#34;</span>
</span></span><span style=display:flex><span> - system: <span style=color:#e6db74>`</span><span style=color:#e6db74>&#34;aarch64-darwin&#34;</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span> - host os: <span style=color:#e6db74>`</span>Darwin 21.3.0, macOS 12.2<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span> - multi-user?: <span style=color:#e6db74>`</span>yes<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span> - sandbox: <span style=color:#e6db74>`</span>no<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span> - version: <span style=color:#e6db74>`</span>nix-env <span style=color:#f92672>(</span>Nix<span style=color:#f92672>)</span> 2.6.0<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span> - channels<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>: <span style=color:#e6db74>`</span><span style=color:#e6db74>&#34;nixpkgs&#34;</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span> - nixpkgs: <span style=color:#e6db74>`</span>/nix/var/nix/profiles/per-user/root/channels/nixpkgs<span style=color:#e6db74>`</span>
</span></span></code></pre></div><p>Cool, it works. Let&rsquo;s break it down a bit.</p><h2 id=hello-world-classic>Hello world (classic)<a hidden class=anchor aria-hidden=true href=#hello-world-classic>#</a></h2><p>Nix shell creates an ephemeral shell environment with the customizations you
want. The most basic customization is to make a given set of packages
available. There&rsquo;s a <code>hello</code> package:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ nix-shell -p hello
</span></span><span style=display:flex><span>$ hello
</span></span><span style=display:flex><span>Hello, world!
</span></span></code></pre></div><p>In case you&rsquo;re curious, this is a GNU binary:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ hello --version
</span></span><span style=display:flex><span>hello <span style=color:#f92672>(</span>GNU Hello<span style=color:#f92672>)</span> 2.10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> <span style=color:#ae81ff>2014</span> Free Software Foundation, Inc.
</span></span><span style=display:flex><span>License GPLv3+: GNU GPL version <span style=color:#ae81ff>3</span> or later &lt;http://gnu.org/licenses/gpl.html&gt;
</span></span><span style=display:flex><span>This is free software: you are free to change and redistribute it.
</span></span><span style=display:flex><span>There is NO WARRANTY, to the extent permitted by law.
</span></span></code></pre></div><p>I have no idea why they are in version 2.10 and what their changelog is. It&rsquo;s
such a simple binary&mldr;</p><p>If you exit the shell, <code>hello</code> seemingly vanishes:</p><pre tabindex=0><code>$ exit
exit
$ hello
zsh: command not found: hello
</code></pre><p>An easy way to think of <code>nix-shell</code> is like an ephemeral sandbox where all your
desired packages are made available when you enter it. It&rsquo;s possible to provide
more than one package, naturally. It&rsquo;s also possible to provide a <code>shell.nix</code>
file with the package declarations, so that when you can <code>nix-shell</code> without
any arguments.</p><pre tabindex=0><code>$ cat shell.nix
{ pkgs ? import &lt;nixpkgs&gt; {} }:
  pkgs.mkShell {
    # nativeBuildInputs is usually what you want -- tools you need to run
    nativeBuildInputs = [ pkgs.buildPackages.hello ];
}
$ nix-shell
$ hello
Hello, world!
</code></pre><h2 id=hello-world-oneshot>Hello world (oneshot)<a hidden class=anchor aria-hidden=true href=#hello-world-oneshot>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ nix-shell -p hello --run hello
</span></span><span style=display:flex><span>Hello, world!
</span></span></code></pre></div><p>This oneshot style doesn&rsquo;t enter the shell, it just runs the given <code>--run</code>
command and then exits.</p><p>This post just scratched the surface of what <code>nix-shell</code> can do. See the
references below for more in-depth guides about it.</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://cuddly-octo-palm-tree.com/posts/2021-12-19-tyska-nix-shell/>Tools You Should Know About: nix-shell</a></li><li><a href=https://ghedam.at/15978/an-introduction-to-nix-shell>An introduction to nix-shell</a></li><li><a href=https://nixos.org/manual/nix/stable/command-ref/nix-shell.html>NixOS manual: <code>nix-shell</code></a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.perrotta.dev/tags/dev/>Dev</a></li><li><a href=https://www.perrotta.dev/tags/linux/>Linux</a></li><li><a href=https://www.perrotta.dev/tags/macos/>Macos</a></li></ul></footer><div style=text-align:center><a href="mailto:tbperrotta@gmail.com?subject=RE: Not%20Just%20Serendipity comment for 'nix-shell%20in%20a%20nutshell'" target=_blank><button>Reply via email</button></a></div></article></main><footer class=footer><span>Copyright © 2021 - 2024 Thiago Perrotta • <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a> • <a href=/index.xml>RSS</a> •</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
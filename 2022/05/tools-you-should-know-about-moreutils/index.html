<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Tools you should know about: moreutils | not just serendipity</title><meta name=title content="Tools you should know about: moreutils">
<meta name=description content="moreutils has previously been covered elsewhere, multiple times. It&rsquo;s a collection of small unix tools that follow the unix philosophy1 very strongly.
Here are some of my favorites with example usages. Obviously this post isn&rsquo;t a manual which would have been a disservice to the community; refer to the upstream man pages for detailed instructions.
sponge

sponge(1) - soak up standard input and write to a file

Here&rsquo;s a typical workflow sponge(1) is great at:"><meta name=keywords content="linux,bestof★,"><meta property="og:url" content="https://perrotta.dev/2022/05/tools-you-should-know-about-moreutils/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="Tools you should know about: moreutils"><meta property="og:description" content="moreutils has previously been covered elsewhere, multiple times. It’s a collection of small unix tools that follow the unix philosophy1 very strongly.
Here are some of my favorites with example usages. Obviously this post isn’t a manual which would have been a disservice to the community; refer to the upstream man pages for detailed instructions.
sponge sponge(1) - soak up standard input and write to a file
Here’s a typical workflow sponge(1) is great at:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-01T13:02:51-04:00"><meta property="article:modified_time" content="2022-05-01T13:02:51-04:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Bestof★"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tools you should know about: moreutils"><meta name=twitter:description content="moreutils has previously been covered elsewhere, multiple times. It’s a collection of small unix tools that follow the unix philosophy1 very strongly.
Here are some of my favorites with example usages. Obviously this post isn’t a manual which would have been a disservice to the community; refer to the upstream man pages for detailed instructions.
sponge sponge(1) - soak up standard input and write to a file
Here’s a typical workflow sponge(1) is great at:"><meta itemprop=name content="Tools you should know about: moreutils"><meta itemprop=description content="moreutils has previously been covered elsewhere, multiple times. It’s a collection of small unix tools that follow the unix philosophy1 very strongly.
Here are some of my favorites with example usages. Obviously this post isn’t a manual which would have been a disservice to the community; refer to the upstream man pages for detailed instructions.
sponge sponge(1) - soak up standard input and write to a file
Here’s a typical workflow sponge(1) is great at:"><meta itemprop=datePublished content="2022-05-01T13:02:51-04:00"><meta itemprop=dateModified content="2022-05-01T13:02:51-04:00"><meta itemprop=wordCount content="683"><meta itemprop=keywords content="Linux,Bestof★"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/><style>body{font-family:crimson pro,vollkorn,alegreya,iowan old style,apple garamond,baskerville,times new roman,noto serif,droid serif,times,source serif pro,serif,apple color emoji,segoe ui emoji,segoe ui symbol,noto color emoji;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:inter,fira sans,lato,system-ui,-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}footer{font-size:small;padding:8px;text-align:center}a{color:#3273dc}.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:fira code,pt mono,ibm plex mono,Menlo,Consolas,Monaco,liberation mono,ubuntu mono,lucida console,monospace}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 110px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1><span>★</span>
Tools you should know about: moreutils</h1><p><i><time datetime=2022-05-01 pubdate>01 May, 2022
</time>• 683 words
• 4 min</i></p><content><p><a href=https://joeyh.name/code/moreutils/><code>moreutils</code></a> has previously been covered <a href="https://news.ycombinator.com/item?id=31043655">elsewhere</a>, multiple times. It&rsquo;s a collection of small unix tools that follow the <a href=https://en.wikipedia.org/wiki/Unix_philosophy>unix philosophy</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> very strongly.</p><p>Here are some of my favorites with example usages. Obviously this post isn&rsquo;t a manual which would have been a disservice to the community; refer to the upstream man pages for detailed instructions.</p><h2 id=sponge>sponge</h2><blockquote><p>sponge(1) - soak up standard input and write to a file</p></blockquote><p>Here&rsquo;s a typical workflow <code>sponge(1)</code> is great at:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Given a file</span>
</span></span><span style=display:flex><span>$ cat myfile
</span></span><span style=display:flex><span>a
</span></span><span style=display:flex><span>b
</span></span><span style=display:flex><span>c
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Imagine that for whatever reason we want to replace &#39;a&#39; with &#39;b&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Naively, we could try this:</span>
</span></span><span style=display:flex><span>$ cat myfile | tr <span style=color:#e6db74>&#39;a&#39;</span> <span style=color:#e6db74>&#39;b&#39;</span> &gt; myfile
</span></span><span style=display:flex><span>$ cat myfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># However the file becomes empty!</span>
</span></span><span style=display:flex><span><span style=color:#75715e># It got clobbered when we tried to simultenaously read from and write to it</span>
</span></span><span style=display:flex><span><span style=color:#75715e># sponge comes to the rescue!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat myfile | tr <span style=color:#e6db74>&#39;a&#39;</span> <span style=color:#e6db74>&#39;b&#39;</span> | sponge myfile
</span></span><span style=display:flex><span>$ cat myfile
</span></span><span style=display:flex><span>b
</span></span><span style=display:flex><span>b
</span></span><span style=display:flex><span>c
</span></span></code></pre></div><p>It is great to use <code>sponge</code> in lieu of <code>></code> (shell output redirection) in shell pipelines when trying to both read from and write to the same file.</p><h2 id=vidir>vidir</h2><blockquote><p>vidir(1) - edit directories and filenames</p></blockquote><p><code>vidir(1)</code> is great to bulk rename files/directories within a given directory, one level at a time. For example, if I open <code>vidir</code> at the top-level directory of this blog repository, it opens up <code>vim</code> (although it doesn&rsquo;t need to be <code>vim</code>, your <code>$EDITOR</code> is honoured) with the following content:</p><pre tabindex=0><code>1	./.git
2	./.github
3	./.gitignore
4	./.gitmodules
5	./.hugo_build.lock
6	./LICENSE
7	./Makefile
8	./README.md
9	./archetypes
10	./config.yml
11	./content
12	./layouts
13	./public
14	./resources
15	./static
16	./themes
</code></pre><p>If I make, say, the following modifications (lines 7 and 8):</p><pre tabindex=0><code>1	./.git
2	./.github
3	./.gitignore
4	./.gitmodules
5	./.hugo_build.lock
6	./LICENSE
7	./GNUMakefile
8	./README.rst
9	./archetypes
10	./config.yml
11	./content
12	./layouts
13	./public
14	./resources
15	./static
16	./themes
</code></pre><p>And then save and quit <code>vim</code> (<code>:wq</code>), then the effect would have been the same as:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ mv Makefile GNUMakefile
</span></span><span style=display:flex><span>$ mv README.md README.rst
</span></span></code></pre></div><p>If I changed my mind and decided not to save the modifications, I could just do <code>:cq</code>.</p><p>It&rsquo;s possible to leverage vim features such as <code>.</code> (repeat command) and <code>:%s/</code> (find and replace) to perform those mass file renames quickly and effectively. <code>vidir</code> is a breeze to use!</p><h2 id=ifne>ifne</h2><blockquote><p>ifne(1) - Run command if the standard input is not empty</p></blockquote><p><code>ifne(1)</code> is effective when used with <code>find</code> or <code>fd</code> to keep shell pipes &ldquo;happy&rdquo;. Here&rsquo;s one simple example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ find . -name <span style=color:#e6db74>&#39;*.cpp&#39;</span> | xargs clang-format
</span></span></code></pre></div><p>This should work as expected, but it&rsquo;s cleaner to do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ find . -name <span style=color:#e6db74>&#39;*.cpp&#39;</span> | ifne xargs clang-format
</span></span></code></pre></div><p>The added <code>ifne</code> ensures the <code>xargs</code> command is only executed if and only if <code>find</code> yields at least one result in its output.</p><p>This wasn&rsquo;t a very practical example though: a more realistic way to use <code>ifne</code> is with prototypical on-the-fly manipulation of shell pipes wherein initially you just do whatever, but then whenever you notice some command in the middle of the pipe has failed because its input was empty (=the previous pipe command output was empty) you just prepend <code>ifne</code> to it:</p><pre tabindex=0><code>$ this | is | a | complicated | pipe
# assume &#34;complicated&#34; fails because it has no input
# so we iterate and do:
$ this | is | a | ifne complicated | pipe
</code></pre><h2 id=combine>combine</h2><blockquote><p>combine(1) - combine sets of lines from two files using boolean operations</p></blockquote><p><code>combine(1)</code> is pretty much <code>comm(1)</code>, but much more user-friendly. Given two files <code>file1</code> and <code>file2</code> it makes it easy to query which lines are {unique, common} to {each, both} files, using boolean operations (or, and, not, xor). Here&rsquo;s one example to find the <em>common lines</em> in <em>both</em> files, compare <code>combine</code> and <code>comm</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ combine file1 and file2
</span></span><span style=display:flex><span>$ comm -12 file1 file2     <span style=color:#75715e># flags are harder to remember</span>
</span></span></code></pre></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>The Unix philosophy emphasizes building simple, short, clear, modular, and extensible code that can be easily maintained and repurposed by developers other than its creators. The Unix philosophy favors composability as opposed to monolithic design.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></content><p><a href=https://perrotta.dev/tags/linux/>#linux</a>
<a href=https://perrotta.dev/tags/bestof/>#bestof★</a></p></main><hr><footer><span>© 2021 - 2025
<a href=mailto:tbperrotta@gmail.com>Thiago Perrotta
</a>·
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ·
<a href=/index.xml>RSS</a> ·
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>★ systemd: share environment variables with xorg | Not Just Serendipity</title>
<meta name=keywords content="linux,star"><meta name=description content="In this post we will learn how to share environment variables (e.g.
$GDK_SCALE) between a system user session and X11/Xorg."><meta name=author content="Thiago Perrotta"><link rel=canonical href=https://thiagowfx.github.io/2022/01/systemd-share-environment-variables-with-xorg/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://thiagowfx.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://thiagowfx.github.io/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://thiagowfx.github.io/favicon.ico><link rel=apple-touch-icon href=https://thiagowfx.github.io/apple-touch-icon.png><link rel=mask-icon href=https://thiagowfx.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><style>body{font-family:Crimson Pro,Vollkorn,Alegreya,Iowan Old Style,Apple Garamond,Baskerville,Times New Roman,Noto Serif,Droid Serif,Times,Source Serif Pro,serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}h1,h2,h3,h4,h5,h6,footer,nav,.toc,.post-meta{font-family:Inter,Fira Sans,Lato,system-ui,-apple-system,BlinkMacSystemFont,Avenir Next,Avenir,Segoe UI,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}code,pre{font-family:Fira Code,PT Mono,IBM Plex Mono,Menlo,Consolas,Monaco,Liberation Mono,Ubuntu Mono,Lucida Console,monospace}</style><meta property="og:title" content="★ systemd: share environment variables with xorg"><meta property="og:description" content="In this post we will learn how to share environment variables (e.g.
$GDK_SCALE) between a system user session and X11/Xorg."><meta property="og:type" content="article"><meta property="og:url" content="https://thiagowfx.github.io/2022/01/systemd-share-environment-variables-with-xorg/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-31T21:38:54-05:00"><meta property="article:modified_time" content="2022-01-31T21:38:54-05:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="★ systemd: share environment variables with xorg"><meta name=twitter:description content="In this post we will learn how to share environment variables (e.g.
$GDK_SCALE) between a system user session and X11/Xorg."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://thiagowfx.github.io/posts/"},{"@type":"ListItem","position":2,"name":"★ systemd: share environment variables with xorg","item":"https://thiagowfx.github.io/2022/01/systemd-share-environment-variables-with-xorg/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"★ systemd: share environment variables with xorg","name":"★ systemd: share environment variables with xorg","description":"In this post we will learn how to share environment variables (e.g. $GDK_SCALE) between a system user session and X11/Xorg.\n","keywords":["linux","star"],"articleBody":"In this post we will learn how to share environment variables (e.g. $GDK_SCALE) between a system user session and X11/Xorg.\nThe typical ~/.xinitrc and/or ~/.xprofile setup in 2020s involves some environment variable exports such as the following:\n# fix java application decorations, for tiling window managers export _JAVA_AWT_WM_NONREPARENTING=1 # make Chrome pick up proxy settings stored in gconf export DESKTOP_SESSION=gnome # HiDPI settings for GTK3+ export GDK_DPI_SCALE=0.5 export GDK_SCALE=2 # HiDPI settings for QT export QT_FONT_DPI=192 This particular set of customizations stems from my dotfiles but there isn’t anything special about it. I’ll include an explanation anyway for completeness:\nThe java setting is meant for launching certain java-based applications from within a tiling window manager.\nAll the other settings are meant for 4K HiDPI displays. The baseline DPI is 96, which is too small for 4K monitors, the fonts and icons all look tiny. In order to make them scale it’s necessary to use a higher DPI. Typical setups use either 144 (x1.5) or 192 (x2.0), the bigger the DPI the bigger fonts and icons will appear in the screen.\nThose exports work well for graphical applications launched from your favorite window manager after it has already started, however if you decide to launch an application from systemd, those settings will not be picked up by it.\nFor example, if you decide to manage redshift1 (more specifically, redshift-gtk which has a system tray app) from a systemd user session2, its fonts will look small.\nThere are several ways to address this issue.\nOne of them is to edit the service file directly:\n$ systemctl --user edit redshift-gtk And then add:\n[Unit] Environment=GDK_SCALE=2 GDK_DPI_SCALE=0.5 Which results in:\n$ cat ~/.config/systemd/user/redshift-gtk.service.d/override.conf [Unit] Environment=GDK_SCALE=2 GDK_DPI_SCALE=0.5 Which you can make effective by:\n$ systemctl --user daemon-reload $ systemctl --user restart redshift-gtk I am not a fan of this approach though, because this step would need to be repeated to all service files you want to manage this way. There’s a better, DRY way to do so.\nsystemd supports environment files (environment.d(5)). User-defined ones live in ~/.config/environment.d/*.conf by default.\nThis means we could produce the following file:\n$ cat ~/.config/environment.d/user.conf # systemd environment.d(5) EnvironmentFile # https://www.freedesktop.org/software/systemd/man/environment.d.html # # Do not use export here. # # Alternatively # systemctl --user import-environment [var1] [var2] [...] # # Troubleshooting # systemctl --user show-environment # fix java application decorations, for tiling window managers _JAVA_AWT_WM_NONREPARENTING=1 # make Chrome pick up proxy settings stored in gconf DESKTOP_SESSION=gnome # HiDPI settings for GTK3+ GDK_DPI_SCALE=0.5 GDK_SCALE=2 # HiDPI settings for QT QT_FONT_DPI=192 Which is applied to all systemd user service files automatically, no need to set Environment= manually everywhere.\nHowever, now we need to maintain two different files: the systemd .conf one and the xorg ~/.xinitrc one.\nOne elegant way to reduce maintenance burden is, in my opinion, the follownig:\n$ cat ~/.xinitrc ... # Parse user session environment variables. # This file is shared with the systemd user instance. # Export all variables: https://stackoverflow.com/a/30969768/1745064 set -a [ -r ~/.config/environment.d/user.conf ] \u0026\u0026 . ~/.config/environment.d/user.conf set +a It does what you expect: the underlying shell sources the *.conf file as if you were exporting each variable therein.\nOne caveat of this setup is that you cannot define the variables dynamically; for example, with subshells, with external programs, or with simple mathematical operations derived from other variables3.\nUltimately though you end up with only one file to manage, which is the systemd one. KISS™.\nXKCD Courtesy of Randall Munroe\nRedshift adjusts the color temperature of your screen according to your surroundings. This may help your eyes hurt less if you are working in front of the screen at night. Redshift is similar to f.lux. ↩︎\nsystemctl --user start redshift. ↩︎\nFor example, QT_FONT_DPI=$(($GDK_SCALE * 96)) or similar. ↩︎\n","wordCount":"620","inLanguage":"en","datePublished":"2022-01-31T21:38:54-05:00","dateModified":"2022-01-31T21:38:54-05:00","author":{"@type":"Person","name":"Thiago Perrotta"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://thiagowfx.github.io/2022/01/systemd-share-environment-variables-with-xorg/"},"publisher":{"@type":"Person","name":"Not Just Serendipity","logo":{"@type":"ImageObject","url":"https://thiagowfx.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://thiagowfx.github.io/ accesskey=h title="Not Just Serendipity (Alt + H)"><img src=https://thiagowfx.github.io/apple-touch-icon.png alt aria-label=logo height=32>Not Just Serendipity</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://thiagowfx.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://thiagowfx.github.io/archives/ title=archives><span>archives</span></a></li><li><a href=https://thiagowfx.github.io/tags/star/ title=bestof><span>bestof</span></a></li><li><a href=https://thiagowfx.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://thiagowfx.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>★ systemd: share environment variables with xorg</h1><div class=post-meta><span title='2022-01-31 21:38:54 -0500 -0500'>January 31, 2022</span>&nbsp;·&nbsp;620 words&nbsp;·&nbsp;Thiago Perrotta</div></header><div class=post-content><p>In this post we will learn how to share environment variables (e.g.
<code>$GDK_SCALE</code>) between a system user session and X11/Xorg.</p><p>The typical <a href=https://wiki.archlinux.org/title/Xinit><code>~/.xinitrc</code></a> and/or <a href=https://wiki.archlinux.org/title/Xprofile><code>~/.xprofile</code></a> setup in
2020s involves some environment variable exports such as the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># fix java application decorations, for tiling window managers</span>
</span></span><span style=display:flex><span>export _JAVA_AWT_WM_NONREPARENTING<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># make Chrome pick up proxy settings stored in gconf</span>
</span></span><span style=display:flex><span>export DESKTOP_SESSION<span style=color:#f92672>=</span>gnome
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># HiDPI settings for GTK3+</span>
</span></span><span style=display:flex><span>export GDK_DPI_SCALE<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>export GDK_SCALE<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># HiDPI settings for QT</span>
</span></span><span style=display:flex><span>export QT_FONT_DPI<span style=color:#f92672>=</span><span style=color:#ae81ff>192</span>
</span></span></code></pre></div><p>This particular set of customizations stems from my <a href=https://github.com/thiagowfx/.dotfiles>dotfiles</a> but
there isn&rsquo;t anything special about it. I&rsquo;ll include an explanation anyway for
completeness:</p><ul><li><p>The java setting is meant for launching certain java-based applications from
within a tiling window manager.</p></li><li><p>All the other settings are meant for 4K HiDPI displays. The baseline DPI is
96, which is too small for 4K monitors, the fonts and icons all look tiny. In
order to make them scale it&rsquo;s necessary to use a higher DPI. Typical setups
use either 144 (x1.5) or 192 (x2.0), the bigger the DPI the bigger fonts and
icons will appear in the screen.</p></li></ul><p>Those exports work well for graphical applications launched from your favorite
window manager after it has already started, however if you decide to launch an
application from <code>systemd</code>, those settings will not be picked up by it.</p><p>For example, if you decide to manage <a href=http://jonls.dk/redshift/><code>redshift</code></a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> (more
specifically, <code>redshift-gtk</code> which has a system tray app) from a systemd user
session<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, its fonts will look small.</p><p>There are several ways to address this issue.</p><p>One of them is to edit the service file directly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ systemctl --user edit redshift-gtk
</span></span></code></pre></div><p>And then add:</p><pre tabindex=0><code>[Unit]
Environment=GDK_SCALE=2 GDK_DPI_SCALE=0.5
</code></pre><p>Which results in:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat ~/.config/systemd/user/redshift-gtk.service.d/override.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Unit<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Environment<span style=color:#f92672>=</span>GDK_SCALE<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> GDK_DPI_SCALE<span style=color:#f92672>=</span>0.5
</span></span></code></pre></div><p>Which you can make effective by:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ systemctl --user daemon-reload
</span></span><span style=display:flex><span>$ systemctl --user restart redshift-gtk
</span></span></code></pre></div><p>I am not a fan of this approach though, because this step would need to be repeated
to all service files you want to manage this way. There&rsquo;s a better, <a href=https://en.wikipedia.org/wiki/Don%27t_repeat_yourself>DRY</a> way to
do so.</p><p><code>systemd</code> supports <a href=https://www.freedesktop.org/software/systemd/man/environment.d.html>environment
files</a>
(<code>environment.d(5)</code>). User-defined ones live in
<code>~/.config/environment.d/*.conf</code> by default.</p><p>This means we could produce the following file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat ~/.config/environment.d/user.conf
</span></span><span style=display:flex><span><span style=color:#75715e># systemd environment.d(5) EnvironmentFile</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://www.freedesktop.org/software/systemd/man/environment.d.html</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Do not use export here.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Alternatively</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   systemctl --user import-environment [var1] [var2] [...]</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Troubleshooting</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   systemctl --user show-environment</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># fix java application decorations, for tiling window managers</span>
</span></span><span style=display:flex><span>_JAVA_AWT_WM_NONREPARENTING<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># make Chrome pick up proxy settings stored in gconf</span>
</span></span><span style=display:flex><span>DESKTOP_SESSION<span style=color:#f92672>=</span>gnome
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># HiDPI settings for GTK3+</span>
</span></span><span style=display:flex><span>GDK_DPI_SCALE<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>GDK_SCALE<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># HiDPI settings for QT</span>
</span></span><span style=display:flex><span>QT_FONT_DPI<span style=color:#f92672>=</span><span style=color:#ae81ff>192</span>
</span></span></code></pre></div><p>Which is applied to all systemd user service files automatically, no need to
set <code>Environment=</code> manually everywhere.</p><p>However, now we need to maintain two different files: the systemd <code>.conf</code> one
and the xorg <code>~/.xinitrc</code> one.</p><p>One elegant way to reduce maintenance burden is, in my opinion, the follownig:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat ~/.xinitrc
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#75715e># Parse user session environment variables.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This file is shared with the systemd user instance.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Export all variables: https://stackoverflow.com/a/30969768/1745064</span>
</span></span><span style=display:flex><span>set -a
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> -r ~/.config/environment.d/user.conf <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> . ~/.config/environment.d/user.conf
</span></span><span style=display:flex><span>set +a
</span></span></code></pre></div><p>It does what you expect: the underlying shell sources the <code>*.conf</code> file as if
you were <code>export</code>ing each variable therein.</p><p>One caveat of this setup is that you cannot define the variables
dynamically; for example, with subshells, with external programs, or with
simple mathematical operations derived from other variables<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</p><p>Ultimately though you end up with only one file to manage, which is the systemd one.
<a href=https://en.wikipedia.org/wiki/KISS_principle>KISS</a>™.</p><figure class=align-center><a href=https://xkcd.com/963/><img loading=lazy src=https://imgs.xkcd.com/comics/x11.png#center alt="Thomas Jefferson thought that every law and every constitution should be torn down and rewritten from scratch every nineteen years--which means X is overdue."></a><figcaption><p>XKCD Courtesy of Randall Munroe</p></figcaption></figure><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Redshift adjusts the color temperature of your screen according to your
surroundings. This may help your eyes hurt less if you are working in front
of the screen at night. Redshift is similar to <a href=https://justgetflux.com/>f.lux</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><code>systemctl --user start redshift</code>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>For example, <code>QT_FONT_DPI=$(($GDK_SCALE * 96))</code> or similar.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://thiagowfx.github.io/tags/linux/>linux</a></li><li><a href=https://thiagowfx.github.io/tags/star/>star</a></li></ul></footer><div style=text-align:center><a href="mailto:tbperrotta@gmail.com?subject=RE: Not%20Just%20Serendipity comment for '%e2%98%85%20systemd%3a%20share%20environment%20variables%20with%20xorg'" target=_blank><button>Reply via email</button></a></div></article></main><footer class=footer><span>Copyright © 2021 - 2024 Thiago Perrotta • <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a> • <a href=/index.xml>RSS</a> •</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
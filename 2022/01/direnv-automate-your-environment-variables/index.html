<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title class=title>Direnv: Automate your Environment Variables | ¬¨ just serendipity üçÄ</title><meta name=title content="Direnv: Automate your Environment Variables"><meta name=description content="Direnv is a tool to automate your shell to automatically load and unload environment variables on-the-fly, on a per-project (per-directory) basis.
Preliminaries: Is it worth it?
Questions I like to ask myself before deciding whether to invest my time into learning and potentially adopting a foreign tool are the following:

Is it popular and stable enough?
Is it abandonware?

Popularity
Popularity is relative, it doesn&rsquo;t need to be worthy of the Hacker News frontpage nor Hotness on Reddit, but it needs to be widely available in popular Linux distributions and/or package managers, one install command away from my development environment."><meta name=keywords content="dev,bestof,"><meta property="og:url" content="https://perrotta.dev/2022/01/direnv-automate-your-environment-variables/"><meta property="og:site_name" content="¬¨ just serendipity üçÄ"><meta property="og:title" content="Direnv: Automate your Environment Variables"><meta property="og:description" content="Direnv is a tool to automate your shell to automatically load and unload environment variables on-the-fly, on a per-project (per-directory) basis.
Preliminaries: Is it worth it? Questions I like to ask myself before deciding whether to invest my time into learning and potentially adopting a foreign tool are the following:
Is it popular and stable enough? Is it abandonware?
Popularity Popularity is relative, it doesn‚Äôt need to be worthy of the Hacker News frontpage nor Hotness on Reddit, but it needs to be widely available in popular Linux distributions and/or package managers, one install command away from my development environment."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-04T00:34:07-05:00"><meta property="article:modified_time" content="2025-09-05T18:20:12+02:00"><meta property="article:tag" content="Dev"><meta property="article:tag" content="Bestof"><meta name=twitter:card content="summary"><meta name=twitter:title content="Direnv: Automate your Environment Variables"><meta name=twitter:description content="Direnv is a tool to automate your shell to automatically load and unload environment variables on-the-fly, on a per-project (per-directory) basis.
Preliminaries: Is it worth it? Questions I like to ask myself before deciding whether to invest my time into learning and potentially adopting a foreign tool are the following:
Is it popular and stable enough? Is it abandonware?
Popularity Popularity is relative, it doesn‚Äôt need to be worthy of the Hacker News frontpage nor Hotness on Reddit, but it needs to be widely available in popular Linux distributions and/or package managers, one install command away from my development environment."><meta itemprop=name content="Direnv: Automate your Environment Variables"><meta itemprop=description content="Direnv is a tool to automate your shell to automatically load and unload environment variables on-the-fly, on a per-project (per-directory) basis.
Preliminaries: Is it worth it? Questions I like to ask myself before deciding whether to invest my time into learning and potentially adopting a foreign tool are the following:
Is it popular and stable enough? Is it abandonware?
Popularity Popularity is relative, it doesn‚Äôt need to be worthy of the Hacker News frontpage nor Hotness on Reddit, but it needs to be widely available in popular Linux distributions and/or package managers, one install command away from my development environment."><meta itemprop=datePublished content="2022-01-04T00:34:07-05:00"><meta itemprop=dateModified content="2025-09-05T18:20:12+02:00"><meta itemprop=wordCount content="1637"><meta itemprop=keywords content="Dev,Bestof"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/2022/01/direnv-automate-your-environment-variables/><link rel=stylesheet href=https://perrotta.dev/theme.css><link rel=stylesheet href=https://perrotta.dev/syntax.css><style>body{text-align:left;margin:auto}h1,h2,h3,h4,h5,h6,footer,nav{font-family:var(--font-title)}footer{font-size:smaller;text-align:center;display:flex;flex-direction:column;gap:6px}footer>a{text-decoration:none}a{color:var(--link-color)}a.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:12px;display:inline-block}hr{border:none;border-top:1px dashed var(--border-color)}nav a.has-emoji .nav-emoji{display:none}nav a.has-emoji:hover .nav-emoji,nav a.active-star .nav-emoji{display:inline}nav a.has-emoji:hover .nav-text,nav a.active-star .nav-text{display:none}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.4}table{width:100%}img{max-width:100%}code{background-color:var(--code-bg)}li code,p code{font-size:.9em}pre{margin:1.5rem 0;border-radius:10px;background-color:var(--code-bg);overflow-x:auto}pre code{display:block;padding:18px 22px;white-space:pre;font-size:17px;overflow-x:auto;background:0 0;color:inherit}code,pre{font-family:var(--font-code)}.highlight{margin:1.5rem 0}.highlight pre{margin:0;border-radius:10px;background:0 0}.highlight pre code{padding:0}.codeblock{margin:1.5rem 0;border-radius:12px;border:1px solid var(--border-color);background:var(--code-bg);overflow:hidden}.codeblock-header{display:flex;justify-content:space-between;align-items:center;font-size:.85em;padding:10px 16px;background:rgba(0,0,0,2%);border-bottom:1px solid var(--border-color);color:var(--color-gray)}.codeblock-language{font-weight:600}.codeblock-copy{background:0 0;border:none;color:inherit;padding:2px 6px;font-size:.9em;cursor:pointer}.codeblock .highlight{margin:0;border:none}.codeblock .highlight pre{padding:18px 22px}.chroma{color:#383a42!important;background-color:#fafafa!important}.chroma .c1,.chroma .c{color:#a0a1a7!important}.chroma .k{color:#a626a4!important}.chroma .kc{color:#a626a4!important}.chroma .kd{color:#a626a4!important}.chroma .kn{color:#a626a4!important}.chroma .kp{color:#a626a4!important}.chroma .kr{color:#a626a4!important}.chroma .kt{color:#a626a4!important}.chroma .s{color:#50a14f!important}.chroma .s2{color:#50a14f!important}.chroma .nf{color:#4078f2!important}.chroma .fm{color:#4078f2!important}.chroma .n{color:#e45649!important}.chroma .m{color:#986801!important}.chroma .o{color:#0184bc!important}.chroma .na{color:#e45649!important}.chroma .nc{color:#e45649!important}.chroma .nb{color:#e45649!important}.chroma .nt{color:#e45649!important}.chroma .nd{color:#4078f2!important}.chroma .lnt{color:#a0a1a7!important}.chroma .ln{color:#a0a1a7!important}@media(prefers-color-scheme:dark){.chroma{color:#abb2bf!important;background-color:#282c34!important}.chroma .c1,.chroma .c{color:#5c6370!important}.chroma .k{color:#c678dd!important}.chroma .kc{color:#c678dd!important}.chroma .kd{color:#c678dd!important}.chroma .kn{color:#c678dd!important}.chroma .kp{color:#c678dd!important}.chroma .kr{color:#c678dd!important}.chroma .kt{color:#c678dd!important}.chroma .s{color:#98c379!important}.chroma .s2{color:#98c379!important}.chroma .nf{color:#61afef!important}.chroma .fm{color:#61afef!important}.chroma .n{color:#e06c75!important}.chroma .m{color:#d19a66!important}.chroma .o{color:#56b6c2!important}.chroma .na{color:#e06c75!important}.chroma .nc{color:#e06c75!important}.chroma .nb{color:#e06c75!important}.chroma .nt{color:#e06c75!important}.chroma .nd{color:#61afef!important}.chroma .lnt{color:#5c6370!important}.chroma .ln{color:#5c6370!important}.chroma .gi{color:#98c379!important}.chroma .gd{color:#e06c75!important}}blockquote{border-left:2px solid #999;color:var(--heading-color);padding-left:25px;padding-right:15px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex;gap:8px;margin-bottom:8px}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}.pubdate-list{color:var(--color-gray);font-style:italic}.pubdate-single{color:var(--color-gray);font-style:italic}.social-link-wrapper{display:flex;justify-content:center;align-items:center;gap:8px}.social-link{text-decoration:none;font-size:1.4em}#theme-toggle{background:0 0;border:none;padding:0;cursor:pointer;font-size:1.2em;display:inline-block;vertical-align:middle;transition:transform .2s ease}#theme-toggle:hover{transform:scale(1.15)}#theme-toggle:active{transform:scale(.95)}.badge-wrapper{display:flex;justify-content:center;align-items:center;gap:12px;flex-wrap:wrap}.badge-wrapper a{display:inline-block;text-decoration:none;transition:transform .2s ease}.badge-wrapper a:hover{transform:translateY(-2px)}.badge-wrapper img{display:block;height:auto}sup.gray{color:var(--color-gray)}.tag-cloud{display:flex;flex-wrap:wrap;gap:12px;margin-top:16px}.tag-pill{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;background:var(--code-bg);border-radius:6px;text-decoration:none;transition:all .2s ease}.tag-pill:hover{transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.2)}.tag-count{color:var(--color-gray);font-size:.9em}.rss-link{display:inline-block;margin-left:12px;padding:4px 10px;background:var(--link-color);color:#fff;text-decoration:none;border-radius:4px;font-size:.5em;font-weight:500;text-transform:uppercase;letter-spacing:.5px;transition:all .2s ease;vertical-align:middle}.rss-link:hover{transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.2);opacity:.9}.year-group{margin:20px 0;padding:16px 0;transition:all .2s ease}.year-group summary{cursor:pointer;user-select:none;padding:8px 0;font-size:1.5rem;transition:color .2s ease;list-style:none;position:relative;padding-left:32px}.year-group summary::-webkit-details-marker{display:none}.year-group summary::before{content:'‚ñ∂';position:absolute;left:0;transition:transform .3s ease;color:var(--link-color);font-size:.8em}.year-group[open] summary::before{transform:rotate(90deg)}.year-group summary:hover{color:var(--link-color)}.year-group summary strong{font-weight:600}.year-group ul.blog-posts{margin-top:16px;padding-left:32px}.year-group ul.blog-posts li{margin-bottom:12px;transition:transform .15s ease}.year-group ul.blog-posts li:hover{transform:translateX(4px)}.year-group ul.blog-posts li a{text-decoration:none;border-bottom:1px solid transparent;transition:all .2s ease}.year-group ul.blog-posts li a:hover{border-bottom-color:var(--link-color)}@media(min-width:601px){.title{font-size:38px}}@media(max-width:600px){.title{font-size:2rem}.year-group{margin:16px 0;padding:12px 0}.year-group summary{font-size:1.3rem;padding-left:28px}.year-group summary::before{font-size:.75em}.year-group ul.blog-posts{padding-left:0;margin-top:12px}.year-group ul.blog-posts li{flex-direction:column;gap:4px;margin-bottom:16px}.year-group ul.blog-posts li span{flex:unset}ul.blog-posts li span{flex:unset}}@media(prefers-color-scheme:dark){blockquote{color:#ccc}textarea,input{background-color:#252525;color:var(--text-color)}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.webp></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.webp alt="thiagowfx's avatar" width=32 height=32><h1 class=title>¬¨ just serendipity üçÄ</h1></a><nav><a href=/tags/bestof/ class="has-emoji active-star"><span class=nav-emoji>‚≠ê</span>
<span class=nav-text>‚òÖ</span>
</a><a href=/posts/><span class=nav-text>Blog</span>
</a><a href=/blogroll/><span class=nav-text>Blogroll</span>
</a><a href=/tags/coding/><span class=nav-text>Coding</span></a></nav></header><main><script>document.addEventListener("keydown",function(e){if(e.key==="j"||e.key==="ArrowLeft"){const e=document.querySelector('[data-nav="prev"]');e&&e.href&&(window.location.href=e.href)}else if(e.key==="k"||e.key==="ArrowRight"){const e=document.querySelector('[data-nav="next"]');e&&e.href&&(window.location.href=e.href)}})</script><a href=https://perrotta.dev/2022/01/miniflux-rolling-my-own-rss-reader/ data-nav=prev style=display:none></a><a href=https://perrotta.dev/2022/01/alpine-linux-apk-command-not-found-hook/ data-nav=next style=display:none></a><h2><span>‚òÖ</span> Direnv: Automate your Environment Variables</h2><p><span class=pubdate-single><time datetime=2022-01-04 pubdate>04 Jan, 2022
</time>‚Ä¢ 1637 words ‚Ä¢ 8 min
‚Ä¢ updated <time datetime=2025-09-05>05 Sep, 2025</time></span></p><div class=old-entry-warning role=note>‚ö†Ô∏è This post is over one year old. It may no longer be up to date. Opinions may have changed.</div><content><p><a href=https://direnv.net/>Direnv</a> is a tool to automate your shell to automatically load and unload environment variables on-the-fly, on a per-project (per-directory) basis.</p><h2 id=preliminaries-is-it-worth-it>Preliminaries: Is it worth it?</h2><p>Questions I like to ask myself before deciding whether to invest my time into learning and potentially <strong>adopting</strong> a foreign tool are the following:</p><blockquote><p>Is it <strong>popular</strong> <em>and</em> <strong>stable</strong> enough?
Is it abandonware?</p></blockquote><h3 id=popularity>Popularity</h3><p>Popularity is relative, it doesn&rsquo;t need to be worthy of the Hacker News frontpage nor Hotness on Reddit, but it needs to be widely available in popular Linux distributions and/or package managers, one install command away from my development environment.</p><p><a href=https://repology.org/>Repology</a> is a good proxy for popularity. Looking at <a href=https://repology.org/project/direnv/badges>direnv</a> therein, it&rsquo;s available for Alpine, Arch, Debian, Fedora, FreeBSD, HomeBrew, Nix, OpenBSD, Ubuntu&mldr;that&rsquo;s more than enough, we can safely conclude <code>direnv</code> is widely popular.</p><p>The main takeaway we want to confirm is whether the project isn&rsquo;t too niche and/or an one-man show. Seeing signs of a small-ish community and/or occasional contributions from external users/developers helps build confidence and give credibility to the project.</p><h3 id=stability-and-abandonware>Stability and Abandonware</h3><p>Stability is easier to define than popularity and can often be determined just by taking a quick glance at the github (or whichever other forge it&rsquo;s hosted in) page of the project.</p><p>At the time of this writing, the latest release of <a href=https://github.com/direnv/direnv>direnv</a> was about a week ago (2.30.2, Dec 28th 2021). It&rsquo;s definitely not abandonware and it&rsquo;s well maintained. A few signs that help corroborate that:</p><ul><li>Several PRs were merged recently</li><li>Its issue tracker is quite active, with a good mix of feature requests and bugs</li><li>I don&rsquo;t like to judge the project based on the number of issues it has, especially if it&rsquo;s popular. Chromium has <a href=https://bugs.chromium.org/p/chromium/issues/list>60k+</a> issues at the time of this writing, yet I wouldn&rsquo;t call it <em>bleeding edge</em>. Common sense applies. Since <code>direnv</code> has been around for a while and it&rsquo;s relatively popular, 150+ open issue seems acceptable to me.</li></ul><p>Now that <code>direnv</code> passed the Litmus test for adoption<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>, let&rsquo;s get our hands dirty.</p><h2 id=installation>Installation</h2><p>There&rsquo;s nothing special here, as <code>direnv</code> is widely packaged. Pick your poison:</p><div class=codeblock data-lang=shell><div class=codeblock-header><span class=codeblock-language>shell</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo pacman -Syu direnv  <span class=c1># Arch Linux</span>
</span></span><span class=line><span class=cl>$ doas apk add direnv  <span class=c1># Alpine Linux</span>
</span></span><span class=line><span class=cl>$ sudo apt install direnv  <span class=c1># Debian-based distros</span></span></span></code></pre></div></div><p>Is it lightweight?</p><div class=codeblock data-lang=shell><div class=codeblock-header><span class=codeblock-language>shell</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ apk info -L direnv
</span></span><span class=line><span class=cl>direnv-2.30.1-r0 contains:
</span></span><span class=line><span class=cl>usr/bin/direnv</span></span></code></pre></div></div><p>Hell yes! More lightweight than that? Impossible. It&rsquo;s a single binary thanks to Golang. No tons of files or dependencies. I mean:</p><div class=codeblock data-lang=shell><div class=codeblock-header><span class=codeblock-language>shell</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ du -sh /usr/bin/direnv
</span></span><span class=line><span class=cl>7.5M    /usr/bin/direnv</span></span></code></pre></div></div><p>&mldr;it&rsquo;s a 7MB binary, let&rsquo;s not get ahead of ourselves. But that&rsquo;s fine, really, it&rsquo;s just a dev tool, we don&rsquo;t really deploy it to prod.</p><h2 id=use-cases>Use Cases</h2><p>Everything is controlled with a <code>.envrc</code> file within a repository root. A typical file could look like this:</p><div class=codeblock><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>export HOUSE=&#34;ATREIDES&#34;
</span></span><span class=line><span class=cl>layout python3</span></span></code></pre></div></div><p>The <a href=https://direnv.net/>upstream website</a> does a great job at summarizing use cases. I am not here to duplicate documentation, so please go ahead and read it. That said, here are some example use cases I found useful:</p><h3 id=use-case-python>Use Case: Python</h3><p>Python developers often need to create different virtual environments for different projects. For example, I was participating in <a href=https://adventofcode.com/>Advent of Code</a> last year and wrote my solutions in Python 3: <a href=https://github.com/thiagowfx/adventofcode>https://github.com/thiagowfx/adventofcode</a>.</p><p>Each day<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> I would <code>cd ~/projects/adventofcode</code>, and then do <code>source ~/.venv/bin/activate</code>. And guess what, that&rsquo;s for the first terminal where I&rsquo;d run <code>make</code>, I&rsquo;d also spawn a second one with <code>vim</code>, thereby needing to activate the virtual environment twice.</p><p>And this is assuming the virtual environment already exists. If it didn&rsquo;t - for example, after a vanilla <code>git clone</code>, I&rsquo;d have to do <code>python -m venv .venv</code> first.</p><p>Quickly all of this became repetitive and annoying. I kinda &ldquo;cheated&rdquo; and stopped using the virtualenv for a few days, relying on my Linux distribution package manager instead:</p><div class=codeblock data-lang=shell><div class=codeblock-header><span class=codeblock-language>shell</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>% apk add py3-<span class=o>{</span>autopep8,pyflakes,numpy,pylint<span class=o>}</span></span></span></code></pre></div></div><p>This way, my</p><div class=codeblock data-lang=python><div class=codeblock-header><span class=codeblock-language>python</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span></span></span></code></pre></div></div><p>would correctly work and not yell that <code>numpy</code> was nowhere to be found.</p><p>It&rsquo;s not very clean, but it worked. However eventually I wanted to become cleaner and leaner and automate my virtual environment setup. I uninstalled the aforementioned packages after a few days:</p><div class=codeblock><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>% apk del py3-{autopep8,pyflakes,numpy,pylint}</span></span></code></pre></div></div><p>&mldr;therefore forcing me to come up with a better setup. I always had direnv in my TODO list, and this was the perfect moment to try it out.</p><p>How does <code>direnv</code> address this?</p><ol><li>Add the <code>direnv</code> hook to your shell. I actively use two shells<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>, <code>bash</code> and <code>zsh</code>, so I did it twice and then added it to my <a href=https://github.com/thiagowfx/.dotfiles>dotfiles</a>:</li></ol><p>Bash:</p><div class=codeblock data-lang=bash><div class=codeblock-header><span class=codeblock-language>bash</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat ~/.bashrc.d/direnv.bash
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl><span class=c1># https://direnv.net/</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>hash</span> direnv &gt;/dev/null 2&gt;<span class=p>&amp;</span>1<span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nb>eval</span> <span class=s2>&#34;</span><span class=k>$(</span>direnv hook bash<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span></span></span></code></pre></div></div><p>Zsh:</p><div class=codeblock data-lang=zsh><div class=codeblock-header><span class=codeblock-language>zsh</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>$ cat ~/.zshrc.d/direnv.zsh
</span></span><span class=line><span class=cl><span class=c1>#!/bin/zsh</span>
</span></span><span class=line><span class=cl><span class=c1># https://direnv.net/</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>((</span> $+commands<span class=o>[</span>direnv<span class=o>]</span> <span class=o>))</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nb>eval</span> <span class=s2>&#34;</span><span class=k>$(</span>direnv hook zsh<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span></span></span></code></pre></div></div><ol start=2><li>Set up direnv in the AOC repository:</li></ol><div class=codeblock data-lang=shell><div class=codeblock-header><span class=codeblock-language>shell</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat ~/projects/adventofcode/.envrc
</span></span><span class=line><span class=cl>layout python3
</span></span><span class=line><span class=cl>$ direnv allow  <span class=c1># Only needs to be done once</span></span></span></code></pre></div></div><p>That&rsquo;s it: It&rsquo;s a single line of configuration. Now what does it do? All of the above. No magic: whenever you cd into the project directory or any of its subdirectories with one of the configured shells, if the venv doesn&rsquo;t exist:</p><ul><li>it will be automatically created;</li><li>then it will be sourced</li></ul><p>Now you may ask yourself: Why go through all this trouble? Why not simply create a shell script to do exactly that for you automatically? That&rsquo;s perfectly fine, it&rsquo;s a matter of taste. But then you&rsquo;ll have to maintain that script. The python ecosystem keeps changing - a few years ago I was using <code>virtualenvwrapper</code> to manage virtual environments, these days it doesn&rsquo;t exist anymore, people use either <code>python -m env</code> or <code>pyenv</code> or <code>poetry</code> or&mldr;it never ends. <a href=https://drewdevault.com/2021/11/16/Python-stop-screwing-distros-over.html>Drew DeVault</a> wrote a good piece about that.</p><figure><a href=https://xkcd.com/1987/><img src=https://imgs.xkcd.com/comics/python_environment.png alt="The Python environmental protection agency wants to seal it in a cement chamber, with pictorial messages to future civilizations warning them about the danger of using sudo to install random Python packages."></a><figcaption><p>XKCD Courtesy of Randall Munroe</p></figcaption></figure><p>Maintenance is not the only burden, scalability is also one: If you use python in several repositories, you&rsquo;ll now have to include your script in all of them.</p><p>Considering that <code>direnv</code> is flexible enough in other scenarios, I consider its adoption in this situation a good trade-off to make.</p><h3 id=use-case-hugo>Use Case: Hugo</h3><p>This blog is written in Hugo. I have a <code>Makefile</code> with a bunch of environment variables to manage its setup:</p><div class=codeblock data-lang=shell><div class=codeblock-header><span class=codeblock-language>shell</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ make dev</span></span></code></pre></div></div><p>Whenever I am working in my VPS, for reasons outside of the scope of this post I need to use a different port other than the default one for Hugo (<code>1313</code>). Since I am using variables, I could just do:</p><div class=codeblock data-lang=shell><div class=codeblock-header><span class=codeblock-language>shell</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ make <span class=nv>PORT</span><span class=o>=</span><span class=m>1234</span> dev</span></span></code></pre></div></div><p>However, to make this change permanent (&ldquo;fire-and-forget&rdquo;), I could also do:</p><div class=codeblock data-lang=shell><div class=codeblock-header><span class=codeblock-language>shell</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;export PORT=1234&#39;</span> <span class=p>|</span> tee -a .envrc
</span></span><span class=line><span class=cl>$ direnv allow  <span class=c1># Only needs to be done once</span>
</span></span><span class=line><span class=cl>$ make dev</span></span></code></pre></div></div><p>This way, whenever I run <code>make</code> I wouldn&rsquo;t even need to think twice about which port to use.</p><p>Of course, a small improvement that should be done in this scenario is to add <code>direnv</code> related files to your <code>.gitignore</code>:</p><div class=codeblock><div class=highlight><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>$ git ignore direnv &gt;&gt; .gitignore
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Created by https://www.toptal.com/developers/gitignore/api/direnv
</span></span><span class=line><span class=cl># Edit at https://www.toptal.com/developers/gitignore?templates=direnv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>### direnv ###
</span></span><span class=line><span class=cl>.direnv
</span></span><span class=line><span class=cl>.envrc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># End of https://www.toptal.com/developers/gitignore/api/direnv</span></span></code></pre></div></div><h3 id=other-use-cases>Other use cases?</h3><p>I don&rsquo;t have other real use cases to share because only recently I became familiarized with <code>direnv</code>. That said, the <a href=https://direnv.net/man/direnv-stdlib.1.html>direnv docs</a> are very comprehensive of its full potential usage.</p><p>Some use cases that I like:</p><dl><dt><code>dotenv</code></dt><dd>Automatically sources <code>.env</code> (note: not to confuse with <code>.envrc</code>) files, which are widely common in projects managed with <code>docker-compose</code>.</dd><dt><code>source_env</code> + <code>env_vars_required</code></dt><dd>Alongside <code>.gitignore</code>, this is a great way to source secrets (e.g. API keys or tokens) and not accidentally check them into your repository.</dd><dt><code>fetchurl</code></dt><dd><code>bash | curl</code> is a cancer<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> that should arguably be stopped due to its inherent security risks. That said, <code>direnv</code> provides a safer way to work with it because you can specify a hash to ensure you&rsquo;re downloading the same script - if an attacker or malicious actor modified it, direnv would throw an error.</dd><dt><code>path_add</code></dt><dd>If your project outputs to e.g. <code>build/&lt;...>/bin</code> or similar (typical in <code>cmake</code> projects and AFAIK in Rust ones too), you could add that directory to your <code>PATH</code> so that you could easily execute your binaries, without having to write the full subdirectory path each time.</dd><dt><code>layout</code></dt><dd>Besides python, <code>direnv</code> supports several other programming languages out-of-the-box. Popular examples include <code>go</code>, <code>nix</code>, <code>node</code>, <code>perl</code> and <code>ruby</code>.</dd></dl><h2 id=downsides>Downsides?</h2><p>One could call <code>direnv</code> bloated because of all of the aforementioned capabilities. If it doesn&rsquo;t spark joy for your taste, consider using <a href=https://github.com/hyperupcall/autoenv>autoenv</a> which is basically a leaner version of <code>direnv</code>, meant mostly for doing one thing and doing it well: setting and unsetting variables.</p><p>Other than that, <code>direnv</code> is pretty much a great piece of software.</p><p>One thing I didn&rsquo;t cover is how secure it is: You need to run <code>direnv allow</code> explicitly in order to tell <code>direnv</code> that you trust a given <code>.envrc</code> file. If you don&rsquo;t do it, <code>direnv</code> will refuse to source it:</p><div class=codeblock data-lang=shell><div class=codeblock-header><span class=codeblock-language>shell</span>
<button class=codeblock-copy type=button data-copy-code>Copy</button></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ touch .envrc
</span></span><span class=line><span class=cl>direnv: error ~/projects/foo/.envrc is blocked. Run <span class=sb>`</span>direnv allow<span class=sb>`</span> to approve its content</span></span></code></pre></div></div><p>If you run <code>direnv allow</code> but later on the file is modified (for example, after <code>git pull</code>, whereby you retrieve a modification from a teammate), <code>direnv</code> will once again refuse to operate. You&rsquo;ll need to whitelist it again by re-running <code>direnv allow</code>. Direnv will snapshot/hash the file contents of <code>.envrc</code> remember it across sessions.</p><h2 id=references>References</h2><ul><li><a href=https://cuddly-octo-palm-tree.com/posts/2021-12-12-tyska-direnv/>Tools You Should Know About: direnv</a></li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Obviously the aforementioned list was non-exhaustive. There are a few other questions that you may want to ask, out of scope of this article, such as: (i) does the project have an OSS or FLOSS license? (ii) does the project depend on Java?&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Advent of code challenges are released one by one, thereby forcing you to wait until the next day in order to get the next challenge.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>more on this another day&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>c.f. <a href=https://curlpipesh.tumblr.com/>https://curlpipesh.tumblr.com/</a>, <a href=https://gnu.moe/wallofshame.md>https://gnu.moe/wallofshame.md</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></content><p style=text-align:center;margin-top:2em>‚Äî ¬ß ‚Äî</p><div style=display:flex;justify-content:space-between><p>Reply via
<a href="mailto:serendipity@perrotta.dev?subject=Reply to: Direnv%3a%20Automate%20your%20Environment%20Variables">email</a></p><p><a href=https://perrotta.dev/tags/dev/>#dev</a>
<a href=https://perrotta.dev/tags/bestof/>#bestof</a></p></div></main><hr><footer><span>¬© 2021 - 2025 Thiago Perrotta ¬∑
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ¬∑
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo  ï‚Ä¢·¥•‚Ä¢ î bear</a> ¬∑ <a href=/canary>üê¶</a> ¬∑ <button id=theme-toggle aria-label="Toggle dark mode" title="Toggle dark mode">
<span id=theme-toggle-icon>üåô</span></button></span><div class=social-link-wrapper><a target=_blank rel=noopener class=social-link href=mailto:serendipity@perrotta.dev title="Email address"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1.3em" width="1.3em"><g transform="translate(0.000000,24.000000) scale(0.100000,-0.100000)"><path d="M26 191c-4-5 16-23 44-40l50-31 50 31c28 17 48 35 44 40-7 12-181 12-188 0z"/><path d="M22 103l3-58 93-3c104-3 105-3 1e2 71l-3 46-48-29-47-30-38 23c-20 13-43 27-50 31-10 6-12-5-10-51z"/></g></svg>
</a><a target=_blank rel=noopener class=social-link href=https://perrotta.dev/index.xml title="RSS feed"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 56.693 56.693" height="1em" width="1em"><path d="M3.428 31.085c6.19.0 12.009 2.418 16.382 6.816 4.381 4.398 6.793 10.256 6.793 16.492h9.539c0-18.113-14.676-32.848-32.714-32.848v9.54zM3.443 14.174c22.061.0 40.01 18.047 40.01 40.231h9.539c0-27.445-22.229-49.77-49.549-49.77v9.539zM16.634 47.741c0 3.648-2.959 6.607-6.607 6.607S3.42 51.39 3.42 47.741c0-3.65 2.958-6.607 6.606-6.607s6.608 2.957 6.608 6.607z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://github.com/thiagowfx title="Github profile"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://goodreads.com/user/show/7873832-thiago title="Goodreads profile"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 50 50" height="1em" width="1em"><path d="M25 2c-4.541.0-8.41336 1.9082151-11.017578 4.9453125C11.378203 9.9824099 10 14.07975 10 18.5s1.378203 8.517589 3.982422 11.554688C16.58664 33.091785 20.459 35 25 35c4.531588.0 8.395936-1.901605 11-4.927734V35c0 2.598543-.818503 4.764071-2.451172 6.339844C31.91616 42.915616 29.363725 44 25.5 44 17.784314 44 15 39.933333 15 36H11c0 6.066667 5.215686 12 14.5 12 4.636275.0 8.33384-1.377726 10.826172-3.783203C38.818503 41.811319 40 38.476457 40 35V18.5 3H36V6.9277344C33.395936 3.9016049 29.531588 2 25 2zm0 4c3.459.0 6.08664 1.3379255 7.982422 3.5488281C34.878203 11.759731 36 14.91225 36 18.5s-1.121797 6.740269-3.017578 8.951172C31.08664 29.662074 28.459 31 25 31s-6.08664-1.337926-7.982422-3.548828C15.121797 25.240269 14 22.08775 14 18.5s1.121797-6.740269 3.017578-8.9511719C18.91336 7.3379255 21.541 6 25 6z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://linkedin.com/in/thiagoperrotta title="LinkedIn profile"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 30 30" height="1.2em" width="1.2em"><path d="M24 4H6C4.895 4 4 4.895 4 6v18c0 1.105.895 2 2 2h18c1.105.0 2-.895 2-2V6c0-1.105-.895-2-2-2zM10.954 22h-2.95v-9.492h2.95V22zM9.449 11.151c-.951.0-1.72-.771-1.72-1.72s.77-1.719 1.72-1.719c.948.0 1.719.771 1.719 1.719C11.168 10.38 10.397 11.151 9.449 11.151zM22.004 22h-2.948v-4.616c0-1.101-.02-2.517-1.533-2.517-1.535.0-1.771 1.199-1.771 2.437V22h-2.948v-9.492h2.83v1.297h.04c.394-.746 1.356-1.533 2.791-1.533 2.987.0 3.539 1.966 3.539 4.522V22z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://stackoverflow.com/users/1745064/thiagowfx title="StackOverflow profile"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em"><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 3e2zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-2e2v39.7h2e2zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg></a></div><div class=badge-wrapper><a target=_blank href=https://512kb.club title="512kb.club badge"><img src=https://perrotta.dev/green-team.webp alt="a proud member of the green team of 512KB club">
</a><a target=_blank href=https://powrss.com/ title=powRSS><img src=https://perrotta.dev/powrss-88-31.webp alt=powRSS>
</a><a target=_blank href=https://www.vim.org/ title="Vim text editor"><img src=https://perrotta.dev/vim.webp alt="Vim text editor">
</a><a target=_blank href=https://edleeman.co.uk/cookie-zero/ title="Cookie Zero"><img src=https://perrotta.dev/cookiezero.webp alt="Cookie Zero"></a></div></footer><script>const darkVars={"bg-color":"#19150f","text-color":"#dddddd","heading-color":"#eeeeee","link-color":"#ff5e6c","border-color":"#444","code-bg":"#1a1a1a","code-text-color":"#e8e8e8"},lightVars={"bg-color":"#fffcf0","text-color":"#444","heading-color":"#222","link-color":"#3273dc","border-color":"#ddd","code-bg":"#f5f5f5","code-text-color":"#1a1a1a"};function applyTheme(e){const t=e?darkVars:lightVars;Object.entries(t).forEach(([e,t])=>{document.documentElement.style.setProperty(`--${e}`,t)}),document.getElementById("theme-toggle-icon").textContent=e?"‚òÄÔ∏è":"üåô"}const saved=localStorage.getItem("theme"),isDark=saved?saved==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches;applyTheme(isDark),document.getElementById("theme-toggle").addEventListener("click",function(){const e=localStorage.getItem("theme"),n=window.matchMedia("(prefers-color-scheme: dark)").matches,s=e?e==="dark":n,t=!s;localStorage.setItem("theme",t?"dark":"light"),applyTheme(t)}),document.addEventListener("click",function(e){if(!e.target.matches("[data-copy-code]"))return;const t=e.target,n=t.closest(".codeblock");if(!n)return;const s=n.querySelector("pre code");if(!s)return;const o=s.innerText;if(!navigator.clipboard||!navigator.clipboard.writeText)return;navigator.clipboard.writeText(o).then(function(){t.dataset.originalLabel=t.textContent,t.textContent="Copied!",setTimeout(function(){t.textContent=t.dataset.originalLabel||"Copy"},1500)}).catch(function(){t.textContent="Failed",setTimeout(function(){t.textContent=t.dataset.originalLabel||"Copy"},1500)})})</script></body></html>
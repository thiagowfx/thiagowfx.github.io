<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title class=title>Arch Linux: New PKGBUILD Workflow | ¬¨ just serendipity üçÄ</title><meta name=title content="Arch Linux: New PKGBUILD Workflow">
<meta name=description content="This document describes my workflow to manage PKGBUILDs for the AUR (Arch User Repository) in Arch Linux.
Disclaimer
First of all, this post is not a substitute to the excellent ArchWiki and it will likely get outdated at some point. In particular, refer to the following articles for up-to-date documentation that will outlive this blog:

https://wiki.archlinux.org/title/Arch_User_Repository
https://wiki.archlinux.org/title/Arch_package_guidelines
https://wiki.archlinux.org/title/Creating_packages
https://wiki.archlinux.org/title/PKGBUILD

This article is not a tutorial, as such it assumes you already know what a PKGBUILD is and how to use makepkg. In particular, you should have the base-devel and devtools packages installed in your system."><meta name=keywords content="dev,linux,bestof,"><meta property="og:url" content="https://perrotta.dev/2022/01/arch-linux-new-pkgbuild-workflow/"><meta property="og:site_name" content="¬¨ just serendipity üçÄ"><meta property="og:title" content="Arch Linux: New PKGBUILD Workflow"><meta property="og:description" content="This document describes my workflow to manage PKGBUILDs for the AUR (Arch User Repository) in Arch Linux.
Disclaimer First of all, this post is not a substitute to the excellent ArchWiki and it will likely get outdated at some point. In particular, refer to the following articles for up-to-date documentation that will outlive this blog:
https://wiki.archlinux.org/title/Arch_User_Repository https://wiki.archlinux.org/title/Arch_package_guidelines https://wiki.archlinux.org/title/Creating_packages https://wiki.archlinux.org/title/PKGBUILD This article is not a tutorial, as such it assumes you already know what a PKGBUILD is and how to use makepkg. In particular, you should have the base-devel and devtools packages installed in your system."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-18T21:59:07-05:00"><meta property="article:modified_time" content="2022-01-18T21:59:07-05:00"><meta property="article:tag" content="Dev"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Bestof"><meta name=twitter:card content="summary"><meta name=twitter:title content="Arch Linux: New PKGBUILD Workflow"><meta name=twitter:description content="This document describes my workflow to manage PKGBUILDs for the AUR (Arch User Repository) in Arch Linux.
Disclaimer First of all, this post is not a substitute to the excellent ArchWiki and it will likely get outdated at some point. In particular, refer to the following articles for up-to-date documentation that will outlive this blog:
https://wiki.archlinux.org/title/Arch_User_Repository https://wiki.archlinux.org/title/Arch_package_guidelines https://wiki.archlinux.org/title/Creating_packages https://wiki.archlinux.org/title/PKGBUILD This article is not a tutorial, as such it assumes you already know what a PKGBUILD is and how to use makepkg. In particular, you should have the base-devel and devtools packages installed in your system."><meta itemprop=name content="Arch Linux: New PKGBUILD Workflow"><meta itemprop=description content="This document describes my workflow to manage PKGBUILDs for the AUR (Arch User Repository) in Arch Linux.
Disclaimer First of all, this post is not a substitute to the excellent ArchWiki and it will likely get outdated at some point. In particular, refer to the following articles for up-to-date documentation that will outlive this blog:
https://wiki.archlinux.org/title/Arch_User_Repository https://wiki.archlinux.org/title/Arch_package_guidelines https://wiki.archlinux.org/title/Creating_packages https://wiki.archlinux.org/title/PKGBUILD This article is not a tutorial, as such it assumes you already know what a PKGBUILD is and how to use makepkg. In particular, you should have the base-devel and devtools packages installed in your system."><meta itemprop=datePublished content="2022-01-18T21:59:07-05:00"><meta itemprop=dateModified content="2022-01-18T21:59:07-05:00"><meta itemprop=wordCount content="1189"><meta itemprop=keywords content="Dev,Linux,Bestof"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/2022/01/arch-linux-new-pkgbuild-workflow/><style>:root{--color-gray:#888;--color-grayer:#666;--font-title:'Inter', 'Fira Sans', 'Lato', system-ui, -apple-system, BlinkMacSystemFont, 'Avenir Next', 'Avenir', 'Segoe UI', 'Helvetica Neue', Helvetica, Ubuntu, Roboto, Noto, Cantarell, Arial, sans-serif;--font-body:'Crimson Pro', 'Vollkorn', 'Alegreya', 'Iowan Old Style', 'Apple Garamond', 'Baskerville', 'Times New Roman', 'Noto Serif', 'Droid Serif', 'Times', 'Source Serif Pro', serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';--font-code:'Fira Code', 'PT Mono', 'IBM Plex Mono', Menlo, Consolas, Monaco, 'Liberation Mono', 'Ubuntu Mono', 'Lucida Console', monospace}body{font-family:var(--font-body);font-size:21px;margin:auto;padding:20px;max-width:840px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,strong,b{color:#222;line-height:1.2}h1{font-size:2.5rem}h2{font-size:2rem}h3{font-size:1.75rem}h4{font-size:1.5rem}h5,h6{font-size:1.25rem}h1,h2,h3,h4,h5,h6,footer,nav{font-family:var(--font-title)}footer{font-size:smaller;padding:8px;text-align:center}a{color:#3273dc}a.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.4}table{width:100%}img{max-width:100%}code{padding:3px 6px;background-color:#f2f2f2}li code,p code{font-size:.9em}pre code{color:#222;display:block;padding:25px;white-space:pre;font-size:17px;overflow-x:auto}code,pre{font-family:var(--font-code)}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:2px solid #999;color:#222;padding-left:25px;padding-right:15px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex;gap:8px;margin-bottom:8px}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}.pubdate-list{color:var(--color-gray);font-style:italic}.pubdate-single{color:var(--color-gray);font-style:italic}.social-link-wrapper{display:flex;justify-content:center;align-items:center;gap:8px;margin-top:8px}.social-link{text-decoration:none;font-size:1.4em}sup.gray{color:var(--color-gray)}.title{font-size:38px}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h1 class=title>¬¨ just serendipity üçÄ</h1></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>‚òÖ</a></nav></header><main><h2><span>‚òÖ</span>
Arch Linux: New PKGBUILD Workflow</h2><p><span class=pubdate-single><time datetime=2022-01-18 pubdate>18 Jan, 2022
</time>‚Ä¢ 1189 words
‚Ä¢ 6 min</span></p><content><p>This document describes my workflow to manage <code>PKGBUILDs</code> for the <a href=https://aur.archlinux.org/>AUR</a> (Arch User Repository) in <a href=https://www.archlinux.org/>Arch Linux</a>.</p><h2 id=disclaimer>Disclaimer</h2><p>First of all, this post is not a substitute to the excellent <a href=https://wiki.archlinux.org/>ArchWiki</a> and it will likely get outdated at some point. In particular, refer to the following articles for up-to-date documentation that will outlive this blog:</p><ul><li><a href=https://wiki.archlinux.org/title/Arch_User_Repository>https://wiki.archlinux.org/title/Arch_User_Repository</a></li><li><a href=https://wiki.archlinux.org/title/Arch_package_guidelines>https://wiki.archlinux.org/title/Arch_package_guidelines</a></li><li><a href=https://wiki.archlinux.org/title/Creating_packages>https://wiki.archlinux.org/title/Creating_packages</a></li><li><a href=https://wiki.archlinux.org/title/PKGBUILD>https://wiki.archlinux.org/title/PKGBUILD</a></li></ul><p>This article is not a tutorial, as such it assumes you already know what a <code>PKGBUILD</code> is and how to use <code>makepkg</code>. In particular, you should have the <code>base-devel</code> and <code>devtools</code> packages installed in your system.</p><h2 id=structure>Structure</h2><p>I manage my packages with <code>git</code> plus Eli Schwartz&rsquo;s excellent
<a href=https://github.com/eli-schwartz/aurpublish>aurpublish</a>. The tree structure is simple, with one <code>PKGBUILD</code> per directory:</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ git clone https://github.com/thiagowfx/PKGBUILDs <span style=color:#56b6c2>&amp;&amp;</span> tree PKGBUILDs
</span></span><span style=display:flex><span>PKGBUILDs
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ bkt
</span></span><span style=display:flex><span>‚îÇ   ‚îî‚îÄ‚îÄ PKGBUILD
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ fpp-git
</span></span><span style=display:flex><span>‚îÇ   ‚îî‚îÄ‚îÄ PKGBUILD
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ git-crecord
</span></span><span style=display:flex><span>‚îÇ   ‚îî‚îÄ‚îÄ PKGBUILD
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ i3a
</span></span><span style=display:flex><span>‚îÇ   ‚îî‚îÄ‚îÄ PKGBUILD
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ LICENSE
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ Makefile
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ README.md
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ ttf-camingocode
</span></span><span style=display:flex><span>‚îÇ   ‚îî‚îÄ‚îÄ PKGBUILD
</span></span><span style=display:flex><span>‚îî‚îÄ‚îÄ urlwatch.yml
</span></span></code></pre></div><p><code>aurpublish</code> is used <em>solely</em> to automate certain interactions with the AUR, more about it later.</p><h2 id=bootstrapping>Bootstrapping</h2><p>I am going to illustrate with a package I added recently, <a href=https://github.com/dimo414/bkt><code>bkt</code></a>:</p><ul><li><p>Before you even begin, check if the package already exists, do a quick search in the <a href="https://aur.archlinux.org/packages/?O=0&amp;K=bkt">AUR</a> and also in the <a href="https://archlinux.org/packages/?sort=&amp;q=bkt&amp;maintainer=&amp;flagged=">official repos</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p></li><li><p>Start by copying over the standard <code>PKGBUILD</code> template:</p></li></ul><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ <span style=color:#e5c07b>cd</span> PKGBUILDs
</span></span><span style=display:flex><span>$ mkdir bkt <span style=color:#56b6c2>&amp;&amp;</span> <span style=color:#e5c07b>cd</span> bkt
</span></span><span style=display:flex><span>$ cp /usr/share/pacman/PKGBUILD.proto PKGBUILD
</span></span><span style=display:flex><span>$ <span style=color:#e06c75>$EDITOR</span> PKGBUILD
</span></span></code></pre></div><ul><li><p>Fill in <code>PKGBUILD</code> metadata like <code>pkgname=</code>, <code>url=</code>, etc. Refer to the ArchWiki for up-to-date best practices.</p></li><li><p>The most important step is to refer to <a href=https://wiki.archlinux.org/title/Category:Arch_package_guidelines>https://wiki.archlinux.org/title/Category:Arch_package_guidelines</a> to figure out the package type.</p></li></ul><p><code>bkt</code> is a Rust package. This is my first time packaging for Rust, not a problem though, as I can just refer to <a href=https://wiki.archlinux.org/title/Rust_package_guidelines>https://wiki.archlinux.org/title/Rust_package_guidelines</a>.</p><p>The rust package guidelines page contains the blueprint for <code>prepare()</code>, <code>check()</code>, <code>build()</code> and <code>package()</code>. Packaging is mostly a matter of gluing everything together. Read the project <code>README.md</code> and the wiki, and then combine the needed steps in the <code>PKGBUILD</code>.</p><p>By doing so, I produced the following <code>PKGBUILD</code>:</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e06c75>pkgname</span><span style=color:#56b6c2>=</span>bkt
</span></span><span style=display:flex><span><span style=color:#e06c75>pkgver</span><span style=color:#56b6c2>=</span>0.5.0
</span></span><span style=display:flex><span><span style=color:#e06c75>pkgrel</span><span style=color:#56b6c2>=</span><span style=color:#d19a66>1</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>pkgdesc</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;A subprocess caching utility&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>arch</span><span style=color:#56b6c2>=(</span><span style=color:#98c379>&#39;x86_64&#39;</span><span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>url</span><span style=color:#56b6c2>=</span><span style=color:#98c379>&#34;https://www.bkt.rs/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>license</span><span style=color:#56b6c2>=(</span><span style=color:#98c379>&#39;MIT&#39;</span><span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>makedepends</span><span style=color:#56b6c2>=(</span><span style=color:#98c379>&#39;cargo&#39;</span><span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>source</span><span style=color:#56b6c2>=(</span><span style=color:#98c379>&#34;</span><span style=color:#e06c75>$pkgname</span><span style=color:#98c379>-</span><span style=color:#e06c75>$pkgver</span><span style=color:#98c379>.tar.gz::https://github.com/dimo414/</span><span style=color:#e06c75>$pkgname</span><span style=color:#98c379>/archive/refs/tags/</span><span style=color:#e06c75>$pkgver</span><span style=color:#98c379>.tar.gz&#34;</span><span style=color:#56b6c2>)</span>
</span></span><span style=display:flex><span><span style=color:#e06c75>sha256sums</span><span style=color:#56b6c2>=()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>prepare<span style=color:#56b6c2>()</span> <span style=color:#56b6c2>{</span>
</span></span><span style=display:flex><span>	<span style=color:#e5c07b>cd</span> <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$srcdir</span><span style=color:#98c379>/</span><span style=color:#e06c75>$pkgname</span><span style=color:#98c379>-</span><span style=color:#e06c75>$pkgver</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	cargo fetch --locked --target <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$CARCH</span><span style=color:#98c379>-unknown-linux-gnu&#34;</span>
</span></span><span style=display:flex><span><span style=color:#56b6c2>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>build<span style=color:#56b6c2>()</span> <span style=color:#56b6c2>{</span>
</span></span><span style=display:flex><span>	<span style=color:#e5c07b>cd</span> <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$srcdir</span><span style=color:#98c379>/</span><span style=color:#e06c75>$pkgname</span><span style=color:#98c379>-</span><span style=color:#e06c75>$pkgver</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#e5c07b>export</span> <span style=color:#e06c75>RUSTUP_TOOLCHAIN</span><span style=color:#56b6c2>=</span>stable
</span></span><span style=display:flex><span>	<span style=color:#e5c07b>export</span> <span style=color:#e06c75>CARGO_TARGET_DIR</span><span style=color:#56b6c2>=</span>target
</span></span><span style=display:flex><span>	cargo build --frozen --release --all-features
</span></span><span style=display:flex><span><span style=color:#56b6c2>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>check<span style=color:#56b6c2>()</span> <span style=color:#56b6c2>{</span>
</span></span><span style=display:flex><span>	<span style=color:#e5c07b>cd</span> <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$srcdir</span><span style=color:#98c379>/</span><span style=color:#e06c75>$pkgname</span><span style=color:#98c379>-</span><span style=color:#e06c75>$pkgver</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#e5c07b>export</span> <span style=color:#e06c75>RUSTUP_TOOLCHAIN</span><span style=color:#56b6c2>=</span>stable
</span></span><span style=display:flex><span>	cargo <span style=color:#e5c07b>test</span> --frozen --all-features
</span></span><span style=display:flex><span><span style=color:#56b6c2>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>package<span style=color:#56b6c2>()</span> <span style=color:#56b6c2>{</span>
</span></span><span style=display:flex><span>	<span style=color:#e5c07b>cd</span> <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$srcdir</span><span style=color:#98c379>/</span><span style=color:#e06c75>$pkgname</span><span style=color:#98c379>-</span><span style=color:#e06c75>$pkgver</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	install -Dm0755 -t <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$pkgdir</span><span style=color:#98c379>/usr/bin/&#34;</span> <span style=color:#98c379>&#34;target/release/</span><span style=color:#e06c75>$pkgname</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span>	install -Dm644 LICENSE -t <span style=color:#98c379>&#34;</span><span style=color:#e06c75>$pkgdir</span><span style=color:#98c379>/usr/share/licenses/</span><span style=color:#e06c75>$pkgname</span><span style=color:#98c379>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#56b6c2>}</span>
</span></span></code></pre></div><p><strong>Note</strong>: <code>$srcdir</code> refers to the <code>src/</code> directory within <code>bkt</code>. <code>$pkgdir</code> refers to the <code>pkg/</code> directory within <code>bkt</code>.</p><h2 id=adjustments>Adjustments</h2><ul><li><p>Generate the checksums with <code>updpkgsums</code>. It will automatically update the <code>PKGBUILD</code> inplace.</p></li><li><p>Download and extract package files with <code>makepkg -o</code>.</p></li><li><p><code>ls src/</code> and check the directory structure. Update <code>cd</code> in your <code>PKGBUILD</code> to match it. Usually it will be <code>cd $srcdir/$pkgname-$pkgver</code>, but sometimes tiny adjustments are necessary.</p></li><li><p>Then run <code>makepkg -s</code>. If everything goes well, your package will be successfully built<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> (<code>bkt-0.5.0-1-x86_64.pkg.tar.zst</code>), however that doesn&rsquo;t mean it is a decent package yet.</p></li><li><p>Run <code>namcap PKGBUILD</code> and <code>namcap *.pkg.tar.zst</code> to lint your package and catch common errors. Fix the errors, if any.</p></li><li><p>To ensure all dependencies have been correctly declared and none of them are missing, run <code>makepkg</code> within a clean <a href=https://wiki.archlinux.org/title/Chroo><em>chroot</em></a>. I like to use Graysky&rsquo;s excellent <a href=https://github.com/graysky2/clean-chroot-manager><code>ccm</code></a> (Clean Chroot Manager) to do so. Run <code>ccm s</code> (=&ldquo;run makepkg in the clean chroot&rdquo;). If it produces any errors, it likely means you missed some dependencies. Adjust <code>depends=</code>, <code>checkdepends=</code> and <code>makedepends=</code> accordingly.</p></li></ul><h2 id=request-feedback-if-needed>Request feedback if needed</h2><p>If the package is only relevant to you, stop here. <code>git commit</code>, <code>git push</code>, and then you&rsquo;re done. Install the package with <code>makepkg -i</code>.</p><p>Otherwise, if the package might be potentially useful to other Arch users, you could consider uploading it to the AUR.</p><p>Before you do so, stop for a moment and make an honest judgment whether this is a high quality package and whether you&rsquo;re confident it is clean and polished enough, following the best practices documented in the Wiki. The answer doesn&rsquo;t need to be positive, it&rsquo;s perfectly OK to commit mistakes and everyone is a newbie at some point.</p><p>If the answer is negative, or if you&rsquo;re new to this process and would like some help, fear no more! There are at least two decent community resources wherein to ask for help:</p><ol><li><p><a href="https://bbs.archlinux.org/viewforum.php?id=38.">AUR Issues, Discussion & PKGBUILD Requests</a> BBS / Forums: Open a new thread, post your <code>PKGBUILD</code> (use <code>[code][/code]</code> tags if you paste it directly!) or a link to it<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>. Request folks to critique your work, mention that you&rsquo;re looking for feedback. This kind of thread is generally well received in the official forums if you demonstrate you did diligent research before asking for help.</p></li><li><p><a href=https://lists.archlinux.org/pipermail/aur-general/>AUR General Mailing List</a>: Send an email to the mailing list asking for help. In general, follow proper mailing list etiquette, good resources for that are <a href=https://useplaintext.email/>https://useplaintext.email/</a> and <a href=https://man.sr.ht/lists.sr.ht/etiquette.md>https://man.sr.ht/lists.sr.ht/etiquette.md</a>. TL;DR: Use plain-text instead of HTML in your email.</p></li></ol><p>If you&rsquo;re part of any other community (e.g. Reddit, Discord) feel free to ask therein as well. Avoid posting everywhere though, pick one community, draft your post and then patiently wait.</p><h2 id=publish-your-package>Publish your package</h2><p>If all is well, it&rsquo;s time to publish your <code>PKGBUILD</code> to the <a href=https://aur.archlinux.org/>AUR</a>. Follow the up-to-date steps at <a href=https://wiki.archlinux.org/title/Arch_User_Repository#Submitting_packages>https://wiki.archlinux.org/title/Arch_User_Repository#Submitting_packages</a>.</p><p>TL;DR: If you don&rsquo;t use <em>aurpublish</em>, do:</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ makepkg --printsrcinfo &gt; .SRCINFO
</span></span></code></pre></div><p>Then you&rsquo;ll need both the <code>PKGBUILD</code> and the <code>.SRCINFO</code> file, it&rsquo;s basically a matter of committing your changes and pushing them to the right repository.</p><p>If you do use <em>aurpublish</em> this process is much easier, it&rsquo;s mostly a matter of doing <code>git commit</code>, <code>git push</code> and <code>aurpublish bkt</code>. <em>Aurpublish</em> automatically generates the <code>.SRCINFO</code> and a commit message by the means of git hooks.</p><p>And that&rsquo;s all! Other useful tips:</p><ul><li>Use <a href=https://repology.org/>repology</a> to look for preexisting packages in other Linux (or even BSD) distributions, it&rsquo;s very handy as a starting point if you have no idea how to package a given package. In particular, Alpine Linux <code>APKBUILDs</code> are very similar to <code>PKGBUILDs</code>. Gentoo <code>EBUILDs</code> and FreeBSD <code>Makefiles</code> are also reasonable approximations.</li><li>Use <code>makepkg -src</code> to clean up after building a package.</li></ul><h2 id=bonus-track-upstream>Bonus: Track upstream</h2><p>Use a software like <a href=https://thp.io/2008/urlwatch/><code>urlwatch</code></a> or <a href=https://github.com/lilydjwg/nvchecker><code>nvchecker</code></a> to track
future upstream changes so that you can update your packages in a timely
fashion<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>. There&rsquo;s also a web service called <a href=https://release-monitoring.org/>Release
Monitoring</a>, part of Fedora Infra. And there&rsquo;s also
<a href=https://changedetection.io/>https://changedetection.io/</a>, but it&rsquo;s overkill for this task. I use <code>urlwatch</code>
the following way:</p><pre tabindex=0><code>$ cat PKGBUILDs/urlwatch.yml
# urls for urlwatch(1)
---
name: &#34;bkt&#34;
command: &#34;git ls-remote --tags https://github.com/dimo414/bkt&#34;
---
name: &#34;fpp&#34;
command: &#34;git ls-remote --tags https://github.com/facebook/PathPicker&#34;
---
name: &#34;git-crecord&#34;
command: &#34;git ls-remote --tags https://github.com/andrewshadura/git-crecord&#34;
---
name: &#34;i3a&#34;
command: &#34;git ls-remote --tags https://git.goral.net.pl/mgoral/i3a&#34;
# ---
# name: &#34;ttf-camingocode&#34;
# N/A

# Run this command periodically via cron or systemd timer.
# Set up notifications e.g. via sendmail.
$ urlwatch --urls urlwatch.yml
</code></pre><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>If you use <a href=https://duckduckgo.com/>https://duckduckgo.com/</a>, query for <code>!aur bkt</code> and <code>!archpkg bkt</code>. Handy!&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Package debugging is out of scope of this post.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>For example, use <a href=https://gist.github.com>https://gist.github.com</a> or <a href=http://paste.opensuse.org/>http://paste.opensuse.org/</a> or
<a href=http://ix.io/>http://ix.io/</a>.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>In 99% of the cases this is just a matter of bumping the <code>pkgver=</code> and
updating the checksums. If <code>pkgver=</code> is the same but there&rsquo;s a fix to the
package itself, then bump <code>pkgrel=</code> instead.&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></content><div style=display:flex;justify-content:space-between><p><a href=https://perrotta.dev/tags/dev/>#dev</a>
<a href=https://perrotta.dev/tags/linux/>#linux</a>
<a href=https://perrotta.dev/tags/bestof/>#bestof</a></p><p>Reply via <a href='mailto:serendipity@perrotta.dev?subject=Reply to: Arch%20Linux%3a%20New%20PKGBUILD%20Workflow'>email</a></p></div></main><hr><footer><span>¬© 2021 - 2025 Thiago Perrotta ¬∑
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ¬∑
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo  ï‚Ä¢·¥•‚Ä¢ î bear</a></span><div class=social-link-wrapper><a target=_blank rel=noopener class=social-link href=mailto:serendipity@perrotta.dev title="Email address"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 24 24" height="1.3em" width="1.3em"><g transform="translate(0.000000,24.000000) scale(0.100000,-0.100000)"><path d="M26 191c-4-5 16-23 44-40l50-31 50 31c28 17 48 35 44 40-7 12-181 12-188 0z"/><path d="M22 103l3-58 93-3c104-3 105-3 1e2 71l-3 46-48-29-47-30-38 23c-20 13-43 27-50 31-10 6-12-5-10-51z"/></g></svg>
</a><a target=_blank rel=noopener class=social-link href=https://perrotta.dev/index.xml title="RSS feed"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 56.693 56.693" height="1em" width="1em"><path d="M3.428 31.085c6.19.0 12.009 2.418 16.382 6.816 4.381 4.398 6.793 10.256 6.793 16.492h9.539c0-18.113-14.676-32.848-32.714-32.848v9.54zM3.443 14.174c22.061.0 40.01 18.047 40.01 40.231h9.539c0-27.445-22.229-49.77-49.549-49.77v9.539zM16.634 47.741c0 3.648-2.959 6.607-6.607 6.607S3.42 51.39 3.42 47.741c0-3.65 2.958-6.607 6.606-6.607s6.608 2.957 6.608 6.607z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://github.com/thiagowfx title="Github profile"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://goodreads.com/user/show/7873832-thiago title="Goodreads profile"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 50 50" height="1em" width="1em"><path d="M25 2c-4.541.0-8.41336 1.9082151-11.017578 4.9453125C11.378203 9.9824099 10 14.07975 10 18.5s1.378203 8.517589 3.982422 11.554688C16.58664 33.091785 20.459 35 25 35c4.531588.0 8.395936-1.901605 11-4.927734V35c0 2.598543-.818503 4.764071-2.451172 6.339844C31.91616 42.915616 29.363725 44 25.5 44 17.784314 44 15 39.933333 15 36H11c0 6.066667 5.215686 12 14.5 12 4.636275.0 8.33384-1.377726 10.826172-3.783203C38.818503 41.811319 40 38.476457 40 35V18.5 3H36V6.9277344C33.395936 3.9016049 29.531588 2 25 2zm0 4c3.459.0 6.08664 1.3379255 7.982422 3.5488281C34.878203 11.759731 36 14.91225 36 18.5s-1.121797 6.740269-3.017578 8.951172C31.08664 29.662074 28.459 31 25 31s-6.08664-1.337926-7.982422-3.548828C15.121797 25.240269 14 22.08775 14 18.5s1.121797-6.740269 3.017578-8.9511719C18.91336 7.3379255 21.541 6 25 6z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://linkedin.com/in/thiagoperrotta title="LinkedIn profile"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 30 30" height="1.2em" width="1.2em"><path d="M24 4H6C4.895 4 4 4.895 4 6v18c0 1.105.895 2 2 2h18c1.105.0 2-.895 2-2V6c0-1.105-.895-2-2-2zM10.954 22h-2.95v-9.492h2.95V22zM9.449 11.151c-.951.0-1.72-.771-1.72-1.72s.77-1.719 1.72-1.719c.948.0 1.719.771 1.719 1.719C11.168 10.38 10.397 11.151 9.449 11.151zM22.004 22h-2.948v-4.616c0-1.101-.02-2.517-1.533-2.517-1.535.0-1.771 1.199-1.771 2.437V22h-2.948v-9.492h2.83v1.297h.04c.394-.746 1.356-1.533 2.791-1.533 2.987.0 3.539 1.966 3.539 4.522V22z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://stackoverflow.com/users/1745064/thiagowfx title="StackOverflow profile"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em"><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 3e2zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-2e2v39.7h2e2zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg>
</a><a target=_blank rel=noopener class=social-link href=https://instagram.com/thiagowfx><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 -50 448 512" height="1em" width="1em"><path d="M224.1 141c-63.6.0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 256s-51.3-114.9-114.9-114.9zm0 189.6c-41.2.0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.5 74.7-74.7 74.7zm146.4-194.3c0 14.3-11.6 25.9-25.9 25.9s-25.9-11.6-25.9-25.9 11.6-25.9 25.9-25.9 25.9 11.6 25.9 25.9zM446.6 144.1c-1.5-31.7-8.4-59.8-30.5-81.9S338.2 32 306.5 30.5c-31.6-1.5-128.4-1.5-160 0C114.8 32 86.7 38.9 64.6 61s-29 50.2-30.5 81.9C32 175.7 32 272.5 33.5 304.1 35 335.8 41.9 363.9 64 386s50.2 29 81.9 30.5c31.6 1.5 128.4 1.5 160 0 31.7-1.5 59.8-8.4 81.9-30.5s29-50.2 30.5-81.9c1.5-31.6 1.5-128.4.0-160zM224.1 338c-45.2.0-82-36.8-82-82s36.8-82 82-82 82 36.8 82 82-36.8 82-82 82zm148.6-198.4c-14.3.0-25.9-11.6-25.9-25.9s11.6-25.9 25.9-25.9 25.9 11.6 25.9 25.9-11.6 25.9-25.9 25.9z"/></svg></a></div></footer></body></html>
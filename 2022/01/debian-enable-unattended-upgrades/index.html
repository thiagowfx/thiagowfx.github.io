<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Debian: Enable unattended upgrades | not just serendipity</title><meta name=title content="Debian: Enable unattended upgrades">
<meta name=description content="Here&rsquo;s how we can enable automatic (unattended) package upgrades in Debian.
Howto
Install the unattended-upgrades package with apt(8):
% apt install unattended-upgrades
The service is then enabled and started automatically:
$ systemctl status unattended-upgrades
● unattended-upgrades.service - Unattended Upgrades Shutdown
     Loaded: loaded (/lib/systemd/system/unattended-upgrades.service; enabled; vendor preset: enabled)
     Active: active (running) since Sun 2022-01-16 02:05:42 EST; 35s ago
       Docs: man:unattended-upgrade(8)
   Main PID: 22442 (unattended-upgr)
      Tasks: 2 (limit: 1597)
        CPU: 516ms
     CGroup: /system.slice/unattended-upgrades.serviceGk
             └─22442 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
By default, only security updates are enabled. We can enable all updates by uncommenting the applicable lines:"><meta name=keywords content="linux,selfhosted,"><meta property="og:url" content="https://perrotta.dev/2022/01/debian-enable-unattended-upgrades/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="Debian: Enable unattended upgrades"><meta property="og:description" content="Here’s how we can enable automatic (unattended) package upgrades in Debian.
Howto Install the unattended-upgrades package with apt(8):
% apt install unattended-upgrades The service is then enabled and started automatically:
$ systemctl status unattended-upgrades ● unattended-upgrades.service - Unattended Upgrades Shutdown Loaded: loaded (/lib/systemd/system/unattended-upgrades.service; enabled; vendor preset: enabled) Active: active (running) since Sun 2022-01-16 02:05:42 EST; 35s ago Docs: man:unattended-upgrade(8) Main PID: 22442 (unattended-upgr) Tasks: 2 (limit: 1597) CPU: 516ms CGroup: /system.slice/unattended-upgrades.serviceGk └─22442 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal By default, only security updates are enabled. We can enable all updates by uncommenting the applicable lines:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-16T02:07:00-05:00"><meta property="article:modified_time" content="2022-01-16T02:07:00-05:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Selfhosted"><meta name=twitter:card content="summary"><meta name=twitter:title content="Debian: Enable unattended upgrades"><meta name=twitter:description content="Here’s how we can enable automatic (unattended) package upgrades in Debian.
Howto Install the unattended-upgrades package with apt(8):
% apt install unattended-upgrades The service is then enabled and started automatically:
$ systemctl status unattended-upgrades ● unattended-upgrades.service - Unattended Upgrades Shutdown Loaded: loaded (/lib/systemd/system/unattended-upgrades.service; enabled; vendor preset: enabled) Active: active (running) since Sun 2022-01-16 02:05:42 EST; 35s ago Docs: man:unattended-upgrade(8) Main PID: 22442 (unattended-upgr) Tasks: 2 (limit: 1597) CPU: 516ms CGroup: /system.slice/unattended-upgrades.serviceGk └─22442 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal By default, only security updates are enabled. We can enable all updates by uncommenting the applicable lines:"><meta itemprop=name content="Debian: Enable unattended upgrades"><meta itemprop=description content="Here’s how we can enable automatic (unattended) package upgrades in Debian.
Howto Install the unattended-upgrades package with apt(8):
% apt install unattended-upgrades The service is then enabled and started automatically:
$ systemctl status unattended-upgrades ● unattended-upgrades.service - Unattended Upgrades Shutdown Loaded: loaded (/lib/systemd/system/unattended-upgrades.service; enabled; vendor preset: enabled) Active: active (running) since Sun 2022-01-16 02:05:42 EST; 35s ago Docs: man:unattended-upgrade(8) Main PID: 22442 (unattended-upgr) Tasks: 2 (limit: 1597) CPU: 516ms CGroup: /system.slice/unattended-upgrades.serviceGk └─22442 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal By default, only security updates are enabled. We can enable all updates by uncommenting the applicable lines:"><meta itemprop=datePublished content="2022-01-16T02:07:00-05:00"><meta itemprop=dateModified content="2022-01-16T02:07:00-05:00"><meta itemprop=wordCount content="401"><meta itemprop=keywords content="Linux,Selfhosted"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/><style>body{font-family:crimson pro,vollkorn,alegreya,iowan old style,apple garamond,baskerville,times new roman,noto serif,droid serif,times,source serif pro,serif,apple color emoji,segoe ui emoji,segoe ui symbol,noto color emoji;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:inter,fira sans,lato,system-ui,-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}footer{font-size:small;padding:8px;text-align:center}a{color:#3273dc}.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:fira code,pt mono,ibm plex mono,Menlo,Consolas,Monaco,liberation mono,ubuntu mono,lucida console,monospace}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 110px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1>Debian: Enable unattended upgrades</h1><p><i><time datetime=2022-01-16 pubdate>16 Jan, 2022
</time>• 401 words
• 2 minutes</i></p><content><p>Here&rsquo;s how we can enable automatic (unattended) package upgrades in Debian.</p><h2 id=howto>Howto</h2><p>Install the <code>unattended-upgrades</code> package with <code>apt(8)</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>% apt install unattended-upgrades
</span></span></code></pre></div><p>The service is then enabled and started automatically:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ systemctl status unattended-upgrades
</span></span><span style=display:flex><span>● unattended-upgrades.service - Unattended Upgrades Shutdown
</span></span><span style=display:flex><span>     Loaded: loaded <span style=color:#f92672>(</span>/lib/systemd/system/unattended-upgrades.service; enabled; vendor preset: enabled<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>     Active: active <span style=color:#f92672>(</span>running<span style=color:#f92672>)</span> since Sun 2022-01-16 02:05:42 EST; 35s ago
</span></span><span style=display:flex><span>       Docs: man:unattended-upgrade<span style=color:#f92672>(</span>8<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   Main PID: <span style=color:#ae81ff>22442</span> <span style=color:#f92672>(</span>unattended-upgr<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      Tasks: <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>limit: 1597<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        CPU: 516ms
</span></span><span style=display:flex><span>     CGroup: /system.slice/unattended-upgrades.serviceGk
</span></span><span style=display:flex><span>             └─22442 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
</span></span></code></pre></div><p>By default, only security updates are enabled. We can enable all updates by uncommenting the applicable lines:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudoedit /etc/apt/apt.conf.d/50unattended-upgrades
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Unattended-Upgrade::Origins-Pattern <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        // Codename based matching:
</span></span><span style=display:flex><span>        // This will follow the migration of a release through different
</span></span><span style=display:flex><span>        // archives <span style=color:#f92672>(</span>e.g. from testing to stable and later oldstable<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>        // Software will be the latest available <span style=color:#66d9ef>for</span> the named release,
</span></span><span style=display:flex><span>        // but the Debian release itself will not be automatically upgraded.
</span></span><span style=display:flex><span>        // <span style=color:#e6db74>&#34;origin=Debian,codename=</span><span style=color:#e6db74>${</span>distro_codename<span style=color:#e6db74>}</span><span style=color:#e6db74>-updates&#34;</span>;
</span></span><span style=display:flex><span>        // <span style=color:#e6db74>&#34;origin=Debian,codename=</span><span style=color:#e6db74>${</span>distro_codename<span style=color:#e6db74>}</span><span style=color:#e6db74>-proposed-updates&#34;</span>;
</span></span><span style=display:flex><span>        // <span style=color:#e6db74>&#34;origin=Debian,codename=</span><span style=color:#e6db74>${</span>distro_codename<span style=color:#e6db74>}</span><span style=color:#e6db74>,label=Debian&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;origin=Debian,codename=</span><span style=color:#e6db74>${</span>distro_codename<span style=color:#e6db74>}</span><span style=color:#e6db74>,label=Debian-Security&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;origin=Debian,codename=</span><span style=color:#e6db74>${</span>distro_codename<span style=color:#e6db74>}</span><span style=color:#e6db74>-security,label=Debian-Security&#34;</span>;
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>For debugging, one should run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudo unattended-upgrade -d
</span></span></code></pre></div><p>We could go beyond and add logging by the means of <code>etckeeper</code>, just like how we did for Alpine Linux&rsquo;s <a href=https://perrotta.dev/2022/01/alpine-linux-apk-logs-with-etckeeper/><code>apk</code></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>% apt install etckeeper
</span></span><span style=display:flex><span>Reading package lists... Done
</span></span><span style=display:flex><span>Building dependency tree... Done
</span></span><span style=display:flex><span>Reading state information... Done
</span></span><span style=display:flex><span>The following NEW packages will be installed:
</span></span><span style=display:flex><span>  etckeeper
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span> upgraded, <span style=color:#ae81ff>1</span> newly installed, <span style=color:#ae81ff>0</span> to remove and <span style=color:#ae81ff>0</span> not upgraded.
</span></span><span style=display:flex><span>Need to get 54.4 kB of archives.
</span></span><span style=display:flex><span>After this operation, <span style=color:#ae81ff>180</span> kB of additional disk space will be used.
</span></span><span style=display:flex><span>Get:1 http://raspbian.freemirror.org/raspbian bullseye/main armhf etckeeper all 1.18.16-1 <span style=color:#f92672>[</span>54.4 kB<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Fetched 54.4 kB in 1s <span style=color:#f92672>(</span>84.3 kB/s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Preconfiguring packages ...
</span></span><span style=display:flex><span>Selecting previously unselected package etckeeper.
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Reading database ... <span style=color:#ae81ff>44403</span> files and directories currently installed.<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Preparing to unpack .../etckeeper_1.18.16-1_all.deb ...
</span></span><span style=display:flex><span>Unpacking etckeeper <span style=color:#f92672>(</span>1.18.16-1<span style=color:#f92672>)</span> ...
</span></span><span style=display:flex><span>Setting up etckeeper <span style=color:#f92672>(</span>1.18.16-1<span style=color:#f92672>)</span> ...
</span></span><span style=display:flex><span>Created symlink /etc/systemd/system/multi-user.target.wants/etckeeper.timer → /lib/systemd/system/etckeeper.timer.
</span></span><span style=display:flex><span>etckeeper.service is a disabled or a static unit, not starting it.
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p><code>etckeeper</code> is enabled and works out-of-the-box as well:</p><pre tabindex=0><code>systemctl status etckeeper.timer
● etckeeper.timer - Daily autocommit of changes in /etc directory
     Loaded: loaded (/lib/systemd/system/etckeeper.timer; enabled; vendor preset: enabled)
     Active: active (waiting) since Sun 2022-01-16 02:28:44 EST; 2min 36s ago
    Trigger: Mon 2022-01-17 02:28:44 EST; 23h left
   Triggers: ● etckeeper.service
       Docs: man:etckeeper(8)
</code></pre><p>Here&rsquo;s what a typical log looks like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ <span style=color:#f92672>(</span>cd /etc/etckeeper <span style=color:#f92672>&amp;&amp;</span> sudo git log<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>commit 8f9f5e31d9abb833cf645825c1cbda15336818b7 <span style=color:#f92672>(</span>HEAD -&gt; master<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Author: root &lt;root@raspberry&gt;
</span></span><span style=display:flex><span>Date:   Sun Jan <span style=color:#ae81ff>16</span> 06:25:28 <span style=color:#ae81ff>2022</span> -0500
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    daily autocommit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit 5a6478711a1a1198535d5062ca309afb5c99c0eb
</span></span><span style=display:flex><span>Author: root &lt;root@raspberry&gt;
</span></span><span style=display:flex><span>Date:   Sun Jan <span style=color:#ae81ff>16</span> 02:29:01 <span style=color:#ae81ff>2022</span> -0500
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Initial commit
</span></span></code></pre></div><h2 id=references>References</h2><ul><li><a href=https://wiki.debian.org/UnattendedUpgrades>https://wiki.debian.org/UnattendedUpgrades</a></li></ul></content><p><a href=https://perrotta.dev/tags/linux/>#linux</a>
<a href=https://perrotta.dev/tags/selfhosted/>#selfhosted</a></p></main><hr><footer><span>© 2021 - 2025
<a href=mailto:tbperrotta@gmail.com>Thiago Perrotta
</a>·
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ·
<a href=/index.xml>RSS</a> ·
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
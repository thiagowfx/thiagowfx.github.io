<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Introspect the local network for Pihole | not just serendipity</title><meta name=title content="Introspect the local network for Pihole">
<meta name=description content="Recently I needed to figure out what the IP address of my pihole
instance was in my Raspberry Pi in my local network.
Finding the Raspberry Pi
nmap
nmap to the rescue!
# nmap -sS 192.168.1.1-255 | tee network.txt | less
The relevant snippets to the pihole look like this:
Nmap scan report for pi.hole (192.168.1.XX)
Host is up (0.0052s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
53/tcp open  domain
80/tcp open  http
MAC Address: AA:AA:AA:AA:AA:AA (Raspberry Pi Foundation)

Nmap scan report for pi.hole (192.168.1.YY)
Host is up (0.0059s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
53/tcp open  domain
80/tcp open  http
MAC Address: BB:BB:BB:BB:BB:BB (Raspberry Pi Foundation)
There are two IP addresses, one for the ethernet interface (eth0) and the
other for the wifi (wlan0). Later on I would disable the wifi interface."><meta name=keywords content="linux,selfhosted,"><meta property="og:url" content="https://perrotta.dev/2022/01/introspect-the-local-network-for-pihole/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="Introspect the local network for Pihole"><meta property="og:description" content="Recently I needed to figure out what the IP address of my pihole instance was in my Raspberry Pi in my local network.
Finding the Raspberry Pi nmap nmap to the rescue!
# nmap -sS 192.168.1.1-255 | tee network.txt | less The relevant snippets to the pihole look like this:
Nmap scan report for pi.hole (192.168.1.XX) Host is up (0.0052s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http MAC Address: AA:AA:AA:AA:AA:AA (Raspberry Pi Foundation) Nmap scan report for pi.hole (192.168.1.YY) Host is up (0.0059s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http MAC Address: BB:BB:BB:BB:BB:BB (Raspberry Pi Foundation) There are two IP addresses, one for the ethernet interface (eth0) and the other for the wifi (wlan0). Later on I would disable the wifi interface."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-23T13:34:58-05:00"><meta property="article:modified_time" content="2022-01-23T13:34:58-05:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Selfhosted"><meta name=twitter:card content="summary"><meta name=twitter:title content="Introspect the local network for Pihole"><meta name=twitter:description content="Recently I needed to figure out what the IP address of my pihole instance was in my Raspberry Pi in my local network.
Finding the Raspberry Pi nmap nmap to the rescue!
# nmap -sS 192.168.1.1-255 | tee network.txt | less The relevant snippets to the pihole look like this:
Nmap scan report for pi.hole (192.168.1.XX) Host is up (0.0052s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http MAC Address: AA:AA:AA:AA:AA:AA (Raspberry Pi Foundation) Nmap scan report for pi.hole (192.168.1.YY) Host is up (0.0059s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http MAC Address: BB:BB:BB:BB:BB:BB (Raspberry Pi Foundation) There are two IP addresses, one for the ethernet interface (eth0) and the other for the wifi (wlan0). Later on I would disable the wifi interface."><meta itemprop=name content="Introspect the local network for Pihole"><meta itemprop=description content="Recently I needed to figure out what the IP address of my pihole instance was in my Raspberry Pi in my local network.
Finding the Raspberry Pi nmap nmap to the rescue!
# nmap -sS 192.168.1.1-255 | tee network.txt | less The relevant snippets to the pihole look like this:
Nmap scan report for pi.hole (192.168.1.XX) Host is up (0.0052s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http MAC Address: AA:AA:AA:AA:AA:AA (Raspberry Pi Foundation) Nmap scan report for pi.hole (192.168.1.YY) Host is up (0.0059s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 53/tcp open domain 80/tcp open http MAC Address: BB:BB:BB:BB:BB:BB (Raspberry Pi Foundation) There are two IP addresses, one for the ethernet interface (eth0) and the other for the wifi (wlan0). Later on I would disable the wifi interface."><meta itemprop=datePublished content="2022-01-23T13:34:58-05:00"><meta itemprop=dateModified content="2022-01-23T13:34:58-05:00"><meta itemprop=wordCount content="640"><meta itemprop=keywords content="Linux,Selfhosted"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/><style>body{font-family:crimson pro,vollkorn,alegreya,iowan old style,apple garamond,baskerville,times new roman,noto serif,droid serif,times,source serif pro,serif,apple color emoji,segoe ui emoji,segoe ui symbol,noto color emoji;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:inter,fira sans,lato,system-ui,-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,Helvetica,Ubuntu,Roboto,Noto,Cantarell,Arial,sans-serif}footer{font-size:small;padding:8px;text-align:center}a{color:#3273dc}.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:fira code,pt mono,ibm plex mono,Menlo,Consolas,Monaco,liberation mono,ubuntu mono,lucida console,monospace}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 110px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1>Introspect the local network for Pihole</h1><p><i><time datetime=2022-01-23 pubdate>23 Jan, 2022
</time>• 640 words
• 4 min</i></p><content><p>Recently I needed to figure out what the IP address of my <a href=https://pi-hole.net/>pihole</a>
instance was in my <a href=https://www.raspberrypi.org/>Raspberry Pi</a> in my local network.</p><h2 id=finding-the-raspberry-pi>Finding the Raspberry Pi</h2><h3 id=nmap>nmap</h3><p><a href=https://nmap.org/><code>nmap</code></a> to the rescue!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># nmap -sS 192.168.1.1-255 | tee network.txt | less</span>
</span></span></code></pre></div><p>The relevant snippets to the pihole look like this:</p><pre tabindex=0><code class=language-none data-lang=none>Nmap scan report for pi.hole (192.168.1.XX)
Host is up (0.0052s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
53/tcp open  domain
80/tcp open  http
MAC Address: AA:AA:AA:AA:AA:AA (Raspberry Pi Foundation)

Nmap scan report for pi.hole (192.168.1.YY)
Host is up (0.0059s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
53/tcp open  domain
80/tcp open  http
MAC Address: BB:BB:BB:BB:BB:BB (Raspberry Pi Foundation)
</code></pre><p>There are two IP addresses, one for the ethernet interface (<code>eth0</code>) and the
other for the wifi (<code>wlan0</code>). Later on I would disable the wifi interface.</p><p>The 3 open ports are for services you would expect in a pihole:</p><ul><li><code>ssh</code> (port 22) for remote access / debugging / troubleshooting</li><li>DNS server (port 53) for the <code>dnsmasq</code> server that pihole uses underneath for adblocking</li><li>HTTP server (port 80) for the <a href=http://pi.hole/admin>http://pi.hole/admin</a> web management UI</li></ul><h3 id=ip>ip</h3><p>Another way is to use the <code>ip</code> command. In particular, <code>ip neigh</code> lists the
neighbours, one of which should be the pihole.</p><h2 id=testing-the-pihole>Testing the pihole</h2><p>One effective way to test the pihole is to see if <code>analytics.google.com</code> is
blocked. There are several ways to do so:</p><ol><li><code>ping</code> should return a local address like <code>127.0.0.1</code> or <code>0.0.0.0</code>.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ping analytics.google.com
</span></span><span style=display:flex><span>PING analytics.google.com <span style=color:#f92672>(</span>127.0.0.1<span style=color:#f92672>)</span> 56<span style=color:#f92672>(</span>84<span style=color:#f92672>)</span> bytes of data.
</span></span><span style=display:flex><span><span style=color:#ae81ff>64</span> bytes from localhost <span style=color:#f92672>(</span>127.0.0.1<span style=color:#f92672>)</span>: icmp_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>64</span> time<span style=color:#f92672>=</span>0.023 ms
</span></span><span style=display:flex><span><span style=color:#ae81ff>64</span> bytes from localhost <span style=color:#f92672>(</span>127.0.0.1<span style=color:#f92672>)</span>: icmp_seq<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span> ttl<span style=color:#f92672>=</span><span style=color:#ae81ff>64</span> time<span style=color:#f92672>=</span>0.031 ms
</span></span><span style=display:flex><span>^C
</span></span><span style=display:flex><span>--- analytics.google.com ping statistics ---
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> packets transmitted, <span style=color:#ae81ff>2</span> received, 0% packet loss, time 1002ms
</span></span><span style=display:flex><span>rtt min/avg/max/mdev <span style=color:#f92672>=</span> 0.023/0.027/0.031/0.004 ms
</span></span></code></pre></div><ol start=2><li>Ditto for a DNS lookup utility such as <code>dig</code>:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ dig +short analytics.google.com
</span></span><span style=display:flex><span>0.0.0.0
</span></span></code></pre></div><p>Other ways: <code>drill</code>, <code>host</code>, <code>nslookup</code>, <code>systemd-resolve</code>.</p><p><a href=https://d3ward.github.io/toolz/adblock.html>https://d3ward.github.io/toolz/adblock.html</a> seems to be a reasonable website to
test whether your adblock blocklists are properly working. Alternatively, just
visit any modern and large news corporation website, it will probably be full
of ads.</p><h2 id=troubleshooting-the-pihole>Troubleshooting the pihole</h2><p>If DNS resolution fails from the pihole itself, run <code>pihole restartdns</code>. Then
<code>ping google.com</code>. The ping should work, if it doesn&rsquo;t then there&rsquo;s a bigger
problem, out of scope of this post. If the ping works now but stops working
later on once you eventually reboot the Pi, consider triggering this command at
startup via <code>cron</code> or a systemd timer.</p><p>If DNS resolution works from the pihole but fails from a neighbouring device,
double-check if the device is properly configured: its DNS should be set to the
IP address of the pihole. Check these:</p><ul><li><code>/etc/resolv.conf</code></li><li>If the system uses <code>systemd-resolved</code>, run <code>resolvectl</code>.</li></ul><p>Another possibility is that the pihole might be configured to only answer
queries from <code>eth0</code>. Use the <a href=http://pi.hole/admin>http://pi.hole/admin</a> interface to ensure the
pihole is configured to answer DNS queries from the local network.</p><h2 id=setting-a-static-ip-in-the-pihole>Setting a static IP in the pihole</h2><p>There are several ways to do so, in order of recommendation:</p><ul><li><p>Static DHCP lease from your router. If running a modem, this will likely not
work. Prefer running a DHCP server from the pihole.</p></li><li><p><code>dhcpcd</code>: This is typically done as part of the standard pihole setup.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat /etc/dhcpcd.conf
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#75715e># fallback to static profile on eth0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#interface eth0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#fallback static_eth0</span>
</span></span><span style=display:flex><span>interface eth0
</span></span><span style=display:flex><span>        static ip_address<span style=color:#f92672>=</span>192.168.1.XX/24
</span></span><span style=display:flex><span>        static routers<span style=color:#f92672>=</span>192.168.1.1
</span></span><span style=display:flex><span>        static domain_name_servers<span style=color:#f92672>=</span>
</span></span></code></pre></div><p>Note: Restart <code>dhcpcd</code> to apply: <code>systemctl restart dhcpcd</code>.</p><ul><li><code>/etc/network/interfaces</code> if running Raspberry Pi OS (debian):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudoedit /etc/network/interfaces.d/pihole
</span></span><span style=display:flex><span>auto lo
</span></span><span style=display:flex><span>iface lo inet loopback
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>auto eth0
</span></span><span style=display:flex><span>iface eth0 inet static
</span></span><span style=display:flex><span>    address 192.168.1.XX
</span></span><span style=display:flex><span>    netmask 255.255.255.0
</span></span><span style=display:flex><span>    gateway 192.168.1.1
</span></span></code></pre></div><p>Note: Reconfigure debian networking to apply: <code>systemctl restart networking</code>.</p><ul><li>Static DHCP lease from the pihole itself if it&rsquo;s running a DHCP server. This
solution is a bit redundant and should only be applied as last resort.</li></ul></content><p><a href=https://perrotta.dev/tags/linux/>#linux</a>
<a href=https://perrotta.dev/tags/selfhosted/>#selfhosted</a></p></main><hr><footer><span>© 2021 - 2025
<a href=mailto:notjustserendipity@perrotta.dev>Thiago Perrotta
</a>·
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ·
<a href=/index.xml>RSS</a> ·
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
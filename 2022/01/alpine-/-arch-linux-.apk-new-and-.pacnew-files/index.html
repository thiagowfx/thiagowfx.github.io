<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Alpine / Arch Linux: .apk-new and .pacnew files | not just serendipity</title><meta name=title content="Alpine / Arch Linux: .apk-new and .pacnew files">
<meta name=description content="As packages are upgraded over time, updated configs files under /etc may
arise. Different package managers treat this issue differently.
Alpine Linux
apk creates .apk-new files, which can be located and merged by running
doas update-conf. Here is a recent example:
% doas update-conf
--- //etc/securetty
+++ //etc/securetty.apk-new
@@ -12,3 +12,6 @@
 tty11
 hvc0
 ttyS0
+ttyS1
+ttyAMA0
+ttyAMA1
New //etc/securetty available:
Quit, Next, Show diff, Edit new, Zap new, Use new (q/n/s/e/z/u) [s] u
Arch Linux
pacman creates .pacnew files, which can be located and merged by running
sudo pacdiff. Here is a recent example:"><meta name=keywords content="linux,"><meta property="og:url" content="https://perrotta.dev/2022/01/alpine-/-arch-linux-.apk-new-and-.pacnew-files/"><meta property="og:site_name" content="not just serendipity"><meta property="og:title" content="Alpine / Arch Linux: .apk-new and .pacnew files"><meta property="og:description" content="As packages are upgraded over time, updated configs files under /etc may arise. Different package managers treat this issue differently.
Alpine Linux apk creates .apk-new files, which can be located and merged by running doas update-conf. Here is a recent example:
% doas update-conf --- //etc/securetty +++ //etc/securetty.apk-new @@ -12,3 +12,6 @@ tty11 hvc0 ttyS0 +ttyS1 +ttyAMA0 +ttyAMA1 New //etc/securetty available: Quit, Next, Show diff, Edit new, Zap new, Use new (q/n/s/e/z/u) [s] u Arch Linux pacman creates .pacnew files, which can be located and merged by running sudo pacdiff. Here is a recent example:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-18T14:25:20-05:00"><meta property="article:modified_time" content="2022-01-18T14:25:20-05:00"><meta property="article:tag" content="Linux"><meta name=twitter:card content="summary"><meta name=twitter:title content="Alpine / Arch Linux: .apk-new and .pacnew files"><meta name=twitter:description content="As packages are upgraded over time, updated configs files under /etc may arise. Different package managers treat this issue differently.
Alpine Linux apk creates .apk-new files, which can be located and merged by running doas update-conf. Here is a recent example:
% doas update-conf --- //etc/securetty +++ //etc/securetty.apk-new @@ -12,3 +12,6 @@ tty11 hvc0 ttyS0 +ttyS1 +ttyAMA0 +ttyAMA1 New //etc/securetty available: Quit, Next, Show diff, Edit new, Zap new, Use new (q/n/s/e/z/u) [s] u Arch Linux pacman creates .pacnew files, which can be located and merged by running sudo pacdiff. Here is a recent example:"><meta itemprop=name content="Alpine / Arch Linux: .apk-new and .pacnew files"><meta itemprop=description content="As packages are upgraded over time, updated configs files under /etc may arise. Different package managers treat this issue differently.
Alpine Linux apk creates .apk-new files, which can be located and merged by running doas update-conf. Here is a recent example:
% doas update-conf --- //etc/securetty +++ //etc/securetty.apk-new @@ -12,3 +12,6 @@ tty11 hvc0 ttyS0 +ttyS1 +ttyAMA0 +ttyAMA1 New //etc/securetty available: Quit, Next, Show diff, Edit new, Zap new, Use new (q/n/s/e/z/u) [s] u Arch Linux pacman creates .pacnew files, which can be located and merged by running sudo pacdiff. Here is a recent example:"><meta itemprop=datePublished content="2022-01-18T14:25:20-05:00"><meta itemprop=dateModified content="2022-01-18T14:25:20-05:00"><meta itemprop=wordCount content="342"><meta itemprop=keywords content="Linux"><meta name=referrer content="no-referrer-when-downgrade"><link rel="shortcut icon" href=https://perrotta.dev/favicon.ico><link rel=canonical href=https://perrotta.dev/><style>:root{--color-gray:#888;--color-grayer:#666;--font-title:'Inter', 'Fira Sans', 'Lato', system-ui, -apple-system, BlinkMacSystemFont, 'Avenir Next', 'Avenir', 'Segoe UI', 'Helvetica Neue', Helvetica, Ubuntu, Roboto, Noto, Cantarell, Arial, sans-serif;--font-body:'Crimson Pro', 'Vollkorn', 'Alegreya', 'Iowan Old Style', 'Apple Garamond', 'Baskerville', 'Times New Roman', 'Noto Serif', 'Droid Serif', 'Times', 'Source Serif Pro', serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';--font-code:'Fira Code', 'PT Mono', 'IBM Plex Mono', Menlo, Consolas, Monaco, 'Liberation Mono', 'Ubuntu Mono', 'Lucida Console', monospace}body{font-family:var(--font-body);margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fffcf0;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6,strong,b{color:#222}h1,h2,h3,h4,h5,h6,footer,nav{font-family:var(--font-title)}footer{font-size:small;padding:8px;text-align:center}a{color:#3273dc}a.title{text-decoration:none;border:0;display:flex;align-items:center;column-gap:10px}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}li code,p code{font-size:small}pre code{color:#222;display:block;padding:20px;white-space:pre;font-size:14px;overflow-x:auto}code,pre{font-family:var(--font-code)}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 110px}ul.blog-posts li a:visited{color:#8b6fcb}.pubdate-list{color:var(--color-gray);font-style:italic}.pubdate-single{color:var(--color-grayer);font-style:italic}sup.gray{color:var(--color-grayer)}@media(prefers-color-scheme:dark){body{background-color:#01242e;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#444}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}}</style><link rel=apple-touch-icon href=https://perrotta.dev/apple-touch-icon.png></head><body><header><a href=/ class=title><img src=https://perrotta.dev/thiagowfx.png alt="thiagowfx's avatar" width=32 height=32><h2>not just serendipity</h2></a><nav><a href=/>Home</a>
<a href=/posts/>Blog</a>
<a href=/tags/bestof/>★</a></nav></header><main><h1>Alpine / Arch Linux: .apk-new and .pacnew files</h1><p><span class=pubdate-single><time datetime=2022-01-18 pubdate>18 Jan, 2022
</time>• 342 words
• 2 min</span></p><content><p>As packages are upgraded over time, updated configs files under <code>/etc</code> may
arise. Different package managers treat this issue differently.</p><h2 id=alpine-linux>Alpine Linux</h2><p><code>apk</code> creates <code>.apk-new</code> files, which can be located and merged by running
<code>doas update-conf</code>. Here is a recent example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>% doas update-conf
</span></span><span style=display:flex><span>--- //etc/securetty
</span></span><span style=display:flex><span>+++ //etc/securetty.apk-new
</span></span><span style=display:flex><span>@@ -12,3 +12,6 @@
</span></span><span style=display:flex><span> tty11
</span></span><span style=display:flex><span> hvc0
</span></span><span style=display:flex><span> ttyS0
</span></span><span style=display:flex><span>+ttyS1
</span></span><span style=display:flex><span>+ttyAMA0
</span></span><span style=display:flex><span>+ttyAMA1
</span></span><span style=display:flex><span>New //etc/securetty available:
</span></span><span style=display:flex><span>Quit, Next, Show diff, Edit new, Zap new, Use new <span style=color:#f92672>(</span>q/n/s/e/z/u<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>s<span style=color:#f92672>]</span> u
</span></span></code></pre></div><h2 id=arch-linux>Arch Linux</h2><p><code>pacman</code> creates <code>.pacnew</code> files, which can be located and merged by running
<code>sudo pacdiff</code>. Here is a recent example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>% sudo pacdiff
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; pacnew file found <span style=color:#66d9ef>for</span> /etc/sudoers
</span></span><span style=display:flex><span>:: <span style=color:#f92672>(</span>V<span style=color:#f92672>)</span>iew, <span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>kip, <span style=color:#f92672>(</span>R<span style=color:#f92672>)</span>emove pacnew, <span style=color:#f92672>(</span>O<span style=color:#f92672>)</span>verwrite with pacnew, <span style=color:#f92672>(</span>Q<span style=color:#f92672>)</span>uit: <span style=color:#f92672>[</span>v/s/r/o/q<span style=color:#f92672>]</span>
</span></span></code></pre></div><p><strong>Tip</strong>: The <a href=https://aur.archlinux.org/packages/pacdiff-pacman-hook-git/><code>pacdiff-pacman-hook-git</code></a> package helpfully adds
a pacman hook that automatically checks whether there are any due <code>.pacnew</code>
files upon upgrading the system (<code>pacman -Syu</code>), being a simple and effective
way to automate this maintenance task. It looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>: Running post-transaction hooks...
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>1/5<span style=color:#f92672>)</span> Reloading system manager configuration...
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>2/5<span style=color:#f92672>)</span> Creating temporary files...
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>3/5<span style=color:#f92672>)</span> Arming ConditionNeedsUpdate...
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>4/5<span style=color:#f92672>)</span> Registering Haskell modules...
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>5/5<span style=color:#f92672>)</span> Reviewing .pacnew files...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/etc/sudoers.pacnew ⟶   /etc/sudoers
</span></span><span style=display:flex><span>────────────────────────────────────────────────────────────────────────────────
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>────┐
</span></span><span style=display:flex><span>76: │
</span></span><span style=display:flex><span>────┘
</span></span><span style=display:flex><span> <span style=color:#75715e>##</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>## User privilege specification</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>##</span>
</span></span><span style=display:flex><span>-root ALL<span style=color:#f92672>=(</span>ALL:ALL<span style=color:#f92672>)</span> ALL
</span></span><span style=display:flex><span>+root ALL<span style=color:#f92672>=(</span>ALL<span style=color:#f92672>)</span> ALL
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>## Uncomment to allow members of group wheel to execute any command</span>
</span></span><span style=display:flex><span>-# %wheel ALL<span style=color:#f92672>=(</span>ALL:ALL<span style=color:#f92672>)</span> ALL
</span></span><span style=display:flex><span>+# %wheel ALL<span style=color:#f92672>=(</span>ALL<span style=color:#f92672>)</span> ALL
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>## Same thing without a password</span>
</span></span><span style=display:flex><span>-# %wheel ALL<span style=color:#f92672>=(</span>ALL:ALL<span style=color:#f92672>)</span> NOPASSWD: ALL
</span></span><span style=display:flex><span>+# %wheel ALL<span style=color:#f92672>=(</span>ALL<span style=color:#f92672>)</span> NOPASSWD: ALL
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>## Uncomment to allow members of group sudo to execute any command</span>
</span></span><span style=display:flex><span>-# %sudo    ALL<span style=color:#f92672>=(</span>ALL:ALL<span style=color:#f92672>)</span> ALL
</span></span><span style=display:flex><span>+# %sudo    ALL<span style=color:#f92672>=(</span>ALL<span style=color:#f92672>)</span> ALL
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>## Uncomment to allow any user to run sudo if they know the password</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>## of the user they are running the command as (root by default).</span>
</span></span><span style=display:flex><span> <span style=color:#75715e># Defaults targetpw  # Ask for the password of the target user</span>
</span></span><span style=display:flex><span>-# ALL ALL<span style=color:#f92672>=(</span>ALL:ALL<span style=color:#f92672>)</span> ALL  <span style=color:#75715e># WARNING: only use this together with &#39;Defaults targetpw&#39;</span>
</span></span><span style=display:flex><span>+# ALL ALL<span style=color:#f92672>=(</span>ALL<span style=color:#f92672>)</span> ALL  <span style=color:#75715e># WARNING: only use this together with &#39;Defaults targetpw&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>## Read drop-in files from /etc/sudoers.d</span>
</span></span><span style=display:flex><span> @includedir /etc/sudoers.d
</span></span><span style=display:flex><span> :: Searching databases <span style=color:#66d9ef>for</span> updates...
</span></span><span style=display:flex><span> :: Searching AUR <span style=color:#66d9ef>for</span> updates...
</span></span><span style=display:flex><span>  there is nothing to <span style=color:#66d9ef>do</span>
</span></span></code></pre></div></content><p><a href=https://perrotta.dev/tags/linux/>#linux</a></p></main><hr><footer><span>© 2021 - 2025
<a href=mailto:notjustserendipity@perrotta.dev>Thiago Perrotta
</a>·
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>some rights reserved</a> ·
<a href=/index.xml>RSS</a> ·
a fork of <a href=https://github.com/janraasch/hugo-bearblog/>hugo ʕ•ᴥ•ʔ bear</a></span></footer></body></html>
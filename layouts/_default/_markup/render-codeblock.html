{{- $rawLang := .Type | default "" -}}
{{- $langAliases := dict
  "anki" "text"
  "conf" "ini"
  "git" "bash"
  "gitconfig" "ini"
  "gitdiff" "diff"
  "gotemplate" "go-template"
  "graphviz" "text"
  "hjson" "json"
  "logseq" "markdown"
  "none" "text"
  "shell" "bash"
  "text" "plaintext"
-}}
{{- $lang := $rawLang -}}
{{- with index $langAliases $rawLang }}
  {{- $lang = . -}}
{{- end }}
{{- if eq $lang "" }}
  {{- $lang = "plaintext" -}}
{{- end }}
{{- $label := $rawLang -}}
{{- if eq $label "" }}
  {{- if ne $lang "plaintext" }}
    {{- $label = $lang -}}
  {{- end }}
{{- end }}
{{- $filename := .Attributes.filename | default "" -}}
<div class="codeblock"{{ if $label }} data-lang="{{ $label }}"{{ end }}>
   {{- if or $label $filename }}
   <div class="codeblock-header">
     <span class="codeblock-language">{{ with $filename }}{{ . }}{{ else }}{{ $label }}{{ end }}</span>
     <span class="codeblock-actions">{{ if and $filename $label }}<span class="codeblock-lang-badge">{{ $label }}</span> {{ end }}<button class="codeblock-copy" type="button" data-copy-code>Copy</button></span>
   </div>
   {{- end }}
   <pre><code class="language-{{ $lang }}">{{ .Inner }}</code></pre>
</div>

<!DOCTYPE html>
<html lang="{{ with .Site.LanguageCode }}{{ . }}{{ else }}en-US{{ end }}" id="root-html">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title class="title">{{- block "title" . }}{{ with .Title }}{{ . }} | {{ end }}{{ .Site.Title }}{{- end }}</title>

  {{- partial "seo_tags.html" . -}}
  <meta name="referrer" content="no-referrer-when-downgrade" />

  {{- with .Site.Params.favicon }}
  <link rel="shortcut icon" href="{{ . | absURL }}" />
  {{- end }}

  {{- with .OutputFormats.Get "rss" -}}
  {{ printf `
  <link rel="%s" type="%s" href="%s" title="%s" />` .Rel .MediaType.Type .Permalink $.Site.Title | safeHTML }}
  {{ end -}}

  <link rel="canonical" href="{{ .Permalink }}" />

  {{- with .OutputFormats.Get "PlainText" -}}
  <link rel="alternate" type="text/plain" href="{{ .Permalink }}" title="{{ $.Title }}">
  {{- end -}}

  {{- with .OutputFormats.Get "Markdown" -}}
  <link rel="alternate" type="text/markdown" href="{{ .Permalink }}" title="{{ $.Title }}">
  {{- end -}}

  {{- partial "style.html" . -}}

  {{- with .Site.Params.appleTouchIcon }}
  <link rel="apple-touch-icon" href="{{ . | absURL }}">
  {{- end }}
</head>

<body>
  <div class="h-card" style="display:none;">
    <a class="p-name u-url" href="{{ "" | absURL }}">{{ .Site.Params.Author.name }}</a>
    <span class="p-nickname">{{ .Site.Params.Author.nickname }}</span>
    <a class="u-email" href="mailto:{{ .Site.Params.Author.email }}">{{ .Site.Params.Author.email }}</a>
    <img class="u-photo" src="{{ "thiagowfx.webp" | absURL }}" alt="{{ .Site.Params.Author.name }}" />
  </div>
  <header>
    <div class="header-top">
      <a href="{{ "" | relURL }}" class="title">
        <img src='{{ "thiagowfx.webp" | absURL }}' alt="thiagowfx's avatar" width="32" height="32" />
        <h1 class="title">{{ .Site.Title }}</h1>
      </a>
      <div class="header-buttons">
         {{- partial "lang-switcher.html" . }}
         <button id="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">
           <span id="theme-toggle-icon">‚òÄÔ∏è</span>
         </button>
       </div>
    </div>
    <nav>
      {{- range .Site.Menus.main }}
      {{- if not .Parent }}
      {{- if .Params.dropdown }}
      <div class="nav-dropdown">
        <button class="nav-dropdown-trigger"{{- if .Params.emoji }} data-emoji="{{ .Params.emoji }}"{{- end }}>
          {{- with .Params.emoji }}<span class="nav-emoji">{{ . }}</span>{{- end }}
          <span class="nav-text">{{ .Name }}</span>
          <span class="nav-dropdown-arrow">‚ñº</span>
        </button>
        <div class="nav-dropdown-menu">
          {{- range .Children }}
          {{- $url := .URL }}
          {{- $langCode := $.Site.Language.Lang }}
          {{- if ne $langCode "en" }}
            {{- if or (eq .URL "/tags/") (eq .URL "/tags/bestof/") (eq .URL "/categories/") (eq .URL "/posts/") (eq .URL "/search/") }}
              {{- $url = printf "/%s%s" $langCode .URL }}
            {{- end }}
          {{- end }}
          <a href="{{ $url }}" class="nav-dropdown-item{{- if eq .URL "/categories/coding/" }} nav-dropdown-item-coding{{- end }}">{{- if eq .URL "/categories/coding/" }}‚ñ∏  {{ end }}{{ .Name }}</a>
          {{- end }}
        </div>
      </div>
      {{- else }}
      {{- $url := .URL }}
      {{- $langCode := $.Site.Language.Lang }}
      {{- if ne $langCode "en" }}
        {{- if and (ne .URL "/") (or (eq .URL "/tags/") (eq .URL "/tags/bestof/") (eq .URL "/categories/") (eq .URL "/posts/") (eq .URL "/search/") (eq .URL "/üîç")) }}
          {{- $url = printf "/%s%s" $langCode .URL }}
        {{- end }}
      {{- end }}
      <a href="{{ $url }}"{{- if .Params.emoji }} class="has-emoji{{- if or (eq $.RelPermalink $url) (and (eq .URL "/tags/bestof/") (or (in $.RelPermalink "/tags/bestof/") (and (eq $.Type "posts") (in $.Params.tags "bestof")))) }} active-star{{- end }}"{{- end }}>
        {{- with .Params.emoji }}<span class="nav-emoji">{{ . }}</span>{{- end }}
        <span class="nav-text">{{ .Name }}</span>
      </a>
      {{- end }}
      {{- end }}
      {{- end }}
    </nav>
  </header>
  <main>
    {{- block "main" . }}{{- end }}
  </main>
  <hr />
  <footer>
    <span>
      {{ site.Copyright | markdownify }} ¬∑ <a href="{{ "canary" | relURL }}">üê¶</a> ¬∑ <a href="https://uptime.perrotta.dev/status/serendipity">status</a>
    </span>

    <div class="social-link-wrapper">
      <a target="_blank" rel="noopener" class="social-link" href="mailto:{{ .Site.Params.Author.email }}"
        title="Email address">
        <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" height="1.2em" width="1.2em"
          xmlns="http://www.w3.org/2000/svg">
          <path d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
        </svg>
      </a>
      <a target="_blank" rel="noopener" class="social-link" href="{{ .Site.BaseURL }}index.xml" title="RSS feed">
        <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" height="1.2em" width="1.2em"
          xmlns="http://www.w3.org/2000/svg">
          <path d="M4 11a9 9 0 0 1 9 9M4 4a16 16 0 0 1 16 16"></path>
          <circle cx="5" cy="19" r="1"></circle>
        </svg>
      </a>
      <a target="_blank" rel="me noopener" class="social-link" href="https://github.com/thiagowfx" title="Github profile">
        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em"
          xmlns="http://www.w3.org/2000/svg">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v 3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path>
        </svg>
      </a>
      <a target="_blank" rel="me noopener" class="social-link" href="https://goodreads.com/user/show/7873832-thiago"
        title="Goodreads profile">
        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 50 50" height="1em" width="1em"
          xmlns="http://www.w3.org/2000/svg">
          <path
            d="M 25 2 C 20.459 2 16.58664 3.9082151 13.982422 6.9453125 C 11.378203 9.9824099 10 14.07975 10 18.5 C 10 22.92025 11.378203 27.017589 13.982422 30.054688 C 16.58664 33.091785 20.459 35 25 35 C 29.531588 35 33.395936 33.098395 36 30.072266 L 36 35 C 36 37.598543 35.181497 39.764071 33.548828 41.339844 C 31.91616 42.915616 29.363725 44 25.5 44 C 17.784314 44 15 39.933333 15 36 L 11 36 C 11 42.066667 16.215686 48 25.5 48 C 30.136275 48 33.83384 46.622274 36.326172 44.216797 C 38.818503 41.811319 40 38.476457 40 35 L 40 18.5 L 40 3 L 36 3 L 36 6.9277344 C 33.395936 3.9016049 29.531588 2 25 2 z M 25 6 C 28.459 6 31.08664 7.3379255 32.982422 9.5488281 C 34.878203 11.759731 36 14.91225 36 18.5 C 36 22.08775 34.878203 25.240269 32.982422 27.451172 C 31.08664 29.662074 28.459 31 25 31 C 21.541 31 18.91336 29.662074 17.017578 27.451172 C 15.121797 25.240269 14 22.08775 14 18.5 C 14 14.91225 15.121797 11.759731 17.017578 9.5488281 C 18.91336 7.3379255 21.541 6 25 6 z">
          </path>
        </svg>
      </a>
      <a target="_blank" rel="me noopener" class="social-link" href="https://linkedin.com/in/thiagoperrotta"
        title="LinkedIn profile">
        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 30 30" height="1.2em" width="1.2em"
          xmlns="http://www.w3.org/2000/svg">
          <path
            d="M24,4H6C4.895,4,4,4.895,4,6v18c0,1.105,0.895,2,2,2h18c1.105,0,2-0.895,2-2V6C26,4.895,25.105,4,24,4z M10.954,22h-2.95 v-9.492h2.95V22z M9.449,11.151c-0.951,0-1.72-0.771-1.72-1.72c0-0.949,0.77-1.719,1.72-1.719c0.948,0,1.719,0.771,1.719,1.719 C11.168,10.38,10.397,11.151,9.449,11.151z M22.004,22h-2.948v-4.616c0-1.101-0.02-2.517-1.533-2.517 c-1.535,0-1.771,1.199-1.771,2.437V22h-2.948v-9.492h2.83v1.297h0.04c0.394-0.746,1.356-1.533,2.791-1.533 c2.987,0,3.539,1.966,3.539,4.522V22z">
          </path>
        </svg>
      </a>
      <a target="_blank" rel="me noopener" class="social-link" href="https://stackoverflow.com/users/1745064/thiagowfx"
        title="StackOverflow profile">
        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em"
          xmlns="http://www.w3.org/2000/svg">
          <path
            d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z">
          </path>
        </svg>
      </a>
    </div>

    <div class="badge-wrapper">
      <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License">
        <img src="{{ "cc-by-nc-sa-4.0-88x31.webp" | absURL }}" width="88" height="31" alt="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License" />
      </a>
      <a target="_blank" href="https://indieweb.org/" title="IndieWebCamp">
        <img src="{{ "indieweb88x31-flat.webp" | absURL }}" width="88" height="31" alt="IndieWebCamp" />
      </a>
      <a target="_blank" href="https://512kb.club" title="512kb.club badge">
        <img src="{{ "green-team.webp" | absURL }}" width="88" height="31" alt="a proud member of the green team of 512KB club" />
      </a>
      <a target="_blank" href="https://powrss.com/" title="powRSS">
        <img src="{{ "powrss-88-31.webp" | absURL }}" width="88" height="31" alt="powRSS" />
      </a>
      <a target="_blank" href="https://www.vim.org/" title="Vim text editor">
        <img src="{{ "vim.webp" | absURL }}" width="88" height="31" alt="Vim text editor" />
      </a>
      <a target="_blank" href="https://edleeman.co.uk/cookie-zero/" title="Cookie Zero">
        <img src="{{ "cookiezero.webp" | absURL }}" width="88" height="31" alt="Cookie Zero" />
      </a>
      <a target="_blank" href="{{ printf "https://validator.w3.org/nu/?doc=%s" .Site.BaseURL }}" title="Valid HTML5">
        <img src="{{ "html5-validator-badge.webp" | absURL }}" width="88" height="31" alt="Valid HTML5" />
      </a>
      <a target="_blank" href="{{ printf "https://validator.w3.org/feed/check.cgi?url=%sindex.xml" .Site.BaseURL }}" title="Valid RSS feed">
        <img src="{{ "valid-rss-rogers.webp" | absURL }}" width="88" height="31" alt="Valid RSS feed" />
      </a>
    </div>

    <p class="footer-statement">
      This site respects your privacy by not containing <a href="https://www.nevermonetize.com/">ads</a>,
      not using tracking cookies,
      and not collecting any personally identifiable information.
      <a href="/ai">Gen AI policy</a>.
    </p>
  </footer>
  <script>
    function setTheme(theme) {
      if (theme === 'auto') {
        document.documentElement.removeAttribute('data-theme');
        localStorage.removeItem('theme');
      } else {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
      }
      updateThemeIcon();
    }

    function getCurrentThemeState() {
      return localStorage.getItem('theme') || 'auto';
    }

    function updateThemeIcon() {
      const state = getCurrentThemeState();
      const icons = { 'auto': 'üåì', 'dark': 'üåô', 'light': '‚òÄÔ∏è' };
      document.getElementById('theme-toggle-icon').textContent = icons[state];
    }

    // Initialize
    const saved = localStorage.getItem('theme');
    if (saved) {
      document.documentElement.setAttribute('data-theme', saved);
    }
    updateThemeIcon();

    // Toggle between auto, light, dark
    document.getElementById('theme-toggle').addEventListener('click', function () {
      const current = getCurrentThemeState();
      const cycle = { 'auto': 'light', 'light': 'dark', 'dark': 'auto' };
      const next = cycle[current];
      setTheme(next);
    });

    // Dropdown menu functionality
    const dropdownTriggers = document.querySelectorAll('.nav-dropdown-trigger');
    dropdownTriggers.forEach(trigger => {
      trigger.addEventListener('click', function(e) {
        e.preventDefault();
        const dropdown = this.closest('.nav-dropdown');
        const isOpen = dropdown.classList.contains('open');

        // Close all dropdowns
        document.querySelectorAll('.nav-dropdown.open').forEach(d => {
          d.classList.remove('open');
        });

        // Open clicked dropdown if it wasn't open
        if (!isOpen) {
          dropdown.classList.add('open');
        }
      });
    });

    // Language dropdown functionality
    const langToggle = document.getElementById('lang-toggle');
    if (langToggle) {
      langToggle.addEventListener('click', function(e) {
        e.preventDefault();
        const dropdown = this.closest('.lang-dropdown');
        const isOpen = dropdown.classList.contains('open');

        // Close all dropdowns
        document.querySelectorAll('.lang-dropdown.open').forEach(d => {
          d.classList.remove('open');
        });

        // Open clicked dropdown if it wasn't open
        if (!isOpen) {
          dropdown.classList.add('open');
        }
      });
    }

    // Close dropdown when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.nav-dropdown') && !e.target.closest('.lang-dropdown')) {
        document.querySelectorAll('.nav-dropdown.open').forEach(d => {
          d.classList.remove('open');
        });
        document.querySelectorAll('.lang-dropdown.open').forEach(d => {
          d.classList.remove('open');
        });
      }
    });

    document.addEventListener('click', function (event) {
      if (!event.target.matches('[data-copy-code]')) {
        return;
      }
      const button = event.target;
      const container = button.closest('.codeblock');
      if (!container) {
        return;
      }
      const code = container.querySelector('pre code');
      if (!code) {
        return;
      }
      const text = code.innerText;
      if (!navigator.clipboard || !navigator.clipboard.writeText) {
        return;
      }
      navigator.clipboard.writeText(text)
        .then(function () {
          button.dataset.originalLabel = button.textContent;
          button.textContent = 'Copied!';
          setTimeout(function () {
            button.textContent = button.dataset.originalLabel || 'Copy';
          }, 1500);
        })
        .catch(function () {
          button.textContent = 'Failed';
          setTimeout(function () {
            button.textContent = button.dataset.originalLabel || 'Copy';
          }, 1500);
        });
    });

    // Fullscreen mode functionality
    const fullscreenBtn = document.getElementById('fullscreen-btn');
    const fullscreenIcon = document.getElementById('fullscreen-icon');

    if (fullscreenBtn) {
      // Check for fullscreen parameter in URL or localStorage
      const urlParams = new URLSearchParams(window.location.search);
      const isFullscreenParam = urlParams.has('fullscreen');
      const isFullscreenLocal = localStorage.getItem('fullscreen-mode') === 'true';

      if (isFullscreenParam || isFullscreenLocal) {
        document.body.classList.add('fullscreen-mode');
        fullscreenIcon.textContent = '‚úï';
      }

      fullscreenBtn.addEventListener('click', function() {
        document.body.classList.toggle('fullscreen-mode');
        const isFullscreen = document.body.classList.contains('fullscreen-mode');
        fullscreenIcon.textContent = isFullscreen ? '‚úï' : '‚õ∂';
        localStorage.setItem('fullscreen-mode', isFullscreen);

        // Update URL with fullscreen parameter
        const url = new URL(window.location);
        if (isFullscreen) {
          url.searchParams.set('fullscreen', 'true');
        } else {
          url.searchParams.delete('fullscreen');
        }
        window.history.replaceState({}, '', url);
      });

      // Keyboard shortcut (f key)
      document.addEventListener('keydown', function(event) {
        if (event.key === 'f' && !event.ctrlKey && !event.metaKey && !event.altKey) {
          // Only trigger if not typing in an input or textarea
          if (!event.target.closest('input:not([type="hidden"]), textarea')) {
            event.preventDefault();
            fullscreenBtn.click();
          }
        }
      });
    }
  </script>
</body>

</html>

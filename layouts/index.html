{{- define "main" }}
{{ .Content }}

{{- $bestof := where .Site.RegularPages "Params.tags" "intersect" (slice "bestof") }}
{{- $bestof = $bestof | first (default 4 .Site.Params.featuredPostsLimit) }}
{{- if $bestof }}
<div class="featured-posts">
  <section class="featured-grid">
    <h2>★ Featured Posts</h2>
    {{- range $bestof }}
    <article class="featured-card">
      <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
      {{- with .Summary }}
      <p>{{ . | plainify | truncate 120 }}</p>
      {{- end }}
      <small>{{ .Date.Format "Jan 02, 2006" }}</small>
    </article>
    {{- end }}
  </section>
  <p style="text-align: right;"><a href='{{ "tags/bestof/" | relURL }}'>{{ i18n "allPosts" | default "All posts" }} →</a></p>
</div>
{{- end }}
{{- end }}

<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet type="text/xsl" href="https://perrotta.dev//rss.xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>¬¨ just serendipity üçÄ</title><link>https://perrotta.dev/posts/</link><description>Recent content on ¬¨ just serendipity üçÄ</description><generator>Hugo</generator><language>en-us</language><managingEditor>serendipity@perrotta.dev (Thiago Perrotta)</managingEditor><webMaster>serendipity@perrotta.dev (Thiago Perrotta)</webMaster><copyright>¬© 2021 - 2025 Thiago Perrotta ¬∑
[some rights reserved](https://creativecommons.org/licenses/by-nc-sa/4.0/) ¬∑
a fork of [hugo  ï‚Ä¢·¥•‚Ä¢ î bear](https://github.com/janraasch/hugo-bearblog/)</copyright><lastBuildDate>Mon, 17 Nov 2025 12:04:26 -0300</lastBuildDate><atom:link href="https://perrotta.dev/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>terraform: update outputs only</title><link>https://perrotta.dev/2025/11/terraform-update-outputs-only/</link><pubDate>Mon, 17 Nov 2025 12:04:26 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/terraform-update-outputs-only/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: Given a Terraform project full of pending changes
(&lt;code>terraform plan&lt;/code>), update its
&lt;a href="https://developer.hashicorp.com/terraform/cli/commands/output">outputs&lt;/a> only.&lt;/p>
&lt;p>I would expect to be able to use &lt;code>-target&lt;/code> to do so, but that&amp;rsquo;s not possible.
This flag is intended for resources only.&lt;/p>
&lt;p>The &lt;a href="https://devops.stackexchange.com/questions/14286/terraform-apply-output-only">correct
approach&lt;/a>
is &lt;code>terraform apply -refresh-only&lt;/code>:&lt;/p>
&lt;blockquote>
&lt;p>Running terraform apply -refresh-only should take care of any new outputs. It
will read the latest data from each resource and then update all of the
outputs in terms of those updates, which includes re-evaluating your output
expressions to incorporate any changes.&lt;/p>
&lt;/blockquote>
&lt;p>I tested this and it indeed works as expected.&lt;/p>
&lt;p>The next action from here would be to run &lt;code>terraform apply&lt;/code> for select &lt;code>-target&lt;/code>
resources, a few at a time, until drift is completely eliminated.&lt;/p></description></item><item><title>new pre-commit hook: check-bash-shebang</title><link>https://perrotta.dev/2025/11/new-pre-commit-hook-check-bash-shebang/</link><pubDate>Sun, 16 Nov 2025 20:48:17 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/new-pre-commit-hook-check-bash-shebang/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/11/bash-shebang-/">Previously&lt;/a>.&lt;/p>
&lt;p>I couldn&amp;rsquo;t resist creating a &lt;a href="https://pre-commit.com/">pre-commit hook&lt;/a> for
this:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">repos&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e06c75">repo&lt;/span>: https://github.com/thiagowfx/pre-commit-hooks/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">rev&lt;/span>: v0.0.11
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">hooks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e06c75">id&lt;/span>: check-bash-shebang
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">types&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - shell
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>In action:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% &lt;span style="color:#e5c07b">cd&lt;/span> &lt;span style="color:#56b6c2">{&lt;/span>pancake&lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% pre-commit run -a check-bash-shebang
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Check bash scripts use portable shebang..................................Failed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- hook id: check-bash-shebang
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#e5c07b">exit&lt;/span> code: &lt;span style="color:#d19a66">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>error: &lt;span style="color:#98c379">&amp;#39;aws_china_mfa/aws_china_mfa.sh&amp;#39;&lt;/span> uses &lt;span style="color:#98c379">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> instead of &lt;span style="color:#98c379">&amp;#39;#!/usr/bin/env bash&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>error: &lt;span style="color:#98c379">&amp;#39;aws_login_headless/aws_login_headless.sh&amp;#39;&lt;/span> uses &lt;span style="color:#98c379">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> instead of &lt;span style="color:#98c379">&amp;#39;#!/usr/bin/env bash&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>error: &lt;span style="color:#98c379">&amp;#39;pritunl_login/pritunl_login.sh&amp;#39;&lt;/span> uses &lt;span style="color:#98c379">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> instead of &lt;span style="color:#98c379">&amp;#39;#!/usr/bin/env bash&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>error: &lt;span style="color:#98c379">&amp;#39;sd_world/sd_world.sh&amp;#39;&lt;/span> uses &lt;span style="color:#98c379">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> instead of &lt;span style="color:#98c379">&amp;#39;#!/usr/bin/env bash&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>error: &lt;span style="color:#98c379">&amp;#39;pdf_password_remove/pdf_password_remove.sh&amp;#39;&lt;/span> uses &lt;span style="color:#98c379">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> instead of &lt;span style="color:#98c379">&amp;#39;#!/usr/bin/env bash&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>error: &lt;span style="color:#98c379">&amp;#39;img_optimize/img_optimize.sh&amp;#39;&lt;/span> uses &lt;span style="color:#98c379">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> instead of &lt;span style="color:#98c379">&amp;#39;#!/usr/bin/env bash&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>error: &lt;span style="color:#98c379">&amp;#39;copy/copy.sh&amp;#39;&lt;/span> uses &lt;span style="color:#98c379">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> instead of &lt;span style="color:#98c379">&amp;#39;#!/usr/bin/env bash&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>error: &lt;span style="color:#98c379">&amp;#39;ssh_mux_restart/ssh_mux_restart.sh&amp;#39;&lt;/span> uses &lt;span style="color:#98c379">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> instead of &lt;span style="color:#98c379">&amp;#39;#!/usr/bin/env bash&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>error: &lt;span style="color:#98c379">&amp;#39;op_login_all/op_login_all.sh&amp;#39;&lt;/span> uses &lt;span style="color:#98c379">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> instead of &lt;span style="color:#98c379">&amp;#39;#!/usr/bin/env bash&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>new script: PDF remove password</title><link>https://perrotta.dev/2025/11/new-script-pdf-remove-password/</link><pubDate>Sun, 16 Nov 2025 20:19:18 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/new-script-pdf-remove-password/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/11/new-script-copy/">Previously&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Problem statement&lt;/strong>: Given a password-protected &lt;code>.pdf&lt;/code> file, remove its
password. It&amp;rsquo;s indifferent whether the file gets overwritten or whether a new
one is created.&lt;/p>
&lt;p>&lt;a href="https://gist.github.com/pstaender/7412245">&lt;code>ghostscript&lt;/code>&lt;/a> can do it:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>gs -q -dNOPAUSE -dBATCH -sDEVICE&lt;span style="color:#56b6c2">=&lt;/span>pdfwrite -sOutputFile&lt;span style="color:#56b6c2">=&lt;/span>output.pdf -c .setpdfwrite -f input.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://gist.github.com/raghur/f3eab7297691f2f411eec69b8032daf0">&lt;code>qpdf&lt;/code>&lt;/a> can do it:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>qpdf --decrypt --password&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;{my pass}&amp;#34;&lt;/span> input.pdf output.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>I am not expected to memorize these CLI flags.&lt;/p>
&lt;p>I do not want to look them up every time either.&lt;/p>
&lt;p>There are various approaches to tackle this:&lt;/p>
&lt;ul>
&lt;li>a shell alias (&lt;code>alias foo=&lt;/code>)&lt;/li>
&lt;li>a shell function &lt;code>foo() {}&lt;/code>&lt;/li>
&lt;li>a shell script (&lt;code>*.sh&lt;/code>)&lt;/li>
&lt;li>a &lt;a href="https://perrotta.dev/2025/10/comma-scripts/">comma script&lt;/a>&lt;/li>
&lt;li>a copyable snippet (e.g. stored in Obsidian / LogSeq or some other digital
garden / personal wiki / second brain app)&lt;/li>
&lt;li>a snippet (e.g. in &lt;a href="https://perrotta.dev/2025/10/comma-scripts/">RayCast&lt;/a> or
&lt;a href="https://perrotta.dev/2025/10/comma-scripts/">Espanso&lt;/a>)&lt;/li>
&lt;li>ask the AI each time&lt;/li>
&lt;li>&lt;del>google&lt;/del> &lt;a href="https://perrotta.dev/2025/05/kagi/">search&lt;/a> for it each time&lt;/li>
&lt;/ul>
&lt;p>Lately I&amp;rsquo;ve been favouring the &lt;a href="https://perrotta.dev/2025/09/pancake-potpourri-scripts/">shell script&lt;/a> approach, so &lt;a href="https://github.com/thiagowfx/pancake/tree/c7c3677119c567edc432fcc1f1c0f78c9a5b3c55/pdf_password_remove">here we go&lt;/a> with &lt;code>pdf_password_remove.sh&lt;/code>:&lt;/p>
&lt;h2 id="usage">Usage&lt;/h2>
&lt;p>Remove password protection from PDF files.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Interactive password prompt (most secure)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf_password_remove secret.pdf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Process multiple files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf_password_remove report.pdf invoice.pdf contract.pdf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Provide password via command line&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf_password_remove --password&lt;span style="color:#56b6c2">=&lt;/span>BANANA42SPLIT secret.pdf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Custom output filename (single file only)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf_password_remove -o unlocked.pdf secret.pdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="example-output">Example Output&lt;/h2>
&lt;pre tabindex="0">&lt;code>% pdf_password_remove --password=PIZZA69SLICE financial-report.pdf tax-form.pdf
‚úì Successfully processed: financial-report.pdf ‚Üí financial-report-unlocked.pdf
‚úì Successfully processed: tax-form.pdf ‚Üí tax-form-unlocked.pdf

Summary: Successfully processed 2/2 file(s)
&lt;/code>&lt;/pre>&lt;h2 id="features">Features&lt;/h2>
&lt;ul>
&lt;li>Process single or multiple PDF files in one command&lt;/li>
&lt;li>Secure interactive password prompt (hidden input)&lt;/li>
&lt;li>Command-line password option for automation/scripts&lt;/li>
&lt;li>Default output naming: adds &lt;code>-unlocked&lt;/code> suffix&lt;/li>
&lt;li>Custom output filename with &lt;code>-o&lt;/code> flag (single file only)&lt;/li>
&lt;li>Clear success/failure indicators for each file&lt;/li>
&lt;li>Validates PDF files before processing&lt;/li>
&lt;/ul>
&lt;h2 id="prerequisites">Prerequisites&lt;/h2>
&lt;p>Requires either &lt;code>ghostscript&lt;/code> (preferred) or &lt;code>qpdf&lt;/code> to be installed:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># macOS&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>brew install ghostscript &lt;span style="color:#7f848e"># Preferred&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>brew install qpdf &lt;span style="color:#7f848e"># Alternative&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Linux&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt install ghostscript &lt;span style="color:#7f848e"># Preferred - Debian/Ubuntu&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt install qpdf &lt;span style="color:#7f848e"># Alternative&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo dnf install ghostscript &lt;span style="color:#7f848e"># Preferred - Fedora&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo dnf install qpdf &lt;span style="color:#7f848e"># Alternative&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo pacman -S ghostscript &lt;span style="color:#7f848e"># Preferred - Arch&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo pacman -S qpdf &lt;span style="color:#7f848e"># Alternative&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The script automatically detects and uses whichever tool is available,
preferring ghostscript if both are installed.&lt;/p>
&lt;h2 id="security-note">Security Note&lt;/h2>
&lt;p>Using &lt;code>--password&lt;/code> on the command line will expose the password in shell history
and process lists. For sensitive documents, use the interactive prompt instead
(default behavior when password is not provided).&lt;/p></description></item><item><title>bash shebang #!</title><link>https://perrotta.dev/2025/11/bash-shebang-/</link><pubDate>Sun, 16 Nov 2025 20:01:04 -0300</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/bash-shebang-/</guid><description>&lt;p>When writing portable shell scripts, should we prefer &lt;code>#!/bin/bash&lt;/code> or
&lt;code>#!/usr/bin/env bash&lt;/code>?&lt;/p>
&lt;p>I tend to write &lt;code>#!/bin/bash&lt;/code> by hand, but here is an argument to prefer the
&lt;code>env&lt;/code> version instead:&lt;/p>
&lt;pre tabindex="0">&lt;code>thiago.perrotta@thiagoperrotta-MacBook-Pro ~
% /bin/bash --version
GNU bash, version 3.2.57(1)-release (arm64-apple-darwin24)
Copyright (C) 2007 Free Software Foundation, Inc.
thiago.perrotta@thiagoperrotta-MacBook-Pro ~

% /usr/bin/env bash --version
GNU bash, version 5.3.3(1)-release (aarch64-apple-darwin24.4.0)
Copyright (C) 2025 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &amp;lt;http://gnu.org/licenses/gpl.html&amp;gt;

This is free software; you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
&lt;/code>&lt;/pre>&lt;p>&amp;hellip;&lt;code>/bin/bash&lt;/code> on macOS is forever stuck on &lt;code>3.2.57&lt;/code>.&lt;/p>
&lt;p>Others &lt;a href="https://unix.stackexchange.com/a/792243/41858">appear&lt;/a> to agree.&lt;/p></description></item><item><title>Shell memoization: lazy-load LLM API keys</title><link>https://perrotta.dev/2025/11/shell-memoization-lazy-load-llm-api-keys/</link><pubDate>Mon, 10 Nov 2025 13:55:56 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/shell-memoization-lazy-load-llm-api-keys/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: Given LLM keys shell environment variables:&lt;/p>
&lt;ul>
&lt;li>&lt;code>ANTHROPIC_API_KEY&lt;/code>&lt;/li>
&lt;li>&lt;code>GEMINI_API_KEY&lt;/code>&lt;/li>
&lt;li>&lt;code>OPENAI_API_KEY&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Export them only when they are needed.&lt;/p>
&lt;p>When are they needed? If I launch any one of these binaries:&lt;/p>
&lt;ul>
&lt;li>&lt;code>llm&lt;/code> (generic)&lt;/li>
&lt;li>&lt;code>aider&lt;/code> (generic)&lt;/li>
&lt;li>&lt;code>gemini&lt;/code> (provider-specific: Google)&lt;/li>
&lt;li>&lt;code>codex&lt;/code> (provider-specific: OpenAI)&lt;/li>
&lt;li>&lt;code>claude&lt;/code> (provider-specific: Anthropic)&lt;/li>
&lt;/ul>
&lt;p>I added the following snippet in my shell profile:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Lazy-load API keys only when needed to avoid shell startup delay&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">if&lt;/span> &lt;span style="color:#e5c07b">command&lt;/span> -v llm &amp;amp;&amp;gt;/dev/null; &lt;span style="color:#c678dd">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _load_api_keys&lt;span style="color:#56b6c2">()&lt;/span> &lt;span style="color:#56b6c2">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e5c07b">export&lt;/span> &lt;span style="color:#e06c75">ANTHROPIC_API_KEY&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;&lt;/span>&lt;span style="color:#c678dd">$(&lt;/span>&lt;span style="color:#e5c07b">command&lt;/span> llm keys get anthropic&lt;span style="color:#c678dd">)&lt;/span>&lt;span style="color:#98c379">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e5c07b">export&lt;/span> &lt;span style="color:#e06c75">GEMINI_API_KEY&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;&lt;/span>&lt;span style="color:#c678dd">$(&lt;/span>&lt;span style="color:#e5c07b">command&lt;/span> llm keys get gemini&lt;span style="color:#c678dd">)&lt;/span>&lt;span style="color:#98c379">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e5c07b">export&lt;/span> &lt;span style="color:#e06c75">OPENAI_API_KEY&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;&lt;/span>&lt;span style="color:#c678dd">$(&lt;/span>&lt;span style="color:#e5c07b">command&lt;/span> llm keys get openai&lt;span style="color:#c678dd">)&lt;/span>&lt;span style="color:#98c379">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># Redefine itself to be a no-op after first call&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _load_api_keys&lt;span style="color:#56b6c2">()&lt;/span> &lt;span style="color:#56b6c2">{&lt;/span> :; &lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># Wrap all AI CLI commands to auto-load keys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">for&lt;/span> cmd in claude llm aider codex gemini; &lt;span style="color:#c678dd">do&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e5c07b">command&lt;/span> -v &lt;span style="color:#e06c75">$cmd&lt;/span> &amp;amp;&amp;gt;/dev/null &lt;span style="color:#56b6c2">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#e5c07b">eval&lt;/span> &lt;span style="color:#98c379">&amp;#34;&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#e06c75">cmd&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">() { _load_api_keys; command &lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#e06c75">cmd&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379"> \&amp;#34;\$@\&amp;#34;; }&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">done&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The keys are loaded via &lt;code>llm keys get&lt;/code>. This is not secure, but it is practical.
A more secure approach would be to read the credentials directly from a password
manager. This trade-off is acceptable in the environment I am currently
operating on, but I would not recommend it as an universal approach.&lt;/p>
&lt;p>A temporary &lt;code>_load_api_keys&lt;/code> shell function is defined. The first time it is
executed, it &lt;code>export&lt;/code>s each one of the LLM API keys. From the second time
onwards it will be a no-op, thanks to &lt;code>:&lt;/code>. In bash/zsh we can redefine a
function from within itself thanks to dynamic scoping. Wild.&lt;/p>
&lt;p>Last but not least: I wrapped up (&amp;ldquo;decorated&amp;rdquo; in function parlance) all
LLM-related commands with a shell function that runs &lt;code>_load_api_keys&lt;/code> before
invoking the original command.&lt;/p>
&lt;p>This approach is elegant and easy to maintain.&lt;/p>
&lt;p>My initial implementation had been more fine-grained: &lt;code>ANTHROPIC_API_KEY&lt;/code> would
drive &lt;code>claude&lt;/code>, &lt;code>llm&lt;/code> and &lt;code>aider&lt;/code>, but not &lt;code>gemini&lt;/code> and &lt;code>codex&lt;/code>, and so on.
Ultimately I decided that the additional complexity of mapping individual
providers optimally is not warranted.&lt;/p>
&lt;p>Why is this memoization necessary in the first place?&lt;/p>
&lt;p>My shell (&lt;code>zsh&lt;/code>) startup was significantly slow before this change,
&lt;code>O(seconds)&lt;/code>. Each call to &lt;code>llm keys get&lt;/code> takes about half a second in my
machine. I do not think it&amp;rsquo;s acceptable to wait for 2s before having your shell
readily available with a prompt.&lt;/p>
&lt;p>Before this approach, I had used
&lt;a href="https://github.com/romkatv/zsh-defer">&lt;code>zsh-defer&lt;/code>&lt;/a> to delay populating the API
keys. However, this has only &lt;em>deferred&lt;/em> (&lt;em>cof&lt;/em>) my problems. The startup delay
was still noticeable.&lt;/p></description></item><item><title>Money</title><link>https://perrotta.dev/2025/11/money/</link><pubDate>Mon, 10 Nov 2025 12:51:46 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/money/</guid><description>&lt;p>In English-speaking North America (Canada, USA) we refer to currency in the
following ways:&lt;/p>
&lt;ul>
&lt;li>$50&lt;/li>
&lt;li>fifty dollars&lt;/li>
&lt;li>50 CAD, 50 USD ‚Äì when necessary to disambiguate between Canadian and US
dollars&lt;/li>
&lt;li>$50 CAD, $50 USD also works, but it&amp;rsquo;s less common&lt;/li>
&lt;/ul>
&lt;p>A format that is non-existent: 50$. It feels wrong to place the dollar sign
after the dollar amount.&lt;/p>
&lt;p>Now let&amp;rsquo;s switch to Europe&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>:&lt;/p>
&lt;ul>
&lt;li>50‚Ç¨&lt;/li>
&lt;li>fifty euros&lt;/li>
&lt;li>fifty euro (!!)&lt;/li>
&lt;li>50 EUR&lt;/li>
&lt;/ul>
&lt;p>Uncommon: ‚Ç¨50.&lt;/p>
&lt;p>Some of these differences are annoying:&lt;/p>
&lt;ul>
&lt;li>Saying &amp;ldquo;fifty euro&amp;rdquo; feels utterly wrong (euro is countable!) but it is very
commonplace, especially in Germany.&lt;/li>
&lt;li>When switching back-and-forth between dollars and euros and using the symbol
notation, one needs to update prefixing/postfixing the symbol accordingly.&lt;/li>
&lt;/ul>
&lt;p>There&amp;rsquo;s also the fact that in North America we use a dot (.) to separate cents
(&lt;code>$50.42&lt;/code>) whereas in Europe we use a comma (,): &lt;code>50,33‚Ç¨&lt;/code>.&lt;/p>
&lt;p>It is common to see &lt;code>50‚Ç¨,-&lt;/code> to denote &amp;ldquo;exactly fifty euros&amp;rdquo; i.e. &lt;code>50,00‚Ç¨&lt;/code>. That
convention does not exist in North America. You&amp;rsquo;ll often see &lt;code>$49,99&lt;/code> or
&lt;code>$49,90&lt;/code> instead of &lt;code>$50&lt;/code>. I have never seen &lt;code>$50.-&lt;/code>.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Europe, EU, &lt;a href="https://en.wikipedia.org/wiki/European_Economic_Area">EEA&lt;/a>,
Schengen, whatever.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Banana</title><link>https://perrotta.dev/2025/11/banana/</link><pubDate>Sun, 09 Nov 2025 13:32:36 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/banana/</guid><description>&lt;p>You write a long document.&lt;/p>
&lt;p>Perhaps it&amp;rsquo;s an ad, or a legal contract, or a design document.&lt;/p>
&lt;p>&lt;strong>Problem statement&lt;/strong>: You would like to ensure, to a certain extent, that your
audience has fully read it&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.&lt;/p>
&lt;p>I like the following trick&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>: insert the following paragraph somewhere in the
middle of the document:&lt;/p>
&lt;blockquote>
&lt;p>If you are reading this, mention the keyword &amp;ldquo;banana&amp;rdquo; to me so that I know.&lt;/p>
&lt;/blockquote>
&lt;p>It is not foolproof but, in my experience, it&amp;rsquo;s a decent heuristic to filter out
noise ‚Äì those who are totally clueless and didn&amp;rsquo;t even bother to take a quick
glance.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Or, at the very least, skimmed it.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>Which, I am aware, becomes less useful if it is documented. We should
never fully rely on &lt;a href="https://en.wikipedia.org/wiki/Security_through_obscurity">security through
obscurity&lt;/a> anyway.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>You are absolutely right!</title><link>https://perrotta.dev/2025/11/you-are-absolutely-right/</link><pubDate>Wed, 05 Nov 2025 14:44:06 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/you-are-absolutely-right/</guid><description>&lt;p>The title is &lt;a href="https://www.claude.com/product/claude-code">Claude Code&lt;/a>&amp;rsquo;s
favorite compliment to me.&lt;/p>
&lt;p>I&amp;rsquo;ve been slowly incorporating Claude Code as part of my daily workflow, as you
can see below:&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>Date&lt;/th>
 &lt;th>Input&lt;/th>
 &lt;th>Output&lt;/th>
 &lt;th>Total Tokens&lt;/th>
 &lt;th>Cost (USD)&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>2025-10-06&lt;/td>
 &lt;td>336&lt;/td>
 &lt;td>3,439&lt;/td>
 &lt;td>1,968,081&lt;/td>
 &lt;td>$1.33&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-07&lt;/td>
 &lt;td>18,391&lt;/td>
 &lt;td>28,591&lt;/td>
 &lt;td>7,748,856&lt;/td>
 &lt;td>$5.32&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-08&lt;/td>
 &lt;td>5,319&lt;/td>
 &lt;td>9,137&lt;/td>
 &lt;td>13,575,138&lt;/td>
 &lt;td>$9.74&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-09&lt;/td>
 &lt;td>5,207&lt;/td>
 &lt;td>1,512&lt;/td>
 &lt;td>5,522,025&lt;/td>
 &lt;td>$4.18&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-10&lt;/td>
 &lt;td>8,565&lt;/td>
 &lt;td>2,449&lt;/td>
 &lt;td>7,000,875&lt;/td>
 &lt;td>$5.52&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-12&lt;/td>
 &lt;td>2,390&lt;/td>
 &lt;td>175&lt;/td>
 &lt;td>1,450,539&lt;/td>
 &lt;td>$1.13&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-13&lt;/td>
 &lt;td>7,447&lt;/td>
 &lt;td>4,937&lt;/td>
 &lt;td>17,629,366&lt;/td>
 &lt;td>$9.99&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-14&lt;/td>
 &lt;td>2,115&lt;/td>
 &lt;td>1,018&lt;/td>
 &lt;td>4,170,741&lt;/td>
 &lt;td>$2.39&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-15&lt;/td>
 &lt;td>458&lt;/td>
 &lt;td>198&lt;/td>
 &lt;td>484,589&lt;/td>
 &lt;td>$0.58&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-16&lt;/td>
 &lt;td>4,570&lt;/td>
 &lt;td>3,211&lt;/td>
 &lt;td>1,322,015&lt;/td>
 &lt;td>$1.94&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-17&lt;/td>
 &lt;td>5,753&lt;/td>
 &lt;td>13,288&lt;/td>
 &lt;td>1,778,481&lt;/td>
 &lt;td>$2.30&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-19&lt;/td>
 &lt;td>45&lt;/td>
 &lt;td>5,600&lt;/td>
 &lt;td>1,036,115&lt;/td>
 &lt;td>$0.70&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-20&lt;/td>
 &lt;td>21,007&lt;/td>
 &lt;td>19,636&lt;/td>
 &lt;td>14,458,857&lt;/td>
 &lt;td>$9.37&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-21&lt;/td>
 &lt;td>3,239&lt;/td>
 &lt;td>2,722&lt;/td>
 &lt;td>1,133,067&lt;/td>
 &lt;td>$1.06&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-22&lt;/td>
 &lt;td>32,897&lt;/td>
 &lt;td>18,675&lt;/td>
 &lt;td>18,876,244&lt;/td>
 &lt;td>$10.99&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-23&lt;/td>
 &lt;td>25,091&lt;/td>
 &lt;td>7,231&lt;/td>
 &lt;td>16,357,484&lt;/td>
 &lt;td>$9.67&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-24&lt;/td>
 &lt;td>8,827&lt;/td>
 &lt;td>14,262&lt;/td>
 &lt;td>5,044,059&lt;/td>
 &lt;td>$3.46&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-25&lt;/td>
 &lt;td>4,763&lt;/td>
 &lt;td>3,051&lt;/td>
 &lt;td>3,353,850&lt;/td>
 &lt;td>$2.07&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-27&lt;/td>
 &lt;td>5,997&lt;/td>
 &lt;td>6,753&lt;/td>
 &lt;td>3,998,722&lt;/td>
 &lt;td>$2.88&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-28&lt;/td>
 &lt;td>9,406&lt;/td>
 &lt;td>9,996&lt;/td>
 &lt;td>9,769,754&lt;/td>
 &lt;td>$7.04&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-29&lt;/td>
 &lt;td>28,251&lt;/td>
 &lt;td>20,866&lt;/td>
 &lt;td>11,953,692&lt;/td>
 &lt;td>$8.90&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-10-30&lt;/td>
 &lt;td>69,758&lt;/td>
 &lt;td>27,302&lt;/td>
 &lt;td>16,342,978&lt;/td>
 &lt;td>$10.42&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-11-04&lt;/td>
 &lt;td>68,720&lt;/td>
 &lt;td>59,116&lt;/td>
 &lt;td>56,510,198&lt;/td>
 &lt;td>$31.01&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>2025-11-05&lt;/td>
 &lt;td>20,500&lt;/td>
 &lt;td>13,695&lt;/td>
 &lt;td>17,940,085&lt;/td>
 &lt;td>$10.87&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>Total&lt;/strong>&lt;/td>
 &lt;td>&lt;strong>359,052&lt;/strong>&lt;/td>
 &lt;td>&lt;strong>276,860&lt;/strong>&lt;/td>
 &lt;td>&lt;strong>239,425,811&lt;/strong>&lt;/td>
 &lt;td>&lt;strong>$152.84&lt;/strong>&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>&lt;a href="https://perrotta.dev/2025/09/claude-ccusage/">Previously&lt;/a>.&lt;/p>
&lt;p>Spending $10 USD a day is becoming commonplace.&lt;/p>
&lt;p>I could continue this post with generic AI advice&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>, but I am too tired of reading
about it myself.&lt;/p>
&lt;p>The hype is still overblown and exhausting, and it doesn&amp;rsquo;t seem like it will
fade out anytime soon (if ever). Nonetheless, opportunistic use of the
technology, whilst (still) staying reasonably distant&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup> from it, does not
hurt&lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Do you know what would be &lt;em>actually&lt;/em> useful? Tax advice on how to deduct
software expenses related to AI. Why is no one talking about this?!&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>In other words: &lt;em>without&lt;/em> getting addicted to it / heavily dependent on
it.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:3">
&lt;p>Technically and pedantically speaking it does hurt the planet though :/&amp;#160;&lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>md-toc: markdown table of contents</title><link>https://perrotta.dev/2025/11/md-toc-markdown-table-of-contents/</link><pubDate>Wed, 05 Nov 2025 13:32:21 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/md-toc-markdown-table-of-contents/</guid><description>&lt;p>&lt;a href="https://github.com/frnmst/md-toc">https://github.com/frnmst/md-toc&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>Automatically generate and add an accurate table of contents to markdown files.&lt;/p>
&lt;/blockquote>
&lt;p>Adopting it via &lt;a href="https://pre-commit.com">pre-commit&lt;/a> in a git repository is very
straightforward:&lt;/p>
&lt;p>&lt;code>.pre-commit-config.yaml&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">repos&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e06c75">repo&lt;/span>: https://github.com/frnmst/md-toc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">rev: 4a8b796dbde00f71eb1a51b075462f825f872c34 # frozen&lt;/span>: &lt;span style="color:#d19a66">9.0.0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">hooks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e06c75">id&lt;/span>: md-toc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Next, update &lt;code>README.md&lt;/code> to include &lt;code>&amp;lt;!--TOC--&amp;gt;&lt;/code> where the table of contents
should be inserted.&lt;/p>
&lt;p>Run &lt;code>pre-commit run -a md-toc&lt;/code> once to generate and preview the results:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-markdown" data-lang="markdown">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e">&amp;lt;!--TOC--&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">-&lt;/span> [&lt;span style="color:#e06c75">GitOps Pipeline for Terraform&lt;/span>](&lt;span style="color:#e06c75">#gitops-pipeline-for-terraform&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">-&lt;/span> [&lt;span style="color:#e06c75">CI status&lt;/span>](&lt;span style="color:#e06c75">#ci-status&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">-&lt;/span> [&lt;span style="color:#e06c75">Key Objectives&lt;/span>](&lt;span style="color:#e06c75">#key-objectives&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">-&lt;/span> [&lt;span style="color:#e06c75">The Workflow&lt;/span>](&lt;span style="color:#e06c75">#the-workflow&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">-&lt;/span> [&lt;span style="color:#e06c75">Core Features&lt;/span>](&lt;span style="color:#e06c75">#core-features&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e">&amp;lt;!--TOC--&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Record Club</title><link>https://perrotta.dev/2025/11/record-club/</link><pubDate>Wed, 05 Nov 2025 11:30:05 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/record-club/</guid><description>&lt;p>&lt;a href="https://record.club">Record Club&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>A {new,fun,better} way to discover and share music with friends.&lt;/p>
&lt;p>Record Club is a social music network that makes it easy to track, rate,
review and compile lists of your favorite releases with a community of other
music fans.&lt;/p>
&lt;/blockquote>
&lt;p>I stumbled upon Record Club last week via a blog that I follow&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>. It is a
blend of last.fm, goodreads and (old) twitter.&lt;/p>
&lt;p>So far I am really enjoying it! It is a great way to discover new indie&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>
albums and artists.&lt;/p>
&lt;p>Then you&amp;rsquo;ll ask: what&amp;rsquo;s wrong with Spotify or YouTube recommendations? Don&amp;rsquo;t
they have a great algorithm, supposedly tailored to your great musical taste?&lt;/p>
&lt;p>I&amp;rsquo;ll leave the answer up to you, but the issue to me is that they trap you in a
bubble. It is difficult to discover non-mainstream records in these platforms.&lt;/p>
&lt;p>Browsing Record Club feels local, personal, and intimate.&lt;/p>
&lt;p>Give it a try :)&lt;/p>
&lt;p>If you end up discovering interesting song tracks, artists or albums there, feel
free to share them with me.&lt;/p>
&lt;p>Not sure if I will maintain an active (or public) account there though.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Unfortunately I can no longer remember which one :/&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>&amp;ldquo;Less popular&amp;rdquo;&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>new script: copy</title><link>https://perrotta.dev/2025/11/new-script-copy/</link><pubDate>Tue, 04 Nov 2025 14:05:47 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/new-script-copy/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/10/new-script-ssh-mux-restart/">Previously&lt;/a>.&lt;/p>
&lt;p>I decided to add a new &lt;code>copy&lt;/code> script to
&lt;a href="https://github.com/thiagowfx/pancake">&lt;code>pancake&lt;/code>&lt;/a> to standardize copying command
output and files to the system clipboard in both macOS and Linux.&lt;/p>
&lt;p>The idea was originally inspired by &lt;a href="https://evanhahn.com/scripts-i-wrote-that-i-use-all-the-time/">Evan
Hahn&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>&lt;code>copy&lt;/code> and &lt;code>pasta&lt;/code> are simple wrappers around system clipboard managers, like
&lt;code>pbcopy&lt;/code> on macOS and &lt;code>xclip&lt;/code> on Linux. I use these all the time.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://codeberg.org/EvanHahn/dotfiles/src/commit/843b9ee13d949d346a4a73ccee2a99351aed285b/home/bin/bin/copy">Evan&amp;rsquo;s version&lt;/a> is concise and elegant.&lt;/p>
&lt;p>&lt;a href="https://github.com/thiagowfx/pancake/blob/457441b3bc790068ff2618125da08de0effab016/copy/copy.sh">My version&lt;/a> is more verbose, for the sake of consistency with the rest of my scripts in pancake.&lt;/p>
&lt;h2 id="usage">Usage&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Copy from stdin&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e5c07b">echo&lt;/span> &lt;span style="color:#98c379">&amp;#34;BANANA42SPLIT88SUNDAE99CHERRY&amp;#34;&lt;/span> | copy
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Copy a file&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>copy notes.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Copy multiple files&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>copy *.md
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="platform-support">Platform Support&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>macOS&lt;/strong>: Uses &lt;code>pbcopy&lt;/code> (built-in)&lt;/li>
&lt;li>&lt;strong>Linux&lt;/strong>: Auto-detects first available tool:
&lt;ul>
&lt;li>&lt;code>wl-copy&lt;/code> (Wayland) - prioritized for modern desktops&lt;/li>
&lt;li>&lt;code>xclip&lt;/code> (X11)&lt;/li>
&lt;li>&lt;code>xsel&lt;/code> (X11)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="features">Features&lt;/h2>
&lt;ul>
&lt;li>Silent on success (Unix philosophy)&lt;/li>
&lt;li>Supports stdin input&lt;/li>
&lt;li>Supports single or multiple files&lt;/li>
&lt;li>Multiple files are concatenated with newline separators&lt;/li>
&lt;li>Clear error messages for missing files or dependencies&lt;/li>
&lt;/ul></description></item><item><title>git diff interactively</title><link>https://perrotta.dev/2025/11/git-diff-interactively/</link><pubDate>Tue, 04 Nov 2025 11:21:24 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/git-diff-interactively/</guid><description>&lt;p>It&amp;rsquo;s possible to do &lt;code>git patch -p&lt;/code> to review diff hunks interactively, one by
one.&lt;/p>
&lt;p>Can we accomplish something similar with &lt;code>git diff&lt;/code>? If not, is there a tool
that can accomplish that, in the same spirit of &lt;code>git patch -p&lt;/code>, but with a
read-only-centric workflow?&lt;/p>
&lt;p>The na√Øve approach is to simply run &lt;code>git patch -p&lt;/code> and then press &amp;rsquo;n&amp;rsquo; (no) for
each diff hunk. It does not feel particularly effective though.&lt;/p>
&lt;p>I found another way, which embodies the spirit of &lt;code>git patch -p&lt;/code> more
effectively: &lt;a href="https://jonas.github.io/tig/">&lt;code>tig status&lt;/code>&lt;/a>.&lt;/p>
&lt;p>I already use &lt;code>tig&lt;/code> every once in a while but wasn&amp;rsquo;t aware that it could do that.&lt;/p>
&lt;p>I won&amp;rsquo;t try to illustrate the command output here (it&amp;rsquo;s a TUI); simply give it a
try the next time you run &lt;code>git diff&lt;/code> or &lt;code>git add&lt;/code>.&lt;/p>
&lt;p>It&amp;rsquo;s also possible to stage per file and per hunk changes in the TUI. This
operation mode somewhats resemble
&lt;a href="https://github.com/andrewshadura/git-crecord">&lt;code>git-crecord&lt;/code>&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>git subcommand to interactively select changes to commit or stage&lt;/p>
&lt;/blockquote>
&lt;p>&amp;hellip;which I packaged to the &lt;a href="https://aur.archlinux.org/packages/git-crecord">Arch User
Repository&lt;/a> a long time ago, but
ended up barely using it. Let&amp;rsquo;s see whether &lt;code>tig status&lt;/code> will stick.&lt;/p></description></item><item><title>Desk</title><link>https://perrotta.dev/2025/11/desk/</link><pubDate>Tue, 04 Nov 2025 09:25:55 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/desk/</guid><description>&lt;p>Let me peek at your desk at work and/or at home and I&amp;rsquo;ll be able to instantly
tell, up to a certain (high) degree of confidence, how organized and/or
productive you are digitally.&lt;/p>
&lt;p>Put it another way: &amp;ldquo;a desk is worth a thousand words&amp;rdquo;.&lt;/p>
&lt;p>Last time I checked, desk tidiness is not included in typical performance
reviews though.&lt;/p></description></item><item><title>Chrome: hide bookmarks bar</title><link>https://perrotta.dev/2025/11/chrome-hide-bookmarks-bar/</link><pubDate>Sun, 02 Nov 2025 11:46:39 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/chrome-hide-bookmarks-bar/</guid><description>&lt;p>It is a good practice to &lt;a href="https://www.jakeworth.com/tils/hide-bookmarks-bar-in-chrome/">hide the bookmarks
bar&lt;/a> in Chrome in
certain scenarios:&lt;/p>
&lt;ul>
&lt;li>when taking screenshots&lt;/li>
&lt;li>when sharing your screen during presentations or video calls&lt;/li>
&lt;li>when you need to focus and/or avoid distractions&lt;/li>
&lt;/ul>
&lt;p>It can be done with &lt;code>Cmd + Shift + b&lt;/code>. I use this shortcut all the time.&lt;/p>
&lt;p>Alternatively: Menu &amp;gt; Bookmarks and Lists &amp;gt; Hide Bookmarks Bar.&lt;/p></description></item><item><title>vim: spellchecker suggestions</title><link>https://perrotta.dev/2025/11/vim-spellchecker-suggestions/</link><pubDate>Sun, 02 Nov 2025 11:37:57 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/11/vim-spellchecker-suggestions/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/07/vim-add-word-to-spellchecker/">Previously&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>When you have the spellchecker from &lt;code>vim&lt;/code> turned on (&lt;code>:set spell&lt;/code>), it
highlights words that are not in the dictionary.&lt;/p>
&lt;/blockquote>
&lt;p>It turns out &lt;code>vim&lt;/code>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> can also suggest corrections to these words.&lt;/p>
&lt;p>&lt;code>:h z=&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code>z= For the word under/after the cursor suggest correctly
 spelled words. This also works to find alternatives
 for a word that is not highlighted as a bad word,
 e.g., when the word after it is bad.
 In Visual mode the highlighted text is taken as the
 word to be replaced.
 The results are sorted on similarity to the word being
 replaced.
 This may take a long time. Hit CTRL-C when you get
 bored.
&lt;/code>&lt;/pre>&lt;p>For example: take the word &lt;code>exampl&lt;/code>. When pressing &lt;code>z=&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code>Change &amp;#34;exampl&amp;#34; to:
 1 &amp;#34;example&amp;#34;
 2 &amp;#34;example&amp;#34; &amp;lt; &amp;#34;exampl.&amp;#34;
 3 &amp;#34;exam pl&amp;#34;
 4 &amp;#34;exempt&amp;#34;
 5 &amp;#34;exam Pl&amp;#34;
 6 &amp;#34;exam&amp;#34;
&lt;/code>&lt;/pre>&lt;p>Upon pressing &lt;code>1&amp;lt;Enter&amp;gt;&lt;/code> it is automatically replaced.&lt;/p>
&lt;p>Alternatively we can skip the suggestions and simply &lt;a href="https://www.jakeworth.com/tils/select-first-spell-suggestion/">pick the first
one&lt;/a> right away
with &lt;code>1z=&lt;/code>.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;code>vim&lt;/code> never ceases to amaze me.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Highlighting text in drafts</title><link>https://perrotta.dev/2025/10/highlighting-text-in-drafts/</link><pubDate>Fri, 31 Oct 2025 11:38:07 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/highlighting-text-in-drafts/</guid><description>&lt;p>When editing complex documents that warrant multiple revisions (iterations) and
peer reviews, it is often helpful to make prominent distinctions within
sentences, in order to track &lt;strong>authorship&lt;/strong> and &lt;strong>readiness&lt;/strong>.&lt;/p>
&lt;p>I enjoy making such distinctions by using the color highlighting&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> feature of
the document / text app at hand (e.g. Google Docs, LibreOffice). Light colors
are visually the best, and they are less distracting.&lt;/p>
&lt;p>Authorship (or provenance) tracks who wrote what. Different people should
have distinct colors assigned to each.&lt;/p>
&lt;p>Readiness correlates to the number of revisions a given word or sentence has
undergone through. For example, use yellow for early drafts and shallow
brainstorming, orange for work-in-progress, and green for final revisions.&lt;/p>
&lt;p>It is much easier to visually keep track of the document evolution when doing
so.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>In some situations, &lt;strong>bolding&lt;/strong> or &lt;u>underlining&lt;/u> is also helpful.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Oncall workflow with iOS shortcuts</title><link>https://perrotta.dev/2025/10/oncall-workflow-with-ios-shortcuts/</link><pubDate>Fri, 31 Oct 2025 09:38:12 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/oncall-workflow-with-ios-shortcuts/</guid><description>&lt;p>&lt;em>The title is foreshadowing.&lt;/em>&lt;/p>
&lt;p>&lt;strong>Problem statement&lt;/strong>: when using an iPhone as a pager device for oncall duties,
disable airplane mode / &amp;ldquo;do not disturb&amp;rdquo; programmatically at the beginning of
your shift.&lt;/p>
&lt;p>I find it&amp;rsquo;s a good practice to disable smartphone notifications before going to
bed, whether by enabling airplane mode, activating &amp;ldquo;do not disturb&amp;rdquo;, or
activating a custom focus mode.&lt;/p>
&lt;p>However, say that your shift starts at 5am.&lt;/p>
&lt;p>How can you ensure your phone is readily available for paging from 5am, whilst
all other notifications are kept ignored?&lt;/p>
&lt;p>I found a sweet spot that works in all situations:&lt;/p>
&lt;ul>
&lt;li>Enable &amp;ldquo;do not disturb&amp;rdquo; before going to bed (this can be done automatically).
This step is critical.&lt;/li>
&lt;li>Enable airplane mode before going to bed (this can be done automatically).
This step is optional.&lt;/li>
&lt;li>Create a shortcut within the Shortcuts app:
&lt;ul>
&lt;li>Name: &amp;ldquo;Turn Airplane Mode Off&amp;rdquo;&lt;/li>
&lt;li>Action: &lt;strong>Turn&lt;/strong> Airplane Mode &lt;strong>Off&lt;/strong>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Create an automation within the Shortcuts app:
&lt;ul>
&lt;li>Automation: &lt;strong>Run Immediately&lt;/strong> (This is important!&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>)&lt;/li>
&lt;li>Notify When Run: on&lt;/li>
&lt;li>When: At 05:00, daily&lt;/li>
&lt;li>Do: Trigger the shortcut defined previously&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>Why is this effective?&lt;/p>
&lt;p>There are virtually no notifications until 5am.&lt;/p>
&lt;p>From 5am, only &lt;em>critical&lt;/em> notifications (as defined by your pager app) will alert
you, thanks to airplane mode being off + &amp;ldquo;do not disturb&amp;rdquo; being on.&lt;/p>
&lt;p>In the past I would leave Wi-Fi on (=airplane mode off) + &amp;ldquo;do not disturb&amp;rdquo; on,
but every once in a while I would get paged, even before 5am. Why? Because our
oncall rotation is configured to eventually alert the entire team if the current
oncall person does not timely ACK the page, which happens seldomly. I&amp;rsquo;d rather
not take the risk and have my sleep interrupted.&lt;/p>
&lt;p>This scheme only works in practice for oncall rotations that do not have a
secondary responder. If you&amp;rsquo;re the secondary then you should let yourself be
reachable.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Otherwise you&amp;rsquo;ll need to confirm the automation before it runs, which
defeats the purpose of the automation in this case.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Clipboard as backup</title><link>https://perrotta.dev/2025/10/clipboard-as-backup/</link><pubDate>Thu, 30 Oct 2025 21:18:23 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/clipboard-as-backup/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2023/12/maccy-macos-clipboard-manager/">Previously&lt;/a>.&lt;/p>
&lt;p>Whenever I am submitting forms in the Web, I have the habit (tendency?) to keep
hitting &lt;code>Cmd-A Cmd-C&lt;/code> every once in a while, with the goal of saving all the
text I&amp;rsquo;ve typed so far in a given text input field to the system clipboard.&lt;/p>
&lt;p>This practice, when paired with a clipboard manager, acts as a backup mechanism.&lt;/p>
&lt;p>This habit grew out of frustration: many times have I been frustrated because
web pages would suddenly crash or reload, and everything I had typed thus far
would have been lost.&lt;/p>
&lt;p>Not any longer.&lt;/p></description></item><item><title>Basic Badminton</title><link>https://perrotta.dev/2025/10/basic-badminton/</link><pubDate>Thu, 30 Oct 2025 20:25:51 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/basic-badminton/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/03/badminton/">Previously&lt;/a>.&lt;/p>
&lt;p>When playing badminton, the serving side (left or right) depends on the current
score of the serving team:&lt;/p>
&lt;ul>
&lt;li>Left side: 1, 3, 5, &amp;hellip;&lt;/li>
&lt;li>Right side: 0, 2, 4, &amp;hellip;&lt;/li>
&lt;/ul>
&lt;p>For many months (years?), I kept confounding the two.&lt;/p>
&lt;p>Even field experience would not make it any easier to remember which one is
which.&lt;/p>
&lt;p>At some point, I devised the following mnemonic:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>B&lt;/strong>adminton &amp;lt;-&amp;gt; &lt;strong>B&lt;/strong>asic. Both start with a &lt;strong>B&lt;/strong>.&lt;/li>
&lt;li>Basic =&amp;gt; Visual Basic =&amp;gt; Counting starts from 1 (not 0).&lt;/li>
&lt;li>As such: Left is 1.&lt;/li>
&lt;/ul>
&lt;p>This way I can always remember&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> that Left is 1 (odd), Right is 2 (even).&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Sometimes this information is cached, sometimes it needs to be retrieved
from &amp;ldquo;&amp;ldquo;&amp;ldquo;disk&amp;rdquo;&amp;rdquo;&amp;rdquo;, but this mnemonic never fails me.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>New script: SSH mux restart</title><link>https://perrotta.dev/2025/10/new-script-ssh-mux-restart/</link><pubDate>Thu, 30 Oct 2025 12:59:53 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/new-script-ssh-mux-restart/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/10/github-the-organization-has-enabled-or-enforced-saml-sso/">Previously&lt;/a>,
&lt;a href="https://perrotta.dev/2025/05/1password-ssh-agent-error/">previously&lt;/a>.&lt;/p>
&lt;p>After experiencing almost daily frustration because of this SSH auth issue, I
decided to script a solution out of it: and now
&lt;a href="https://github.com/thiagowfx/pancake/tree/8707d1792c0d1266180dfa3d49c7d144c71ef23d/ssh_mux_restart">&lt;code>ssh_mux_restart&lt;/code>&lt;/a>
was born.&lt;/p>
&lt;p>A copy of the &lt;code>README.md&lt;/code> follows below for ease of reference.&lt;/p>
&lt;p>The use case is very simple: run the &lt;code>ssh_mux_restart&lt;/code> script whenever I run
into a git SSH authentication error, typically due to &lt;code>git pull&lt;/code>, &lt;code>git fetch&lt;/code> or
&lt;code>git push&lt;/code>.&lt;/p>
&lt;h2 id="usage">Usage&lt;/h2>
&lt;p>Basic usage to kill SSH multiplexed connections:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>./ssh_mux_restart.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>To also restart the 1Password SSH agent:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>./ssh_mux_restart.sh --restart-1password
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="example-output">Example Output&lt;/h2>
&lt;pre tabindex="0">&lt;code>% ./ssh_mux_restart.sh
Finding SSH multiplexed connections...
Found SSH multiplexed connections:
 88002 ssh: /tmp/ssh-control-FLAPJACK42 [mux]
 88123 ssh: /tmp/ssh-control-WAFFLE55 [mux]
Killing SSH multiplexed connections...
‚úì Killed SSH mux process: 88002
‚úì Killed SSH mux process: 88123
Killed 2/2 SSH multiplexed connections.

All operations completed successfully!
&lt;/code>&lt;/pre>&lt;p>With the &lt;code>--restart-1password&lt;/code> flag:&lt;/p>
&lt;pre tabindex="0">&lt;code>% ./ssh_mux_restart.sh --restart-1password
Finding SSH multiplexed connections...
Found SSH multiplexed connections:
 88002 ssh: /tmp/ssh-control-PANCAKE99 [mux]
Killing SSH multiplexed connections...
‚úì Killed SSH mux process: 88002
Killed 1/1 SSH multiplexed connections.

Restarting 1Password application...
Found 1Password process: 67690
Quitting 1Password...
‚úì 1Password quit successfully
Starting 1Password...
‚úì 1Password started successfully
1Password SSH agent is now ready for use.

All operations completed successfully!
&lt;/code>&lt;/pre>&lt;h2 id="why-this-matters">Why This Matters&lt;/h2>
&lt;p>SSH multiplexed connections can cache stale authentication credentials, causing issues when:&lt;/p>
&lt;ul>
&lt;li>GitHub organizations enable or enforce SAML SSO&lt;/li>
&lt;li>1Password SSH agent credentials need refreshing&lt;/li>
&lt;li>SSH keys have been rotated or updated&lt;/li>
&lt;/ul>
&lt;p>Restarting these connections forces SSH to re-authenticate with fresh credentials.&lt;/p>
&lt;h2 id="prerequisites">Prerequisites&lt;/h2>
&lt;ul>
&lt;li>Standard Unix tools (&lt;code>pgrep&lt;/code>, &lt;code>pkill&lt;/code>)&lt;/li>
&lt;li>1Password app (macOS) if using the &lt;code>--restart-1password&lt;/code> flag&lt;/li>
&lt;/ul></description></item><item><title>Claude Code: paste in images</title><link>https://perrotta.dev/2025/10/claude-code-paste-in-images/</link><pubDate>Wed, 29 Oct 2025 16:37:57 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/claude-code-paste-in-images/</guid><description>&lt;p>&lt;a href="https://www.claude.com/product/claude-code">Claude Code&lt;/a> supports images as
input.&lt;/p>
&lt;p>Absolutely incredible; considering that it is a TUI, one would usually not
expect the ability to do so.&lt;/p>
&lt;p>Copy the image to your clipboard as usual, and then paste it in with &lt;code>Ctrl + V&lt;/code>,
as you would in any GUI app:&lt;/p>
&lt;pre tabindex="0">&lt;code> ‚ñê‚ñõ‚ñà‚ñà‚ñà‚ñú‚ñå Claude Code v2.0.28
‚ñù‚ñú‚ñà‚ñà‚ñà‚ñà‚ñà‚ñõ‚ñò Sonnet 4.5 ¬∑ API Usage Billing
 ‚ñò‚ñò ‚ñù‚ñù /Users/thiago.perrotta/corp/gitops

&amp;gt; Document in the @README.md how to use the argocd CLI with our setup.

[Image #1][Image #2]
 ‚éø Read README.md (937 lines)

‚è∫ I&amp;#39;ll add comprehensive ArgoCD CLI documentation to the README. Let me examine the current structure
 and add a new section after the User Management section.
&lt;/code>&lt;/pre></description></item><item><title>Grep in PDFs</title><link>https://perrotta.dev/2025/10/grep-in-pdfs/</link><pubDate>Wed, 29 Oct 2025 01:59:08 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/grep-in-pdfs/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: &lt;code>grep&lt;/code>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> for a given string in a multitude of
multi-page PDF files:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% du -sh very_large_file.zip
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>513M very_large_file.zip
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% unzip very_large_file.zip
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">[&lt;/span>...&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% ls -1 *.pdf | wc -l
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d19a66">6816&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>There&amp;rsquo;s a tool called &lt;a href="https://github.com/phiresky/ripgrep-all">&lt;code>ripgrep-all&lt;/code>&lt;/a>
(short: &lt;code>rga&lt;/code>) that is perfect for that. And yes, it resembles our good ol'
&lt;code>ripgrep&lt;/code> (short: &lt;code>rg&lt;/code>).&lt;/p>
&lt;p>It is &lt;a href="https://repology.org/project/ripgrep-all/versions">widely available&lt;/a> in
most package managers.&lt;/p>
&lt;p>I install it with &lt;code>homebrew&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% brew install ripgrep-all &lt;span style="color:#7f848e"># or rga&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Upon running it with:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% rga -i &lt;span style="color:#98c379">&amp;#34;perrotta&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip;it did not initially work. &lt;code>pdftotext&lt;/code> is a required dependency that was
missing.&lt;/p>
&lt;p>&lt;a href="https://superuser.com/questions/781693/how-to-determine-which-brew-package-provides-a-given-file">Where&lt;/a> can we obtain &lt;code>pdftotext&lt;/code>?&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% brew which-formula pdftotext
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf2image
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>poppler
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>poppler-qt5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>xpdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>I installed &lt;code>poppler&lt;/code>, as it is quite well-known in the Linux world.&lt;/p>
&lt;p>The search works as expected afterwards:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% rga -i perrotta
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>my_cool_file_000.pdf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Page 12: HELLO PERROTTA GOODBYE
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>my_cool_file_001.pdf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Page 123: SERVUS PERROTTA CIAO
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>grep foo, grep &lt;em>in&lt;/em> foo, or grep &lt;em>for&lt;/em> foo? Ah, English prepositions.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>PostgreSQL: get database size</title><link>https://perrotta.dev/2025/10/postgresql-get-database-size/</link><pubDate>Mon, 27 Oct 2025 22:47:56 +0100</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/postgresql-get-database-size/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: Given a PostgreSQL DB, obtain its total size, preferably
in a human-readable format (pretty-printed).&lt;/p>
&lt;h2 id="option-1-sql-query">Option 1: SQL query&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">SELECT&lt;/span> &lt;span style="color:#e06c75">pg_size_pretty&lt;/span>(&lt;span style="color:#e06c75">pg_database_size&lt;/span>(&lt;span style="color:#98c379">&amp;#39;dbname&amp;#39;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d19a66">11&lt;/span> &lt;span style="color:#e06c75">GB&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="option-2-psql-cli">Option 2: &lt;code>psql&lt;/code> CLI&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>\&lt;span style="color:#e06c75">l&lt;/span>&lt;span style="color:#56b6c2">+&lt;/span> &lt;span style="color:#e06c75">dbname&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">List&lt;/span> &lt;span style="color:#c678dd">of&lt;/span> &lt;span style="color:#e06c75">databases&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">Name&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#c678dd">Owner&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#c678dd">Encoding&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#c678dd">Collate&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#e06c75">Ctype&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#c678dd">Access&lt;/span> &lt;span style="color:#c678dd">privileges&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#c678dd">Size&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#e06c75">Tablespace&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#e06c75">Description&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e">--------------------+-------+----------+-------------+-------------+-------------------+-------+------------+-------------
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e">&lt;/span> &lt;span style="color:#e06c75">dbname&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#e06c75">me&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#e06c75">UTF8&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#e06c75">en_US&lt;/span>.&lt;span style="color:#e06c75">UTF&lt;/span>&lt;span style="color:#56b6c2">-&lt;/span>&lt;span style="color:#d19a66">8&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#e06c75">en_US&lt;/span>.&lt;span style="color:#e06c75">UTF&lt;/span>&lt;span style="color:#56b6c2">-&lt;/span>&lt;span style="color:#d19a66">8&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#d19a66">11&lt;/span> &lt;span style="color:#e06c75">GB&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span> &lt;span style="color:#e06c75">pg_default&lt;/span> &lt;span style="color:#56b6c2">|&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>(&lt;span style="color:#d19a66">1&lt;/span> &lt;span style="color:#c678dd">row&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>.terraform-version</title><link>https://perrotta.dev/2025/10/.terraform-version/</link><pubDate>Fri, 24 Oct 2025 15:12:18 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/.terraform-version/</guid><description>&lt;p>&lt;code>.terraform-version&lt;/code> at the root of a git repository is recognized by various
tools:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/tfutils/tfenv#terraform-version-file">tfenv&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://tfswitch.warrensbox.com/usage/config-files/#use-versiontf-file">tfswitch&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.terrateam.io/integrations/iac-tools/terraform">terrateam&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>You would expect the
&lt;a href="https://github.com/hashicorp/setup-terraform">&lt;code>hashicorp/setup-terraform&lt;/code>&lt;/a>
github action would also recognize it out-of-the-box, but it does not. We can
address this gap by reading it manually:&lt;/p>
&lt;pre tabindex="0">&lt;code>jobs:
 terraform:
 runs-on: ubuntu-latest
 steps:
 - uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8 # v5.0.0
 with:
 persist-credentials: false

 - name: Read Terraform version
 id: terraform-version
 run: echo &amp;#34;version=$(cat .terraform-version)&amp;#34; &amp;gt;&amp;gt; &amp;#34;$GITHUB_OUTPUT&amp;#34;

 - uses: hashicorp/setup-terraform@b9cd54a3c349d3f38e8881555d616ced269862dd # v3.1.2
 with:
 terraform_version: ${{ steps.terraform-version.outputs.version }}
&lt;/code>&lt;/pre>&lt;p>There&amp;rsquo;s a &lt;a href="https://github.com/hashicorp/setup-terraform/issues/298">feature
request&lt;/a> for it.&lt;/p></description></item><item><title>brew: upgrade HEAD formulas</title><link>https://perrotta.dev/2025/10/brew-upgrade-head-formulas/</link><pubDate>Thu, 23 Oct 2025 12:53:11 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/brew-upgrade-head-formulas/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/10/distributing-my-own-scripts-via-homebrew/">Previously&lt;/a>.&lt;/p>
&lt;p>When a package is installed with &lt;code>--HEAD&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% brew install --HEAD pancake
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip;&lt;code>brew upgrade&lt;/code> won&amp;rsquo;t automatically fetch its latest version.&lt;/p>
&lt;p>In order to do so, run:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% brew upgrade --fetch-HEAD &lt;span style="color:#56b6c2">[&lt;/span>package...&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://apple.stackexchange.com/questions/439595/brew-head-update-behaviour">Source&lt;/a>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>I answered it there, does that count as linking to the source?&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>GitHub: the organization has enabled or enforced SAML sso</title><link>https://perrotta.dev/2025/10/github-the-organization-has-enabled-or-enforced-saml-sso/</link><pubDate>Tue, 21 Oct 2025 08:15:41 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/github-the-organization-has-enabled-or-enforced-saml-sso/</guid><description>&lt;p>Error message when doing &lt;code>git push&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code>% git push
ERROR: The &amp;#39;{corp}&amp;#39; organization has enabled or enforced SAML SSO.
To access this repository, you must use the HTTPS remote with a personal access token or SSH with an SSH key and passphrase that has been authorized for this organization.
Visit https://docs.github.com/articles/authenticating-to-a-github-organization-with-saml-single-sign-on/ for more information.

fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
&lt;/code>&lt;/pre>&lt;p>Even after authenticating by logging in, the error persists.&lt;/p>
&lt;p>The solution is to &lt;strong>restart the ssh agent&lt;/strong>.&lt;/p>
&lt;p>How to do so is out of scope of this post, because it depends on which one you
use.&lt;/p>
&lt;p>For the 1Password ssh agent, the following has worked for me:&lt;/p>
&lt;ul>
&lt;li>disable it by toggling the checkbox: Settings &amp;gt; Developer &amp;gt; SSH Agent &amp;gt; Use the SSH Agent&lt;/li>
&lt;li>kill the ssh agent (&lt;code>pkill ssh-agent&lt;/code>)&lt;/li>
&lt;li>kill open ssh multiplexing connections (e.g. with &lt;code>pkill&lt;/code>):&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>% pgrep -afl ssh
48564 ssh: /tmp/ssh-control-bda8786786c69753cc9ddd9fb7c06aaff3768a70 [mux]
50845 ssh: /tmp/ssh-control-bda8786786c69753cc9ddd9fb7c06aaff3768a70 [mux]
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>quit 1Password, then reopen it&lt;/li>
&lt;li>re-enable the 1Password ssh agent&lt;/li>
&lt;li>&lt;code>git push&lt;/code> again&lt;/li>
&lt;/ul>
&lt;p>Surely there is a way to script this?&lt;/p>
&lt;p>&lt;strong>Update(2025-10-28)&lt;/strong>: In a second try, killing the process below was enough to
address the issue.&lt;/p>
&lt;pre tabindex="0">&lt;code>% pgrep -afl ssh
7242 ssh: /tmp/ssh-control-bda8786786c69753cc9ddd9fb7c06aaff3768a70 [mux]
% kill 7242
&lt;/code>&lt;/pre></description></item><item><title>Instagram: unfollow non-followers</title><link>https://perrotta.dev/2025/10/instagram-unfollow-non-followers/</link><pubDate>Tue, 21 Oct 2025 00:13:11 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/instagram-unfollow-non-followers/</guid><description>&lt;p>Sometimes connections simply fade away. Life happens. Privacy prevails. Then why
don&amp;rsquo;t people remove them both ways (follower + following)? If you don&amp;rsquo;t want to
stay connected with someone any longer, it is good courtesy to do so
symmetrically. If you just unfollow someone, without removing them from your
follower list, then you tacitly demonstrate that you care to a great extent
about invisible internet karma points /shrug.&lt;/p>
&lt;p>Instagram doesn&amp;rsquo;t make it easy to find those who do not follow you back.
However, it is possible to obtain this information with a little bit of
scripting.&lt;/p>
&lt;ul>
&lt;li>Go to &lt;a href="https://www.instagram.com/download/request/">Go to Instagram ‚Üí Settings ‚Üí Privacy and security ‚Üí Download your
information&lt;/a>.&lt;/li>
&lt;li>Choose JSON (not HTML).&lt;/li>
&lt;li>Select &amp;ldquo;Connections&amp;rdquo; only and, for the period, choose from the beginning of time&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.&lt;/li>
&lt;li>Confirm the prompt.&lt;/li>
&lt;li>Instagram will email you a ZIP file. That should take a couple of minutes.&lt;/li>
&lt;li>Download the ZIP (&lt;code>instagram-{username}-YYYY-MM-DD-{id}.zip&lt;/code>) and unpack it.
Structure:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% tree connections
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>connections
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>‚îî‚îÄ‚îÄ followers_and_following
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ‚îú‚îÄ‚îÄ blocked_profiles.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ‚îú‚îÄ‚îÄ close_friends.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ‚îú‚îÄ‚îÄ follow_requests_you&lt;span style="color:#98c379">&amp;#39;ve_received.json
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379"> ‚îú‚îÄ‚îÄ followers_1.json
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379"> ‚îú‚îÄ‚îÄ following.json
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379"> ‚îú‚îÄ‚îÄ hide_story_from.json
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379"> ‚îú‚îÄ‚îÄ pending_follow_requests.json
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379"> ‚îú‚îÄ‚îÄ profiles_you&amp;#39;&lt;/span>ve_favorited.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ‚îú‚îÄ‚îÄ recent_follow_requests.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ‚îú‚îÄ‚îÄ recently_unfollowed_profiles.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ‚îî‚îÄ‚îÄ removed_suggestions.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>(Yes, one of these files has a &lt;code>'&lt;/code> in the name. It was not a typo.)&lt;/p>
&lt;p>We&amp;rsquo;re interested in &lt;code>followers_N.json&lt;/code> and &lt;code>following.json&lt;/code>.&lt;/p>
&lt;p>From this point on, vibe code and chill. A single, well-crafted prompted is
enough. For example:&lt;/p>
&lt;pre tabindex="0">&lt;code>You are a world-class software developer.

I exported all my Instagram data.

Write a python script to parse all people I follow that do not follow me back.

Output username + profile URLs in each line.
&lt;/code>&lt;/pre>&lt;p>I am a fan of this one-shot prompt structure / style&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>:&lt;/p>
&lt;ul>
&lt;li>you are a superb ${FOO}&lt;/li>
&lt;li>this is some context for you&lt;/li>
&lt;li>do this for me&lt;/li>
&lt;li>output in the desired format&lt;/li>
&lt;/ul>
&lt;p>The resulting script:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e">#!/usr/bin/env python3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">import&lt;/span> &lt;span style="color:#e06c75">json&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">import&lt;/span> &lt;span style="color:#e06c75">csv&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">from&lt;/span> &lt;span style="color:#e06c75">pathlib&lt;/span> &lt;span style="color:#c678dd">import&lt;/span> &lt;span style="color:#e06c75">Path&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Base path where your JSON files are&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">base&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e06c75">Path&lt;/span>(&lt;span style="color:#98c379">&amp;#34;connections/followers_and_following&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">def&lt;/span> &lt;span style="color:#61afef;font-weight:bold">extract_usernames&lt;/span>(&lt;span style="color:#e06c75">file_path&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#34;&amp;#34;&amp;#34;Extract Instagram usernames from a followers/following JSON file.&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">with&lt;/span> &lt;span style="color:#e5c07b">open&lt;/span>(&lt;span style="color:#e06c75">file_path&lt;/span>) &lt;span style="color:#c678dd">as&lt;/span> &lt;span style="color:#e06c75">f&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">data&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e06c75">json&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">load&lt;/span>(&lt;span style="color:#e06c75">f&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># Handle both old and new formats&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">if&lt;/span> &lt;span style="color:#e5c07b">isinstance&lt;/span>(&lt;span style="color:#e06c75">data&lt;/span>, &lt;span style="color:#e5c07b">dict&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">for&lt;/span> &lt;span style="color:#e06c75">v&lt;/span> &lt;span style="color:#56b6c2">in&lt;/span> &lt;span style="color:#e06c75">data&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">values&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">if&lt;/span> &lt;span style="color:#e5c07b">isinstance&lt;/span>(&lt;span style="color:#e06c75">v&lt;/span>, &lt;span style="color:#e5c07b">list&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">data&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e06c75">v&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">break&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">if&lt;/span> &lt;span style="color:#56b6c2">not&lt;/span> &lt;span style="color:#e5c07b">isinstance&lt;/span>(&lt;span style="color:#e06c75">data&lt;/span>, &lt;span style="color:#e5c07b">list&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">raise&lt;/span> &lt;span style="color:#e06c75">ValueError&lt;/span>(&lt;span style="color:#98c379">f&lt;/span>&lt;span style="color:#98c379">&amp;#34;Unexpected format in &lt;/span>&lt;span style="color:#98c379">{&lt;/span>&lt;span style="color:#e06c75">file_path&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">usernames&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e5c07b">set&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">for&lt;/span> &lt;span style="color:#e06c75">item&lt;/span> &lt;span style="color:#56b6c2">in&lt;/span> &lt;span style="color:#e06c75">data&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">try&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">entry&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e06c75">item&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">get&lt;/span>(&lt;span style="color:#98c379">&amp;#34;string_list_data&amp;#34;&lt;/span>, [])[&lt;span style="color:#d19a66">0&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">username&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">entry&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">get&lt;/span>(&lt;span style="color:#98c379">&amp;#34;value&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#56b6c2">or&lt;/span> &lt;span style="color:#e06c75">entry&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">get&lt;/span>(&lt;span style="color:#98c379">&amp;#34;href&amp;#34;&lt;/span>, &lt;span style="color:#98c379">&amp;#34;&amp;#34;&lt;/span>)&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">rstrip&lt;/span>(&lt;span style="color:#98c379">&amp;#34;/&amp;#34;&lt;/span>)&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">split&lt;/span>(&lt;span style="color:#98c379">&amp;#34;/&amp;#34;&lt;/span>)[&lt;span style="color:#56b6c2">-&lt;/span>&lt;span style="color:#d19a66">1&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#56b6c2">or&lt;/span> &lt;span style="color:#e06c75">entry&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">get&lt;/span>(&lt;span style="color:#98c379">&amp;#34;username&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">if&lt;/span> &lt;span style="color:#e06c75">username&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">usernames&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">add&lt;/span>(&lt;span style="color:#e06c75">username&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">except&lt;/span> &lt;span style="color:#e06c75">Exception&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">continue&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">return&lt;/span> &lt;span style="color:#e06c75">usernames&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># --- Load followers (handles multiple files) ---&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">followers&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e5c07b">set&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">for&lt;/span> &lt;span style="color:#e06c75">path&lt;/span> &lt;span style="color:#56b6c2">in&lt;/span> &lt;span style="color:#e06c75">base&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">glob&lt;/span>(&lt;span style="color:#98c379">&amp;#34;followers_*.json&amp;#34;&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">followers&lt;/span> &lt;span style="color:#56b6c2">|=&lt;/span> &lt;span style="color:#e06c75">extract_usernames&lt;/span>(&lt;span style="color:#e06c75">path&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># --- Load following ---&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">following&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e06c75">extract_usernames&lt;/span>(&lt;span style="color:#e06c75">base&lt;/span> &lt;span style="color:#56b6c2">/&lt;/span> &lt;span style="color:#98c379">&amp;#34;following.json&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># --- Compute differences ---&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">not_following_back&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e5c07b">sorted&lt;/span>(&lt;span style="color:#e06c75">following&lt;/span> &lt;span style="color:#56b6c2">-&lt;/span> &lt;span style="color:#e06c75">followers&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">you_dont_follow_back&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e5c07b">sorted&lt;/span>(&lt;span style="color:#e06c75">followers&lt;/span> &lt;span style="color:#56b6c2">-&lt;/span> &lt;span style="color:#e06c75">following&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">mutuals&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e5c07b">sorted&lt;/span>(&lt;span style="color:#e06c75">followers&lt;/span> &lt;span style="color:#56b6c2">&amp;amp;&lt;/span> &lt;span style="color:#e06c75">following&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">def&lt;/span> &lt;span style="color:#61afef;font-weight:bold">write_csv&lt;/span>(&lt;span style="color:#e06c75">filename&lt;/span>, &lt;span style="color:#e06c75">users&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">with&lt;/span> &lt;span style="color:#e5c07b">open&lt;/span>(&lt;span style="color:#e06c75">filename&lt;/span>, &lt;span style="color:#98c379">&amp;#34;w&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">newline&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">encoding&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;utf-8&amp;#34;&lt;/span>) &lt;span style="color:#c678dd">as&lt;/span> &lt;span style="color:#e06c75">f&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">writer&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e06c75">csv&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">writer&lt;/span>(&lt;span style="color:#e06c75">f&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">writer&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">writerow&lt;/span>([&lt;span style="color:#98c379">&amp;#34;username&amp;#34;&lt;/span>, &lt;span style="color:#98c379">&amp;#34;profile_url&amp;#34;&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">for&lt;/span> &lt;span style="color:#e06c75">user&lt;/span> &lt;span style="color:#56b6c2">in&lt;/span> &lt;span style="color:#e06c75">users&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">writer&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">writerow&lt;/span>([&lt;span style="color:#e06c75">user&lt;/span>, &lt;span style="color:#98c379">f&lt;/span>&lt;span style="color:#98c379">&amp;#34;https://www.instagram.com/&lt;/span>&lt;span style="color:#98c379">{&lt;/span>&lt;span style="color:#e06c75">user&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">/&amp;#34;&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e5c07b">print&lt;/span>(&lt;span style="color:#98c379">f&lt;/span>&lt;span style="color:#98c379">&amp;#34;‚úÖ Saved &lt;/span>&lt;span style="color:#98c379">{&lt;/span>&lt;span style="color:#e5c07b">len&lt;/span>(&lt;span style="color:#e06c75">users&lt;/span>)&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379"> entries to &lt;/span>&lt;span style="color:#98c379">{&lt;/span>&lt;span style="color:#e06c75">filename&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># --- Write results ---&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">write_csv&lt;/span>(&lt;span style="color:#98c379">&amp;#34;not_following_back.csv&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">not_following_back&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">write_csv&lt;/span>(&lt;span style="color:#98c379">&amp;#34;you_dont_follow_back.csv&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">you_dont_follow_back&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">write_csv&lt;/span>(&lt;span style="color:#98c379">&amp;#34;mutuals.csv&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">mutuals&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The script was tested in a real account, and I&amp;rsquo;m pleased to state that it works
as intended.&lt;/p>
&lt;p>If you use it for the sake of unfollowing people&lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup> then it&amp;rsquo;s advisable not to
automate the unfollowing process, as Instagram could potentially block you.
Instead, do it manually.&lt;/p>
&lt;p>May the reduced noise increase your serenity.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Or else it won&amp;rsquo;t work.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>I am not here to claim what prompt is the best. Just keep it simple and
carry on.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:3">
&lt;p>Why would you run it otherwise?&amp;#160;&lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>The Apple Store</title><link>https://perrotta.dev/2025/10/the-apple-store/</link><pubDate>Sat, 18 Oct 2025 12:49:20 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/the-apple-store/</guid><description>&lt;p>After owning an iPhone 14 Pro for more than two and a half years, its maximum
battery capacity degraded to &lt;strong>~76%&lt;/strong>. It is not a terrible number, but the
general recommendation is to take action whenever it goes below &lt;strong>80%&lt;/strong>, which
happened a couple of months ago.&lt;/p>
&lt;p>In this state I am forced to carry a portable charger wherever I go if I want
to keep my peace of mind and eliminate &amp;ldquo;battery anxiety&amp;rdquo;.&lt;/p>
&lt;p>The natural course of action for many at this point would be to simply buy the
newest and shiniest iPhone.&lt;/p>
&lt;p>Yet, I love to fight against &lt;a href="https://en.wikipedia.org/wiki/Planned_obsolescence">planned
obsolescence&lt;/a>, and will
happily do what I can, even if it yields a bit of friction.&lt;/p>
&lt;p>One of my favorite aspects of being an iPhone user is the ability to get superb
support from Apple&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>. In particular, they have a &lt;a href="https://support.apple.com/iphone/repair/battery-replacement">battery
replacement&lt;/a>
program.&lt;/p>
&lt;p>All you have to do is:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://getsupport.apple.com/?caller=sfaq&amp;amp;SG=SG003&amp;amp;category_id=SC0999&amp;amp;symptom_id=99911">schedule an appointment&lt;/a> in the Genius Bar,&lt;/li>
&lt;li>bring your iPhone there,&lt;/li>
&lt;li>and then retrieve it a couple of hours later&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup> (&amp;ldquo;same day service&amp;rdquo;).&lt;/li>
&lt;/ul>
&lt;p>Is it cost effective? Hell yes. I paid about 10% of the original purchase
price, and it&amp;rsquo;s like I just got a brand new iPhone.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>But only if I am &lt;del>privileged&lt;/del> lucky enough to live in a city that has
one.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>In my case, 3 hours.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Backlinks</title><link>https://perrotta.dev/2025/10/backlinks/</link><pubDate>Fri, 17 Oct 2025 16:58:16 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/backlinks/</guid><description>&lt;p>I famously do not run any kind of analytics in this blog, neither server-side or
client-side.&lt;/p>
&lt;p>I genuinely have no idea how many people subscribe to it via RSS, and how many
&amp;ldquo;page hits&amp;rdquo; it has been accumulating over its lifetime.&lt;/p>
&lt;p>This is very clearly stated in the homepage.
I take it as a badge of honor.&lt;/p>
&lt;p>That said, I am not saying that running analytics is evil or unethical.
There are various ethical and privacy-friendly analytics tools out there.&lt;/p>
&lt;p>Without analytics, how am I able to keep myself motivated? How can I know
whether I am yelling at the clouds, screaming on to the void?&lt;/p>
&lt;p>The main trick is to write primarily for myself. Writing is a great way to
rearrange my thoughts and make them more coherent and livid.&lt;/p>
&lt;p>A second form of &amp;ldquo;not feeling lonely&amp;rdquo; in the interwebs is to talk to people (or
have people talk to you). Sometimes friends message me in chat apps. Sometimes
strangers email me&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>. Sometimes a long-time ex-coworker mentions a past post of
mine helped them. It is always cool to hear from people&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>. There is a gentle
&amp;ldquo;Reply via email&amp;rdquo; link below every blog post in this site.&lt;/p>
&lt;p>Last: &lt;strong>Backlinks&lt;/strong>!&lt;/p>
&lt;p>Every few months I try to remember to check who is linking back to my blog.
There are various ways to get insights about this:&lt;/p>
&lt;p>&lt;strong>Public&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://marginalia-search.com/site/perrotta.dev?view=links">Marginalia&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Private&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://search.google.com/search-console/links/drilldown?resource_id=sc-domain%3Aperrotta.dev&amp;amp;type=DOMAIN&amp;amp;target=&amp;amp;domain=">Google&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.bing.com/webmasters/backlinks?siteUrl=https://perrotta.dev/">Bing&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Observing slow organic growth, without the pressure to cross-post in social
media platforms or social link aggregators, makes life peaceful and serene.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Please do not be shy, say hello :-)&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>I should write more frequently to authors of blog posts I enjoy. We&amp;rsquo;re
(slowly) getting there.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Distributing my own scripts via homebrew</title><link>https://perrotta.dev/2025/10/distributing-my-own-scripts-via-homebrew/</link><pubDate>Fri, 17 Oct 2025 16:38:40 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/distributing-my-own-scripts-via-homebrew/</guid><description>&lt;p>Thanks &lt;a href="https://justin.searls.co/posts/how-to-distribute-your-own-scripts-via-homebrew/">Justin
Searls&lt;/a>
for the idea:&lt;/p>
&lt;blockquote>
&lt;p>I use Homebrew all the time. Whenever I see a new CLI that offers an npm or uv
install path alongside a brew one, I choose brew every single time.&lt;/p>
&lt;/blockquote>
&lt;p>Me too.&lt;/p>
&lt;blockquote>
&lt;p>And yet, when it comes time to publish a CLI of my own, I usually just ship it
as a Ruby gem or an npm package, because I had (and have!) no fucking clue how
Homebrew works. I&amp;rsquo;m not enough of a neckbeard to peer behind the curtain as
soon as root directories like /usr and /opt are involved, so I never bothered
before today.&lt;/p>
&lt;/blockquote>
&lt;p>I understand how package managers work, and I&amp;rsquo;m even a package maintainer in
Alpine Linux and Arch Linux, but until now I never bothered to package my own
projects for others to consume.&lt;/p>
&lt;p>Previously I talked about my new &lt;a href="https://perrotta.dev/2025/09/pancake-potpourri-scripts/">pancake&lt;/a> repository. It consists of miscellaneous self-contained executables. As such, it is a great candidate for packaging.&lt;/p>
&lt;p>I won&amp;rsquo;t submit it to upstream homebrew because it is overly specific, but that
doesn&amp;rsquo;t prevent me from packaging it in a &lt;a href="https://docs.brew.sh/Taps">standalone
repository&lt;/a>.&lt;/p>
&lt;p>In order to do so, I simply created a &lt;code>pancake.rb&lt;/code> &lt;a href="https://github.com/thiagowfx/pancake/blob/1a58c53e3984b0a0b34b750a73dab793aff5ebe5/Formula/pancake.rb">Formula&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ruby" data-lang="ruby">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">class&lt;/span> &lt;span style="color:#e5c07b">Pancake&lt;/span> &lt;span style="color:#56b6c2">&amp;lt;&lt;/span> &lt;span style="color:#e06c75">Formula&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">desc&lt;/span> &lt;span style="color:#98c379">&amp;#34;A collection of useful shell scripts&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">homepage&lt;/span> &lt;span style="color:#98c379">&amp;#34;https://github.com/thiagowfx/pancake&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">head&lt;/span> &lt;span style="color:#98c379">&amp;#34;https://github.com/thiagowfx/pancake.git&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">def&lt;/span> &lt;span style="color:#61afef;font-weight:bold">install&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># keep-sorted start&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">install&lt;/span> &lt;span style="color:#98c379">&amp;#34;aws_china_mfa/aws_china_mfa.sh&amp;#34;&lt;/span> &lt;span style="color:#56b6c2">=&amp;gt;&lt;/span> &lt;span style="color:#98c379">&amp;#34;aws_china_mfa&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">install&lt;/span> &lt;span style="color:#98c379">&amp;#34;op_login_all/op_login_all.sh&amp;#34;&lt;/span> &lt;span style="color:#56b6c2">=&amp;gt;&lt;/span> &lt;span style="color:#98c379">&amp;#34;op_login_all&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">install&lt;/span> &lt;span style="color:#98c379">&amp;#34;pritunl_login/pritunl_login.sh&amp;#34;&lt;/span> &lt;span style="color:#56b6c2">=&amp;gt;&lt;/span> &lt;span style="color:#98c379">&amp;#34;pritunl_login&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">install&lt;/span> &lt;span style="color:#98c379">&amp;#34;sd_world/sd_world.sh&amp;#34;&lt;/span> &lt;span style="color:#56b6c2">=&amp;gt;&lt;/span> &lt;span style="color:#98c379">&amp;#34;sd_world&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># keep-sorted end&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">end&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e5c07b">test&lt;/span> &lt;span style="color:#c678dd">do&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># Basic test to ensure the scripts are installed and executable.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># keep-sorted start&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">assert_predicate&lt;/span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">/&lt;/span>&lt;span style="color:#98c379">&amp;#34;aws_china_mfa&amp;#34;&lt;/span>, &lt;span style="color:#98c379">:executable?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">assert_predicate&lt;/span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">/&lt;/span>&lt;span style="color:#98c379">&amp;#34;aws_china_mfa&amp;#34;&lt;/span>, &lt;span style="color:#98c379">:exist?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">assert_predicate&lt;/span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">/&lt;/span>&lt;span style="color:#98c379">&amp;#34;op_login_all&amp;#34;&lt;/span>, &lt;span style="color:#98c379">:executable?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">assert_predicate&lt;/span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">/&lt;/span>&lt;span style="color:#98c379">&amp;#34;op_login_all&amp;#34;&lt;/span>, &lt;span style="color:#98c379">:exist?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">assert_predicate&lt;/span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">/&lt;/span>&lt;span style="color:#98c379">&amp;#34;pritunl_login&amp;#34;&lt;/span>, &lt;span style="color:#98c379">:executable?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">assert_predicate&lt;/span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">/&lt;/span>&lt;span style="color:#98c379">&amp;#34;pritunl_login&amp;#34;&lt;/span>, &lt;span style="color:#98c379">:exist?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">assert_predicate&lt;/span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">/&lt;/span>&lt;span style="color:#98c379">&amp;#34;sd_world&amp;#34;&lt;/span>, &lt;span style="color:#98c379">:executable?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">assert_predicate&lt;/span> &lt;span style="color:#e06c75">bin&lt;/span>&lt;span style="color:#56b6c2">/&lt;/span>&lt;span style="color:#98c379">&amp;#34;sd_world&amp;#34;&lt;/span>, &lt;span style="color:#98c379">:exist?&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># keep-sorted end&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">end&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>To install it, first tap the repository&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% brew tap thiagowfx/pancake https://github.com/thiagowfx/pancake.git
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then install it, from &lt;code>HEAD&lt;/code> because it is not currently versioned:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% brew install --HEAD pancake
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>List all package contents:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% brew ls pancake
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/Cellar/pancake/HEAD-1a58c53/bin/aws_china_mfa
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/Cellar/pancake/HEAD-1a58c53/bin/op_login_all
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/Cellar/pancake/HEAD-1a58c53/bin/pritunl_login
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/Cellar/pancake/HEAD-1a58c53/bin/sd_world
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/Cellar/pancake/HEAD-1a58c53/sbom.spdx.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>There&amp;rsquo;s no need to fiddle with &lt;code>$PATH&lt;/code>, as this is already handled by homebrew:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% which aws_china_mfa
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/bin/aws_china_mfa
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% ls -al /opt/homebrew/bin/aws_china_mfa
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>lrwxr-xr-x@ - thiago.perrotta &lt;span style="color:#d19a66">13&lt;/span> Oct 14:43 /opt/homebrew/bin/aws_china_mfa -&amp;gt; ../Cellar/pancake/HEAD-1a58c53/bin/aws_china_mfa*
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>If this idea sticks, I intend to create a dedicated
&lt;code>thiagowfx/homebrew-pancake&lt;/code> repo, so that you can tap it with &lt;code>brew tap thiagowfx/pancake&lt;/code>, without the need of specifying the full repository URL
as per
&lt;a href="https://docs.brew.sh/Taps#repository-naming-conventions-and-assumptions">docs&lt;/a>.
For now though, the formula is hosted in the same repository as the
executables.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>MCP: model context protocol considered harmful</title><link>https://perrotta.dev/2025/10/mcp-model-context-protocol-considered-harmful/</link><pubDate>Fri, 17 Oct 2025 13:07:03 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/mcp-model-context-protocol-considered-harmful/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/10/claude-code-adding-my-first-mcp-server/">Previously&lt;/a>.&lt;/p>
&lt;p>I configured my &lt;a href="https://www.claude.com/product/claude-code">Claude Code&lt;/a>
instance at work to include exactly 3 MCP servers:&lt;/p>
&lt;ul>
&lt;li>github&lt;/li>
&lt;li>playwright (browser automation / testing)&lt;/li>
&lt;li>atlassian (JIRA, Confluence, etc)&lt;/li>
&lt;/ul>
&lt;p>Sensible, right? It&amp;rsquo;s not like I&amp;rsquo;m a heavy user of MCPs. I mostly care about:&lt;/p>
&lt;ul>
&lt;li>PR introspection / creation&lt;/li>
&lt;li>occasional unit / integration testing in the browser&lt;/li>
&lt;li>JIRA (read access)&lt;/li>
&lt;/ul>
&lt;p>I didn&amp;rsquo;t even have the opportunity to add an MCP for Docker or Kubernetes yet.&lt;/p>
&lt;p>And yet:&lt;/p>
&lt;pre tabindex="0">&lt;code>% claude
&amp;gt; /context
 ‚éø
 Context Usage
 ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ claude-sonnet-4-5-20250929 ¬∑ 133k/200k tokens (67%)
 ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ
 ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ System prompt: 2.5k tokens (1.2%)
 ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÅ System tools: 13.8k tokens (6.9%)
 ‚õÅ ‚õÅ ‚õÅ ‚õÅ ‚õÄ ‚õÄ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õÅ MCP tools: 71.7k tokens (35.9%)
 ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õÅ Custom agents: 209 tokens (0.1%)
 ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õÅ Messages: 8 tokens (0.0%)
 ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õ∂ ‚õù ‚õù ‚õù ‚õ∂ Free space: 67k (33.4%)
 ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù Autocompact buffer: 45.0k tokens (22.5%)
 ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù ‚õù

 MCP tools ¬∑ /mcp
 ‚îî mcp__playwright__browser_close (playwright): 573 tokens
 ‚îî mcp__playwright__browser_resize (playwright): 622 tokens
 ‚îî mcp__playwright__browser_console_messages (playwright): 595 tokens
 ‚îî mcp__playwright__browser_handle_dialog (playwright): 626 tokens
 ‚îî mcp__playwright__browser_evaluate (playwright): 671 tokens
 ‚îî mcp__playwright__browser_file_upload (playwright): 626 tokens
 ‚îî mcp__playwright__browser_fill_form (playwright): 776 tokens
 ‚îî mcp__playwright__browser_install (playwright): 591 tokens
 ‚îî mcp__playwright__browser_press_key (playwright): 620 tokens
 ‚îî mcp__playwright__browser_type (playwright): 728 tokens
 ‚îî mcp__playwright__browser_navigate (playwright): 598 tokens
 ‚îî mcp__playwright__browser_navigate_back (playwright): 578 tokens
 ‚îî mcp__playwright__browser_network_requests (playwright): 580 tokens
 ‚îî mcp__playwright__browser_take_screenshot (playwright): 826 tokens
 ‚îî mcp__playwright__browser_snapshot (playwright): 584 tokens
 ‚îî mcp__playwright__browser_click (playwright): 753 tokens
 ‚îî mcp__playwright__browser_drag (playwright): 709 tokens
 ‚îî mcp__playwright__browser_hover (playwright): 636 tokens
 ‚îî mcp__playwright__browser_select_option (playwright): 684 tokens
 ‚îî mcp__playwright__browser_tabs (playwright): 652 tokens
 ‚îî mcp__playwright__browser_wait_for (playwright): 650 tokens
 ‚îî mcp__atlassian__atlassianUserInfo (atlassian): 583 tokens
 ‚îî mcp__atlassian__getAccessibleAtlassianResources (atlassian): 592 tokens
 ‚îî mcp__atlassian__getConfluenceSpaces (atlassian): 1.1k tokens
 ‚îî mcp__atlassian__getConfluencePage (atlassian): 830 tokens
 ‚îî mcp__atlassian__getPagesInConfluenceSpace (atlassian): 975 tokens
 ‚îî mcp__atlassian__getConfluencePageFooterComments (atlassian): 873 tokens
 ‚îî mcp__atlassian__getConfluencePageInlineComments (atlassian): 905 tokens
 ‚îî mcp__atlassian__getConfluencePageDescendants (atlassian): 799 tokens
 ‚îî mcp__atlassian__createConfluencePage (atlassian): 895 tokens
 ‚îî mcp__atlassian__updateConfluencePage (atlassian): 911 tokens
 ‚îî mcp__atlassian__createConfluenceFooterComment (atlassian): 834 tokens
 ‚îî mcp__atlassian__createConfluenceInlineComment (atlassian): 1.0k tokens
 ‚îî mcp__atlassian__searchConfluenceUsingCql (atlassian): 911 tokens
 ‚îî mcp__atlassian__getJiraIssue (atlassian): 869 tokens
 ‚îî mcp__atlassian__editJiraIssue (atlassian): 803 tokens
 ‚îî mcp__atlassian__createJiraIssue (atlassian): 1.2k tokens
 ‚îî mcp__atlassian__getTransitionsForJiraIssue (atlassian): 857 tokens
 ‚îî mcp__atlassian__transitionJiraIssue (atlassian): 1.3k tokens
 ‚îî mcp__atlassian__lookupJiraAccountId (atlassian): 708 tokens
 ‚îî mcp__atlassian__searchJiraIssuesUsingJql (atlassian): 856 tokens
 ‚îî mcp__atlassian__addCommentToJiraIssue (atlassian): 913 tokens
 ‚îî mcp__atlassian__getJiraIssueRemoteIssueLinks (atlassian): 919 tokens
 ‚îî mcp__atlassian__getVisibleJiraProjects (atlassian): 943 tokens
 ‚îî mcp__atlassian__getJiraProjectIssueTypesMetadata (atlassian): 794 tokens
 ‚îî mcp__atlassian__getJiraIssueTypeMetaWithFields (atlassian): 777 tokens
 ‚îî mcp__atlassian__search (atlassian): 640 tokens
 ‚îî mcp__atlassian__fetch (atlassian): 685 tokens
 ‚îî mcp__github__add_comment_to_pending_review (github): 914 tokens
 ‚îî mcp__github__add_issue_comment (github): 644 tokens
 ‚îî mcp__github__add_sub_issue (github): 701 tokens
 ‚îî mcp__github__assign_copilot_to_issue (github): 724 tokens
 ‚îî mcp__github__create_and_submit_pull_request_review (github): 708 tokens
 ‚îî mcp__github__create_branch (github): 638 tokens
 ‚îî mcp__github__create_issue (github): 732 tokens
 ‚îî mcp__github__create_or_update_file (github): 768 tokens
 ‚îî mcp__github__create_pending_pull_request_review (github): 698 tokens
 ‚îî mcp__github__create_pull_request (github): 719 tokens
 ‚îî mcp__github__create_repository (github): 661 tokens
 ‚îî mcp__github__delete_file (github): 664 tokens
 ‚îî mcp__github__delete_pending_pull_request_review (github): 650 tokens
 ‚îî mcp__github__fork_repository (github): 613 tokens
 ‚îî mcp__github__get_commit (github): 728 tokens
 ‚îî mcp__github__get_file_contents (github): 717 tokens
 ‚îî mcp__github__get_issue (github): 627 tokens
 ‚îî mcp__github__get_issue_comments (github): 690 tokens
 ‚îî mcp__github__get_label (github): 616 tokens
 ‚îî mcp__github__get_latest_release (github): 594 tokens
 ‚îî mcp__github__get_me (github): 576 tokens
 ‚îî mcp__github__get_release_by_tag (github): 634 tokens
 ‚îî mcp__github__get_tag (github): 615 tokens
 ‚îî mcp__github__get_team_members (github): 616 tokens
 ‚îî mcp__github__get_teams (github): 589 tokens
 ‚îî mcp__github__list_branches (github): 660 tokens
 ‚îî mcp__github__list_commits (github): 773 tokens
 ‚îî mcp__github__list_issue_types (github): 580 tokens
 ‚îî mcp__github__list_issues (github): 886 tokens
 ‚îî mcp__github__list_label (github): 637 tokens
 ‚îî mcp__github__list_pull_requests (github): 821 tokens
 ‚îî mcp__github__list_releases (github): 660 tokens
 ‚îî mcp__github__list_sub_issues (github): 677 tokens
 ‚îî mcp__github__list_tags (github): 661 tokens
 ‚îî mcp__github__merge_pull_request (github): 695 tokens
 ‚îî mcp__github__pull_request_read (github): 879 tokens
 ‚îî mcp__github__push_files (github): 739 tokens
 ‚îî mcp__github__remove_sub_issue (github): 671 tokens
 ‚îî mcp__github__reprioritize_sub_issue (github): 768 tokens
 ‚îî mcp__github__request_copilot_review (github): 640 tokens
 ‚îî mcp__github__search_code (github): 777 tokens
 ‚îî mcp__github__search_issues (github): 824 tokens
 ‚îî mcp__github__search_pull_requests (github): 830 tokens
 ‚îî mcp__github__search_repositories (github): 817 tokens
 ‚îî mcp__github__search_users (github): 760 tokens
 ‚îî mcp__github__submit_pending_pull_request_review (github): 719 tokens
 ‚îî mcp__github__update_issue (github): 852 tokens
 ‚îî mcp__github__update_pull_request (github): 786 tokens
 ‚îî mcp__github__update_pull_request_branch (github): 655 tokens
&lt;/code>&lt;/pre>&lt;p>The Sonnet 4 model has a context window of 200k tokens.&lt;/p>
&lt;p>These 3 MCP servers, alone, consume about one third of them. &lt;strong>36%&lt;/strong>!&lt;/p>
&lt;p>If you account for system tools + the system prompt in the mix, practically half
of the total available context window is already gone.&lt;/p>
&lt;p>MCP tool definitions are wasteful, taking valuable &lt;del>real&lt;/del> virtual estate,
distracting the model, increasing overall costs.&lt;/p>
&lt;p>&lt;img src="https://i.imgflip.com/a9djwa.jpg" alt="south park agent context window aaaand it&amp;rsquo;s gone">&lt;/p>
&lt;p>As &lt;a href="https://simonwillison.net/2025/Oct/14/agentic-engineering/">Simon Willison&lt;/a>
already noted from &lt;a href="https://steipete.me/posts/just-talk-to-it">Peter Steinberger&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>He shares my preference for CLI utilities over MCPs:&lt;/p>
&lt;blockquote>
&lt;p>I can just refer to a cli by name. I don&amp;rsquo;t need any explanation in my agents
file. The agent will try $randomcrap on the first call, the cli will present
the help menu, context now has full info how this works and from now on we
good. I don&amp;rsquo;t have to pay a price for any tools, unlike MCPs which are a
constant cost and garbage in my context. Use GitHub&amp;rsquo;s MCP and see 23k tokens
gone. Heck, they did make it better because it was almost 50.000 tokens when
it first launched. Or use the gh cli which has basically the same feature
set, models already know how to use it, and pay zero context tax.&lt;/p>
&lt;/blockquote>
&lt;/blockquote>
&lt;p>To me this feels comparable to using a full-blown desktop environment in Linux
Desktop versus rolling your tiling window manager and building from scratch
an environment tailored to your own needs.&lt;/p>
&lt;p>Stay safe from the bloat out there.&lt;/p>
&lt;p>&lt;strong>Update(2025-10-18)&lt;/strong>: See also &lt;a href="https://simonwillison.net/2025/Oct/16/claude-skills/#skills-compared-to-mcp">Skills c:ompared to
MCP&lt;/a>.&lt;/p></description></item><item><title>git: reset default branch</title><link>https://perrotta.dev/2025/10/git-reset-default-branch/</link><pubDate>Thu, 16 Oct 2025 17:20:45 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/git-reset-default-branch/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: Given an existing repository whose default branch is
&lt;code>master&lt;/code>, make it become &amp;ldquo;fresh&amp;rdquo; (=fully reset it), as if it had just been
created.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># backup the current default branch, just in case&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git branch backup-old-master
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git push origin backup-old-master
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># create an orphan branch&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git checkout --orphan temp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># remove everything ‚Äì use one or some of the following, accordingly&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git reset --hard
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rm &lt;span style="color:#56b6c2">{&lt;/span>all files&lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git rm &lt;span style="color:#56b6c2">{&lt;/span>all files&lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># create an initial commit ‚Äì c.f. https://perrotta.dev/2025/02/git-blank-commit/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git blank
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># delete the old default branch&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git branch -D master
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># rename temp to master, pick one of the following&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git rb master &lt;span style="color:#7f848e"># this is my alias for &amp;#34;rename branch&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git branch -m master &lt;span style="color:#7f848e"># the native way&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># override the current master&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git push --force origin master
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>pipx run ‚Üí uvx</title><link>https://perrotta.dev/2025/10/pipx-run-uvx/</link><pubDate>Thu, 16 Oct 2025 15:41:58 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/pipx-run-uvx/</guid><description>&lt;p>Replaced all occurrences of &lt;code>pipx run&lt;/code> in my projects with &lt;code>uvx&lt;/code>.&lt;/p>
&lt;p>&lt;a href="https://docs.astral.sh/uv/guides/tools/">&lt;code>uvx docs&lt;/code>&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>The uvx command invokes a tool without installing it.&lt;/p>
&lt;/blockquote>
&lt;p>Perfect for one-off tool executions (&amp;ldquo;one-shots&amp;rdquo;). For example:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% cat ~/.bin/az_switch
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e">#!/bin/sh&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># Switch active account in Azure&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e5c07b">exec&lt;/span> uvx az-account-switcher &lt;span style="color:#98c379">&amp;#34;&lt;/span>&lt;span style="color:#e06c75">$@&lt;/span>&lt;span style="color:#98c379">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Alpine Linux: usr-merge</title><link>https://perrotta.dev/2025/10/alpine-linux-usr-merge/</link><pubDate>Wed, 15 Oct 2025 11:16:36 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/alpine-linux-usr-merge/</guid><description>&lt;p>&lt;a href="https://alpinelinux.org/posts/2025-10-01-usr-merge.html">Alpine Linux&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>The Alpine Linux Technical Steering Committee (TSC) has decided to change the
base filesystem hierarchy. In the future, /lib, /bin, and /sbin will be
symbolic links to their /usr counterparts, and every package shall be
installed under the /usr paths. For now, /usr/bin and /usr/sbin will continue
to be independent paths, but that might change if the Filesystem Hierarchy
Standard (FHS) gets updated.&lt;/p>
&lt;/blockquote>
&lt;p>Just like Arch Linux has been doing &lt;a href="https://www.archlinux.org/news/binaries-move-to-usrbin-requiring-update-intervention/">for
ages&lt;/a>
(2013).&lt;/p>
&lt;p>Fedora also did &lt;a href="https://fedoraproject.org/wiki/Changes/Unify_bin_and_sbin">a similar
move&lt;/a> this year.&lt;/p>
&lt;p>I&amp;rsquo;ve been running Alpine Linux since 3.15 (2021), its current version is 3.22.
The migration process has been quite straightforward.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% doas apk upgrade -aU &lt;span style="color:#7f848e"># perform a full system upgrade&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% doas apk add merge-usr &lt;span style="color:#7f848e"># install the migration script&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% doas merge-usr --dryrun &lt;span style="color:#7f848e"># exec the migration script in dry-run mode&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>If the dry-run succeeds:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% doas merge-usr &lt;span style="color:#7f848e"># exec the migration script&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ doas apk del merge-usr &lt;span style="color:#7f848e"># clean up&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Fin.&lt;/p></description></item><item><title>git: partially cherry-pick a commit</title><link>https://perrotta.dev/2025/10/git-partially-cherry-pick-a-commit/</link><pubDate>Wed, 15 Oct 2025 11:08:27 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/git-partially-cherry-pick-a-commit/</guid><description>&lt;p>&lt;strong>OR&lt;/strong>: &amp;ldquo;cherry-pick a cherry-pick&amp;rdquo;.&lt;/p>
&lt;p>&lt;a href="https://adamj.eu/tech/2025/09/08/git-partial-cherry-pick/">Adam Johnson&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>git cherry-pick allows you to copy a commit another branch to your current
one.&lt;/p>
&lt;p>[&amp;hellip;]&lt;/p>
&lt;p>One limitation with a straight-up git cherry-pick, as above, is that it always
copies the entire commit. If a commit contains multiple changes, but you only
want one of them, you&amp;rsquo;ll need to undo the undesired cherry-picked changes.
This can be tedious and error-prone.&lt;/p>
&lt;/blockquote>
&lt;p>The trick is to use the &lt;a href="https://git-scm.com/docs/git-cherry-pick">&lt;code>-n&lt;/code>
(&lt;code>--no-commit&lt;/code>)&lt;/a> argument to prevent changes from
being committed right away.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% git cherry-pick -n &lt;span style="color:#56b6c2">{&lt;/span>branch or SHA&lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This happens to be the default in
&lt;a href="https://mercurial-scm.org/help/commands/graft">mercurial&lt;/a> with &lt;code>hg graft&lt;/code>.&lt;/p>
&lt;p>As such, another possibility is to create an alias:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-gitconfig" data-lang="gitconfig">[alias]
 graft = cherry-pick -n
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% git graft &lt;span style="color:#56b6c2">{&lt;/span>branch or SHA&lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>git: list branches by recent activity</title><link>https://perrotta.dev/2025/10/git-list-branches-by-recent-activity/</link><pubDate>Wed, 15 Oct 2025 10:59:58 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/git-list-branches-by-recent-activity/</guid><description>&lt;p>Tweak &lt;code>~/.gitconfig&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-gitconfig" data-lang="gitconfig">[alias]
 xl = branch -vv

[branch]
	sort = -committerdate
&lt;/code>&lt;/pre>&lt;p>&lt;strong>Result&lt;/strong>: &lt;code>git xl&lt;/code> will print your repository branches sorted by the most
recent ones in terms of activity, instead of the alphabetical default.&lt;/p>
&lt;p>I have this setting for a long time, and IMHO it&amp;rsquo;s a better default.&lt;/p>
&lt;p>&lt;a href="https://tekin.co.uk/2021/11/listing-most-recent-git-branches">This post&lt;/a> by
Tekin S√ºleyman prompted me to share it.&lt;/p></description></item><item><title>git: commit with the wrong email</title><link>https://perrotta.dev/2025/10/git-commit-with-the-wrong-email/</link><pubDate>Tue, 14 Oct 2025 13:50:36 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/git-commit-with-the-wrong-email/</guid><description>&lt;p>You are sending a PR upstream.&lt;/p>
&lt;p>You accidentally commit it with the wrong email.&lt;/p>
&lt;p>First, you prevent this mistake from happening again by updating your
&lt;code>~/.gitconfig&lt;/code>.&lt;/p>
&lt;p>And now you need to fix the most recent commit.&lt;/p>
&lt;p>You can easily do so with:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% git commit --amend --reset-author --no-edit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Alternatively, with &lt;a href="https://github.com/thiagowfx/.dotfiles">my aliases&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>git uncommit &lt;span style="color:#56b6c2">&amp;amp;&amp;amp;&lt;/span> git recommit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Random word</title><link>https://perrotta.dev/2025/10/random-word/</link><pubDate>Mon, 13 Oct 2025 11:29:08 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/random-word/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: get a random word via shell scripting. Assume a typical
Unix / POSIX environment is available.&lt;/p>
&lt;p>There are various ways to do so.&lt;/p>
&lt;h2 id="dictionary-shuffle">Dictionary shuffle&lt;/h2>
&lt;p>Pick a random word from the system dictionary:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% shuf -n &lt;span style="color:#d19a66">1&lt;/span> /usr/share/dict/words
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acrochordon
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>-n&lt;/code> controls how many words to pick.&lt;/p>
&lt;p>Or use &lt;code>sort -R&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% sort -R /usr/share/dict/words | head -n &lt;span style="color:#d19a66">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>transcurrently
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>-R&lt;/code> is &lt;code>--random-sort&lt;/code>. I am amazed that this option even exists.&lt;/p>
&lt;h2 id="gibberish">Gibberish&lt;/h2>
&lt;p>Use &lt;code>/dev/urandom&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% tr -dc &lt;span style="color:#98c379">&amp;#39;a-z&amp;#39;&lt;/span> &amp;lt; /dev/urandom | head -c &lt;span style="color:#d19a66">8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>zsdckwbs%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Use OpenSSL:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% openssl rand -base64 &lt;span style="color:#d19a66">12&lt;/span> | tr -dc &lt;span style="color:#98c379">&amp;#39;a-z&amp;#39;&lt;/span> | head -c &lt;span style="color:#d19a66">8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hfwkwqmt%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Gmail: send email from plus address</title><link>https://perrotta.dev/2025/10/gmail-send-email-from-plus-address/</link><pubDate>Sun, 12 Oct 2025 19:09:37 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/gmail-send-email-from-plus-address/</guid><description>&lt;p>It is well-known that, given &lt;code>larry@gmail.com&lt;/code>, you can use the Gmail &amp;ldquo;plus
addressing&amp;rdquo; (+) feature with &lt;code>larry+{alias}@gmail.com&lt;/code> to receive emails in the
former.&lt;/p>
&lt;p>But what if you need to &lt;em>send&lt;/em> emails from &lt;code>larry+{alias}@gmail.com&lt;/code>?&lt;/p>
&lt;p>This turns out to be &lt;a href="https://webapps.stackexchange.com/questions/3598/is-there-any-way-to-send-an-email-from-a-gmail-plus-address">possible&lt;/a>.&lt;/p>
&lt;p>Add your plus email the same way you&amp;rsquo;d add any other email to &lt;a href="https://support.google.com/mail/answer/22370">send
from&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Use case&lt;/strong>: customer support. Some systems will allow replies from &lt;em>only&lt;/em> the
email address originally used to file a support ticket.&lt;/p></description></item><item><title>git: merge two repositories</title><link>https://perrotta.dev/2025/10/git-merge-two-repositories/</link><pubDate>Sun, 12 Oct 2025 15:52:06 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/git-merge-two-repositories/</guid><description>&lt;p>Daniel Roy Greenfeld, &lt;a href="https://daniel.feldroy.com/posts/til-2025-09-merging-two-git-projects">TIL: Merging two git projects&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>Of course this task can be done with copy/paste. The challenge there is the
loss of git history. All the history of struggles and tribulations are gone.
More important is the attribution - unless any and all contributors are made
co-authors. But then the volume of attribution isn&amp;rsquo;t accurate, some one who
made one tiny change gets as much credit as the leading contributor.&lt;/p>
&lt;/blockquote>
&lt;p>Adapted to my own words: we will merge &amp;ldquo;atreides&amp;rdquo; into &amp;ldquo;harkonnen&amp;rdquo;.&lt;/p>
&lt;ul>
&lt;li>&lt;code>cd&lt;/code> to &lt;code>harkonnen&lt;/code>&lt;/li>
&lt;li>&lt;code>git remote add atreides {atreides git repo URL}&lt;/code>&lt;/li>
&lt;li>&lt;code>git fetch atreides&lt;/code> (or &lt;code>git fetch --all&lt;/code>)&lt;/li>
&lt;li>&lt;code>git merge atreides/master --allow-unrelated-histories&lt;/code> # or main, if applicable&lt;/li>
&lt;/ul>
&lt;p>Fin.&lt;/p></description></item><item><title>My favorite C compiler flags during development</title><link>https://perrotta.dev/2025/10/my-favorite-c-compiler-flags-during-development/</link><pubDate>Sun, 12 Oct 2025 15:34:19 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/my-favorite-c-compiler-flags-during-development/</guid><description>&lt;p>Chris Wellons, &lt;a href="https://nullprogram.com/blog/2023/04/29/">My favorite C compiler flags during development&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>The major compilers have an enormous number of knobs. Most are highly
specialized, but others are generally useful even if uncommon. For warnings,
the venerable &lt;code>-Wall -Wextra&lt;/code> is a good start, but circumstances
improve by tweaking this warning set. This article covers high-hitting
development-time options in GCC, Clang, and MSVC that ought to get more
consideration.&lt;/p>
&lt;p>[&amp;hellip;]&lt;/p>
&lt;p>&lt;strong>Summary&lt;/strong>:&lt;/p>
&lt;pre tabindex="0">&lt;code>$ cc -g3 -Wall -Wextra -Wconversion -Wdouble-promotion
 -Wno-unused-parameter -Wno-unused-function -Wno-sign-conversion
 -fsanitize=undefined -fsanitize-trap ...
&lt;/code>&lt;/pre>&lt;/blockquote>
&lt;p>Such a great post!&lt;/p>
&lt;p>Today I learned:&lt;/p>
&lt;blockquote>
&lt;p>Another common mistake in tutorials is using plain old -g instead of -g3
(read: &amp;ldquo;debug level 3&amp;rdquo;). That&amp;rsquo;s like using -O instead of -O3. It adds a lot
more debug information to the output, particularly enums and macros. The extra
information is useful and you&amp;rsquo;re better off having it!&lt;/p>
&lt;p>All the major build systems ‚Äî CMake, Autotools, Meson, etc. ‚Äî get this wrong
in their standard debug configurations. Producing a fully-featured debug build
from these systems is a constant battle for me. Often it&amp;rsquo;s easier to ignore
the build system entirely and cc -g3 **/*.c (plus sanitizers, etc.).&lt;/p>
&lt;/blockquote></description></item><item><title>IMEI</title><link>https://perrotta.dev/2025/10/imei/</link><pubDate>Sun, 12 Oct 2025 14:25:44 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/imei/</guid><description>&lt;p>To display the &lt;a href="https://en.wikipedia.org/wiki/International_Mobile_Equipment_Identity">IMEI&lt;/a> of your iphone, open the Phone / Dialer app and type in
&lt;code>*#06#&lt;/code>.&lt;/p>
&lt;p>The IMEI is an unique numeric identifier for &lt;em>devices&lt;/em>:&lt;/p>
&lt;blockquote>
&lt;p>GSM networks use the IMEI number to identify valid devices, and can stop a
stolen phone from accessing the network. For example, if a mobile phone is
stolen, the owner can have their network provider use the IMEI number to
blocklist the phone. This renders the phone useless on that network and
sometimes other networks, even if the thief changes the phone&amp;rsquo;s SIM card.&lt;/p>
&lt;/blockquote>
&lt;p>It is a good practice to have your IMEI stored somewhere secure, in case you
ever need to report to your carrier the phone (w)as stolen.&lt;/p>
&lt;p>If you see an EID, your device supports eSIM.&lt;/p>
&lt;p>What I didn&amp;rsquo;t know is that it&amp;rsquo;s
&lt;a href="https://en.wikipedia.org/wiki/Unstructured_Supplementary_Service_Data#Code_table">possible&lt;/a>
to change your SIM card PIN with the phone app as well:
&lt;code>**04*{old PIN}*{new PIN}*{new PIN}#&lt;/code>.&lt;/p></description></item><item><title>zoxide: fine-tuning</title><link>https://perrotta.dev/2025/10/zoxide-fine-tuning/</link><pubDate>Fri, 10 Oct 2025 15:08:11 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/zoxide-fine-tuning/</guid><description>&lt;p>&lt;a href="https://github.com/ajeetdsouza/zoxide">zoxide&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>It remembers which directories you use most frequently, so you can &amp;ldquo;jump&amp;rdquo; to them in just a few keystrokes.&lt;/p>
&lt;/blockquote>
&lt;p>For example:&lt;/p>
&lt;ul>
&lt;li>&lt;code>z perrotta.dev&lt;/code> jumps to &lt;code>~/Workspace/perrotta.dev/&lt;/code>&lt;/li>
&lt;li>&lt;code>z dotfiles&lt;/code> jumps to &lt;code>~/.dotfiles&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>I had one issue. Given these two directories:&lt;/p>
&lt;ul>
&lt;li>&lt;code>~/corp/gitops&lt;/code>&lt;/li>
&lt;li>&lt;code>~/corp/gitops-china&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>&lt;code>z gitops&lt;/code> was selecting the &lt;code>gitops-china&lt;/code> directory, which I barely use.&lt;/p>
&lt;p>In order to remove it from the frequently accessed directories list, do:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>zoxide remove ~/corp/gitops-china
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now &lt;code>z gitops&lt;/code> jumps to &lt;code>~/corp/gitops&lt;/code>, as I originally intend most of the
time.&lt;/p></description></item><item><title>Comma scripts</title><link>https://perrotta.dev/2025/10/comma-scripts/</link><pubDate>Fri, 10 Oct 2025 01:14:15 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/comma-scripts/</guid><description>&lt;p>Ricardo Ander-Egg
&lt;a href="https://ricardoanderegg.com/posts/executable-bin-scripts-instead-of-shell-aliases/">suggests&lt;/a>
to use executable scripts instead of shell aliases:&lt;/p>
&lt;blockquote>
&lt;p>I stopped using shell aliases and moved everything into executable scripts.&lt;/p>
&lt;/blockquote>
&lt;p>I&amp;rsquo;ve been slowly doing the same. From his post, adapted:&lt;/p>
&lt;p>&lt;strong>Main Benefits&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>No need to source your shell rc after adding new scripts
&lt;ul>
&lt;li>Use immediately without reloading your shell&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>No need to edit your shell rc, just drop executable files in &lt;code>$HOME/.bin&lt;/code> (already in my &lt;code>$PATH&lt;/code>)
&lt;ul>
&lt;li>Faster iteration (edit script, re-run command, repeat)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Can be used out-of-the-box with &lt;code>fd&lt;/code> / &lt;code>find&lt;/code> / &lt;code>xargs&lt;/code> and friends&lt;/li>
&lt;/ul>
&lt;p>Another recommendation:&lt;/p>
&lt;p>Brandon Rhodes: &lt;a href="https://rhodesmill.org/brandon/2009/commands-with-comma/">Start all of your commands with a comma&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>A quick experiment revealed in a flash that the comma was exactly the
character that I had been looking for! Every tool and shell that lay in arm&amp;rsquo;s
reach treated the comma as a perfectly normal and unobjectionable character in
a filename. By simply prefixing each of my custom commands with a comma, they
became completely distinct from system commands and thus free from any chance
of a collision.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>And, best of all, thanks to the magic of tab-completion, it became very easy
to browse my entire collection of commands. When trying to remember which of
my commands are available in my ~/bin/ directory on a given system, or when
simply trying to remember what some of my commands are called, I simply type a
comma followed by tab and my list of commands appears:&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>I heartily recommend this technique to anyone with their own ~/bin/ directory
who wants their command names kept clean, tidy, and completely orthogonal to
any commands that the future might bring to your system.&lt;/p>
&lt;/blockquote>
&lt;p>I used to do this with prefixes (&lt;code>t-&lt;/code> because of my first name initial, and then
&lt;a href="https://ianthehenry.com/posts/sd-my-script-directory/">&lt;code>sd-&lt;/code>&lt;/a>), but a
non-alphabetic character is more compelling.&lt;/p></description></item><item><title>Anki: find all suspended flashcards</title><link>https://perrotta.dev/2025/10/anki-find-all-suspended-flashcards/</link><pubDate>Wed, 08 Oct 2025 19:14:48 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/anki-find-all-suspended-flashcards/</guid><description>&lt;p>The following queries are useful to find flashcards (notes or cards) in
&lt;a href="https://apps.ankiweb.net/">Anki&lt;/a> that you&amp;rsquo;re struggling with.&lt;/p>
&lt;ul>
&lt;li>&lt;code>is:suspended&lt;/code>&lt;/li>
&lt;li>&lt;code>tag:leech&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>The action item for each should be one of the following:&lt;/p>
&lt;ul>
&lt;li>do nothing for now&lt;/li>
&lt;li>delete the note / card if it&amp;rsquo;s no longer relevant e.g. perhaps it is barely
used&lt;/li>
&lt;li>enhance or rewrite the note / card for better retention and then unsuspend it&lt;/li>
&lt;/ul>
&lt;p>It&amp;rsquo;s a slow process.&lt;/p></description></item><item><title>vim: reflow current paragraph</title><link>https://perrotta.dev/2025/10/vim-reflow-current-paragraph/</link><pubDate>Wed, 08 Oct 2025 18:03:57 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/vim-reflow-current-paragraph/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: Given a paragraph (&lt;code>lorem_ipsum.txt&lt;/code>):&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&amp;#34;
&lt;/code>&lt;/pre>&lt;p>Reflow it in such a way each line does not exceed a certain number of
characters, say, in the 72-80 range. The number is not important, so
long as it is applied consistently and uniformly within a single file.&lt;/p>
&lt;p>In the terminal we can achieve that with &lt;a href="https://man.archlinux.org/man/fmt.1">&lt;code>fmt(1)&lt;/code>&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% cat lorem_ipsum.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&amp;#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>thiago.perrotta@thiagoperrotta-MacBook-Pro /tmp/thiago.perrotta-2025-10-08-eOaLRg
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% fmt lorem_ipsum.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&amp;#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">cupidatat non proident, sunt in culpa qui officia deserunt mollit anim
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">id est laborum.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can also do it in-place (&lt;a href="https://man.archlinux.org/man/sponge.1">sponge(1)&lt;/a> from &lt;a href="https://perrotta.dev/2022/05/tools-you-should-know-about-moreutils/">moreutils&lt;/a>):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% fmt lorem_ipsum.txt | sponge lorem_ipsum.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% cat lorem_ipsum.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&amp;#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">cupidatat non proident, sunt in culpa qui officia deserunt mollit anim
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">id est laborum.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Can we do it within &lt;code>vim&lt;/code>? Yes, with the following mapping:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-vim" data-lang="vim">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">nnoremap&lt;/span> &amp;lt;&lt;span style="color:#e06c75">silent&lt;/span>&amp;gt; &lt;span style="color:#e06c75">W&lt;/span> &amp;lt;&lt;span style="color:#e06c75">Esc&lt;/span>&amp;gt;!&lt;span style="color:#e06c75">ipfmt&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Enter&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Translation:&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;lt;silent&amp;gt;&lt;/code>: does not echo the mapping in the vim command line&lt;/li>
&lt;li>&lt;code>&amp;lt;Esc&amp;gt;&lt;/code>: switch to normal mode&lt;/li>
&lt;li>&lt;code>!&lt;/code>: &lt;code>!{motion}{filter} Filter {motion} text lines through the external program {filter}.&lt;/code> (via &lt;code>:h !&lt;/code>).
&lt;ul>
&lt;li>Not to confound this with &lt;code>:!&lt;/code>: &lt;code>:!{cmd} Execute {cmd} with the shell. See also the 'shell' and 'shelltype' option. For the filter command, see |:range!|.&lt;/code> (via &lt;code>:h :!&lt;/code>)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>ip&lt;/code>: &amp;ldquo;inner paragraph&amp;rdquo; motion&lt;/li>
&lt;li>&lt;code>fmt&lt;/code>: the filter command&lt;/li>
&lt;li>&lt;code>&amp;lt;Enter&amp;gt;&lt;/code>: execute the command&lt;/li>
&lt;/ul>
&lt;p>Alternatively:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-vim" data-lang="vim">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">nnoremap&lt;/span> &amp;lt;&lt;span style="color:#e06c75">silent&lt;/span>&amp;gt; &lt;span style="color:#e06c75">Q&lt;/span> &lt;span style="color:#e06c75">gwip&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Wherein &lt;code>:h gw&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code>gw{motion}	Format the lines that {motion} moves over. Similar to
			|gq| but puts the cursor back at the same position in
			the text. However, &amp;#39;formatprg&amp;#39; and &amp;#39;formatexpr&amp;#39; are
			not used.
&lt;/code>&lt;/pre>&lt;p>One difference is that &lt;code>gw&lt;/code> accounts for comment characters, whereas &lt;code>fmt&lt;/code> does
not. Example, given a &lt;code>.py&lt;/code> (python) file:&lt;/p>
&lt;pre tabindex="0">&lt;code># &amp;#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&amp;#34;
&lt;/code>&lt;/pre>&lt;p>&lt;code>gw&lt;/code> does:&lt;/p>
&lt;pre tabindex="0">&lt;code># &amp;#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
# tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
# quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
# consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
# cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
# proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&amp;#34;
&lt;/code>&lt;/pre>&lt;p>Whereas &lt;code>fmt&lt;/code> does:&lt;/p>
&lt;pre tabindex="0">&lt;code># &amp;#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad
minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
ex ea commodo consequat. Duis aute irure dolor in reprehenderit in
voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur
sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt
mollit anim id est laborum.&amp;#34;
&lt;/code>&lt;/pre></description></item><item><title>Claude Code: adding my first MCP server</title><link>https://perrotta.dev/2025/10/claude-code-adding-my-first-mcp-server/</link><pubDate>Wed, 08 Oct 2025 00:31:31 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/claude-code-adding-my-first-mcp-server/</guid><description>&lt;p>Lovely readers, I promise this is not turning into an AI blog&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>. I am merely
documenting my baby steps.&lt;/p>
&lt;p>I use JIRA all the time. It&amp;rsquo;s our &lt;del>bug&lt;/del>&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup> issue tracker of choice.&lt;/p>
&lt;p>And, now that I am slowly incorporating Claude Code in my daily workflow for git
commits and pull requests, it only feels natural to connect JIRA to it, even if
only for the sake of retrieving information from existing tickets and/or adding
context to PRs.&lt;/p>
&lt;p>So here we go.&lt;/p>
&lt;p>&lt;a href="https://docs.claude.com/en/docs/claude-code/mcp">From the Anthropic documentation&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Atlassian&lt;/strong>&lt;/p>
&lt;p>Manage your Jira tickets and Confluence docs&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% &lt;span style="color:#e5c07b">cd&lt;/span> &amp;lt;gitops project&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% claude mcp add --transport sse atlassian https://mcp.atlassian.com/v1/sse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Added SSE MCP server atlassian with URL: https://mcp.atlassian.com/v1/sse to &lt;span style="color:#e5c07b">local&lt;/span> config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>File modified: /Users/thiago.perrotta/.claude.json &lt;span style="color:#56b6c2">[&lt;/span>project: /Users/thiago.perrotta/gitops&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://docs.claude.com/en/docs/claude-code/mcp#option-2%3A-add-a-remote-sse-server">SSE&lt;/a> stands for &amp;ldquo;Server-Side Events&amp;rdquo;:&lt;/p>
&lt;blockquote>
&lt;p>SSE (Server-Sent Events) servers provide real-time streaming connections. Many
cloud services use this for live updates.&lt;/p>
&lt;/blockquote>
&lt;p>That command is idempotent:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% claude mcp add --transport sse atlassian https://mcp.atlassian.com/v1/sse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>MCP server atlassian already exists in &lt;span style="color:#e5c07b">local&lt;/span> config
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>What if I want to have it available for all projects? Use &lt;code>--scope user&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% claude mcp add --scope user --transport sse atlassian https://mcp.atlassian.com/v1/sse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Added SSE MCP server atlassian with URL: https://mcp.atlassian.com/v1/sse to user config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>File modified: /Users/thiago.perrotta/.claude.json
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The modification to &lt;code>~/.claude.json&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [...]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;#34;mcpServers&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;#34;atlassian&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;#34;type&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;sse&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;#34;url&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;https://mcp.atlassian.com/v1/sse&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>So far so good. However no auth config was supplied yet.&lt;/p>
&lt;pre tabindex="0">&lt;code>% claude
&amp;gt; /mcp
Manage MCP servers
‚ùØ 1. atlassian ‚ñ≥ disconnected ¬∑ Enter to login
&lt;/code>&lt;/pre>&lt;p>After pressing Enter and authenticating against our JIRA instance in a web
browser:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% claude mcp list
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Checking MCP server health...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>atlassian: https://mcp.atlassian.com/v1/sse &lt;span style="color:#56b6c2">(&lt;/span>SSE&lt;span style="color:#56b6c2">)&lt;/span> - ‚úì Connected
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% claude mcp get atlassian
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>atlassian:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Scope: User config &lt;span style="color:#56b6c2">(&lt;/span>available in all your projects&lt;span style="color:#56b6c2">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Status: ‚úì Connected
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Type: sse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> URL: https://mcp.atlassian.com/v1/sse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>To remove this server, run: claude mcp remove &lt;span style="color:#98c379">&amp;#34;atlassian&amp;#34;&lt;/span> -s user
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>&amp;gt; /mcp
Atlassian MCP Server

Status: ‚úî connected ‚úî authenticated
URL: https://mcp.atlassian.com/v1/sse
Config location: /Users/thiago.perrotta/.claude.json [project: /Users/thiago.perrotta/gitops]
Capabilities: tools
Tools: 27 tools

‚ùØ 1. View tools
 2. Re-authenticate
 3. Clear authentication
 4. Reconnect
 5. Disable
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>Tools for atlassian (27 tools)

‚ùØ 1. Get current user information read-only
 2. List accessible resources read-only
 3. List Confluence spaces read-only
 4. Retrieve Confluence page read-only
‚Üì 5. List space pages read-only
&lt;/code>&lt;/pre>&lt;p>Let&amp;rsquo;s say I want to call the &amp;ldquo;Get current user information&amp;rdquo; tool.&lt;/p>
&lt;pre tabindex="0">&lt;code>Get current user information (atlassian) [read-only]

Tool name: atlassianUserInfo
Full name: mcp__atlassian__atlassianUserInfo

Description:
Get current user info from Atlassian
&lt;/code>&lt;/pre>&lt;p>Just describe it in natural language:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Prompt&lt;/strong>: &amp;ldquo;current user in JIRA&amp;rdquo;&lt;/li>
&lt;li>&lt;strong>Claude&lt;/strong>:&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>&amp;gt; current user in JIRA
 ‚éø {
 &amp;#34;account_id&amp;#34;: &amp;#34;{redacted}&amp;#34;,
 &amp;#34;email&amp;#34;: &amp;#34;{redacted}&amp;#34;,
 ‚Ä¶ +22 lines (ctrl+o to expand)

‚è∫ Thiago Perrotta
 - Email: {redacted}
 - Account ID: {redacted}
 - Role: {redacted}
 - Department: {redacted}
 - Location: {redacted}
&lt;/code>&lt;/pre>&lt;p>Then I tried basic CRUD operations in natural language:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Prompt&lt;/strong>: &amp;ldquo;create an issue&amp;rdquo; - create: followed by further prompts with issue details ‚úÖ&lt;/li>
&lt;li>&lt;strong>Prompt&lt;/strong>: &amp;ldquo;transition the issue to won&amp;rsquo;t do&amp;rdquo; ‚Äì update / delete ‚úÖ&lt;/li>
&lt;li>&lt;strong>Prompt&lt;/strong>: &amp;ldquo;find an issue related to foo deployment in cluster bar&amp;rdquo;) ‚Äì read ‚úÖ&lt;/li>
&lt;/ul>
&lt;p>Everything worked successfully.&lt;/p>
&lt;p>I also tried:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Prompt&lt;/strong> (plan mode on, thinking enabled): Propose a way to handle https://{corp}.atlassian.net/browse/INFRA-12528.&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>‚è∫ I&amp;rsquo;ll fetch the details of the Jira issue to understand what needs to be handled.&lt;/p>
&lt;/blockquote>
&lt;p>I feel this will be quite useful from now on!&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>For now?!?&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>I blame &lt;em>Google&lt;/em>, the corporation, for getting me accustomed to saying
&amp;ldquo;file a bug&amp;rdquo; and &amp;ldquo;bug tracker&amp;rdquo;. Not every ticket is a bug. Atlassian is
trying to shovel the &amp;ldquo;work item&amp;rdquo; term onto us, but &amp;ldquo;issue&amp;rdquo; is the
appropriate concept.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Post-its in the laptop</title><link>https://perrotta.dev/2025/10/post-its-in-the-laptop/</link><pubDate>Tue, 07 Oct 2025 22:26:03 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/post-its-in-the-laptop/</guid><description>&lt;p>Poor man&amp;rsquo;s TODO list / task manager: sticking post-it notes in&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> the laptop,
next to the touchpad / trackpad. It is practically impossible to ignore them!&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;em>On&lt;/em> the surface of the keyboard, not outside its lid case. &amp;ldquo;In&amp;rdquo; feels
appropriate because it refers to the &lt;em>inside&lt;/em> of the laptop. And now the
footnote is longer than the post!&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>macOS homebrew: downgrade a package</title><link>https://perrotta.dev/2025/10/macos-homebrew-downgrade-a-package/</link><pubDate>Tue, 07 Oct 2025 10:47:02 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/macos-homebrew-downgrade-a-package/</guid><description>&lt;p>Yesterday we could no longer ssh to deploy servers (via a ruby-based wrapper we
use).&lt;/p>
&lt;p>This was bad‚Ñ¢.&lt;/p>
&lt;p>The error message looked like this:&lt;/p>
&lt;pre tabindex="0">&lt;code>[...]
Seahorse::Client::NetworkingError: SSL_connect returned=1 errno=0 peeraddr={redacted}:443 state=error: certificate verify failed (unable to get certificate CRL)
/Users/thiago.perrotta/.rbenv/versions/3.2.4/lib/ruby/3.2.0/net/protocol.rb:46:in `connect_nonblock&amp;#39;
/Users/thiago.perrotta/.rbenv/versions/3.2.4/lib/ruby/3.2.0/net/protocol.rb:46:in `ssl_socket_connect&amp;#39;
/Users/thiago.perrotta/.rbenv/versions/3.2.4/lib/ruby/3.2.0/net/http.rb:1674:in `connect&amp;#39;
/Users/thiago.perrotta/.rbenv/versions/3.2.4/lib/ruby/3.2.0/net/http.rb:1580:in `do_start&amp;#39;
/Users/thiago.perrotta/.rbenv/versions/3.2.4/lib/ruby/3.2.0/net/http.rb:1575:in `start&amp;#39;
/Users/thiago.perrotta/.rbenv/versions/3.2.4/lib/ruby/3.2.0/delegate.rb:87:in `method_missing&amp;#39;
[...]
&lt;/code>&lt;/pre>&lt;p>It was an error in OpenSSL.&lt;/p>
&lt;p>There had been a new release a few days earlier,
&lt;a href="https://github.com/openssl/openssl/releases/tag/openssl-3.6.0">3.6.0&lt;/a>.&lt;/p>
&lt;p>Suspicious!&lt;/p>
&lt;p>In order to restore our ability to ssh to deploy servers as quickly as possible,
we decided to downgrade to 3.5.&lt;/p>
&lt;p>This proved to be a bit more painful than it should have been in 2025:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew install openssl@3.5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>brew pin openssl@3.5 &lt;span style="color:#7f848e"># prevent upgrades&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>brew uninstall --ignore-dependencies openssl@3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>--ignore-dependencies&lt;/code> is needed because there is a ton of packages that depend
on OpenSSL.&lt;/p>
&lt;p>This is not enough.&lt;/p>
&lt;p>Using our ruby-based tool to ssh into servers would yield another error. The
tool was still trying to use OpenSSL 3.6.0, as the library paths were
hard-coded. Ugh.&lt;/p>
&lt;p>New attempt:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>rbenv install 3.3.9 &lt;span style="color:#7f848e"># compile / install a new version of ruby -&amp;gt; it will link against OpenSSL 3.5&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">$EDITOR&lt;/span> &amp;lt;mulch&amp;gt;/.ruby-version &lt;span style="color:#7f848e"># upgrade to the version above&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Installing a new version of ruby ends up compiling / linking libraries against
OpenSSL 3.5. Now we regained the ability to ssh.&lt;/p>
&lt;p>Now let&amp;rsquo;s investigate the root cause.&lt;/p>
&lt;p>There was no bug report in homebrew.&lt;/p>
&lt;p>Next: OpenSSL. &lt;a href="https://github.com/openssl/openssl/issues/28758">#28758&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>OpenSSL 3.6.0 results in error: certificate verify failed (unable to get certificate CRL) #28758&lt;/p>
&lt;/blockquote>
&lt;p>Yes! That&amp;rsquo;s the one.&lt;/p>
&lt;p>From there, someone linked to
&lt;a href="https://github.com/ruby/openssl/issues/949">&lt;code>ruby/openssl&lt;/code>&lt;/a> (a core gem), which
was precisely the issue we were having.&lt;/p>
&lt;p>There was another workaround in that thread, but we didn&amp;rsquo;t need it.&lt;/p>
&lt;p>Eventually a fix was
&lt;a href="https://github.com/ruby/openssl/issues/949#issuecomment-3370358680">released&lt;/a>.&lt;/p>
&lt;p>I thought to run &lt;code>gem update openssl&lt;/code> (or similar) to incorporate it, but it
turned out that &lt;code>openssl&lt;/code> is a system gem, therefore it was not listed in our
&lt;code>Gemfile.lock&lt;/code>.&lt;/p>
&lt;p>A workaround: explicitly add it to our &lt;code>gemspec&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ruby" data-lang="ruby">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">spec&lt;/span>&lt;span style="color:#56b6c2">.&lt;/span>&lt;span style="color:#e06c75">add_runtime_dependency&lt;/span> &lt;span style="color:#98c379">&amp;#39;openssl&amp;#39;&lt;/span>, &lt;span style="color:#98c379">&amp;#39;~&amp;gt; 3.2.2&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then run &lt;code>bundle install&lt;/code>.&lt;/p>
&lt;p>Now everything works. We can undo the original workaround:&lt;/p>
&lt;pre tabindex="0">&lt;code>brew unpin openssl@3.5
brew uninstall openssl@3.5
brew install openssl@3
&lt;/code>&lt;/pre></description></item><item><title>claude code: custom commands</title><link>https://perrotta.dev/2025/10/claude-code-custom-commands/</link><pubDate>Mon, 06 Oct 2025 17:31:30 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/10/claude-code-custom-commands/</guid><description>&lt;p>&lt;a href="https://www.claude.com/product/claude-code">Claude Code&lt;/a> supports &lt;a href="https://docs.claude.com/en/docs/claude-code/slash-commands#custom-slash-commands">custom commands&lt;/a>.&lt;/p>
&lt;p>The precise term is &amp;ldquo;custom slash commands&amp;rdquo;:&lt;/p>
&lt;blockquote>
&lt;p>Custom slash commands allow you to define frequently-used prompts as Markdown
files that Claude Code can execute. Commands are organized by scope
(project-specific or personal) and support namespacing through directory
structures.&lt;/p>
&lt;/blockquote>
&lt;p>I created my first custom slash command:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% cat ~/.claude/commands/send-pr.md
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>You are a world-class software developer who can write concise and descriptive
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pull requests &lt;span style="color:#56b6c2">(&lt;/span>PRs&lt;span style="color:#56b6c2">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Sources of inspiration include:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- Daniel Stenberg &lt;span style="color:#56b6c2">(&lt;/span>curl&lt;span style="color:#56b6c2">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- Junio Hamano &lt;span style="color:#56b6c2">(&lt;/span>git&lt;span style="color:#56b6c2">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- Linus Torvalds &lt;span style="color:#56b6c2">(&lt;/span>linux&lt;span style="color:#56b6c2">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Send out a PR&lt;span style="color:#56b6c2">[&lt;/span>1&lt;span style="color:#56b6c2">]&lt;/span> corresponding to the current branch.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>If there&lt;span style="color:#98c379">&amp;#39;s a .github/PULL_REQUEST_TEMPLATE.md file, use it as template.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">If the current branch is &amp;#39;&lt;/span>main&lt;span style="color:#98c379">&amp;#39; or &amp;#39;&lt;/span>master&lt;span style="color:#98c379">&amp;#39;, create a local branch first.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">The branch name should be prefixed by my github username[2] and a slash.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">[1]: &amp;#39;&lt;/span>gh pr create&lt;span style="color:#98c379">&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">[2]: &amp;#39;&lt;/span>gh api user --jq .login&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>It can be &amp;ldquo;executed&amp;rdquo; with &lt;code>/send-pr&lt;/code>.&lt;/p>
&lt;p>&amp;ldquo;Execution&amp;rdquo; is merely &amp;ldquo;sending the prompt&amp;rdquo;.&lt;/p>
&lt;p>It&amp;rsquo;s akin to a snippet expander. Arguably one could do the same by setting a
&lt;code>:send-pr&lt;/code> snippet on e.g. &lt;a href="https://espanso.org/">Espanso&lt;/a>.&lt;/p>
&lt;p>Perhaps it is even better, as it would work with all CLI agents ‚Äì not only
Claude Code. Well, we keep on experimenting.&lt;/p>
&lt;p>Reusable custom slash commands will be shared in my &lt;a href="https://github.com/thiagowfx/.dotfiles/tree/master/claude/.claude/commands">.dotfiles&lt;/a>.&lt;/p></description></item></channel></rss>
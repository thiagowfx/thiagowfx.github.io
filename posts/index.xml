<?xml version="1.0" encoding="utf-8" standalone="yes"?><?xml-stylesheet type="text/xsl" href="https://perrotta.dev//rss.xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>¬ just serendipity 🍀</title><link>https://perrotta.dev/posts/</link><description>Recent content on ¬ just serendipity 🍀</description><generator>Hugo</generator><language>en-us</language><managingEditor>serendipity@perrotta.dev (Thiago Perrotta)</managingEditor><webMaster>serendipity@perrotta.dev (Thiago Perrotta)</webMaster><copyright>© 2021 - 2025 Thiago Perrotta ·
[some rights reserved](https://creativecommons.org/licenses/by-nc-sa/4.0/) ·
a fork of [hugo ʕ•ᴥ•ʔ bear](https://github.com/janraasch/hugo-bearblog/)</copyright><lastBuildDate>Fri, 05 Sep 2025 18:10:33 +0200</lastBuildDate><atom:link href="https://perrotta.dev/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>kubectl: verbose logging</title><link>https://perrotta.dev/2025/09/kubectl-verbose-logging/</link><pubDate>Fri, 05 Sep 2025 18:10:33 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/09/kubectl-verbose-logging/</guid><description>&lt;p>When running &lt;code>kubectl&lt;/code> commands, to get a glimpse of what is happening under the
hood, pass &lt;code>-v={N}&lt;/code> to it.&lt;/p>
&lt;p>For example:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% kubectl get pod -n argocd -v&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#d19a66">6&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>I0905 16:10:19.893576 &lt;span style="color:#d19a66">3929356&lt;/span> loader.go:395&lt;span style="color:#56b6c2">]&lt;/span> Config loaded from file: /home/ubuntu/.kube/config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>I0905 16:10:19.919935 &lt;span style="color:#d19a66">3929356&lt;/span> round_trippers.go:553&lt;span style="color:#56b6c2">]&lt;/span> GET https://&lt;span style="color:#56b6c2">{&lt;/span>REDACTED&lt;span style="color:#56b6c2">}&lt;/span>.us-east-1.elb.amazonaws.com/api/v1/namespaces/argocd/pods?limit&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#d19a66">500&lt;/span> &lt;span style="color:#d19a66">200&lt;/span> OK in &lt;span style="color:#d19a66">17&lt;/span> milliseconds
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argo-workflows-server-6ffcfbb779-kxdzk 1/1 Running &lt;span style="color:#d19a66">0&lt;/span> 4d18h
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argo-workflows-workflow-controller-85c667cf96-rm9dw 1/1 Running &lt;span style="color:#d19a66">0&lt;/span> 2d4h
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argocd-application-controller-0 1/1 Running &lt;span style="color:#d19a66">0&lt;/span> 48m
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">[&lt;/span>...&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>-v=10&lt;/code> is super verbose. Fine-tune as needed.&lt;/p>
&lt;p>Another example:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% kubectl get deploy -n argocd -w -v6
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>I0905 16:12:49.277471 &lt;span style="color:#d19a66">3929550&lt;/span> loader.go:395&lt;span style="color:#56b6c2">]&lt;/span> Config loaded from file: /home/ubuntu/.kube/config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>I0905 16:12:49.302783 &lt;span style="color:#d19a66">3929550&lt;/span> round_trippers.go:553&lt;span style="color:#56b6c2">]&lt;/span> GET https://&lt;span style="color:#56b6c2">{&lt;/span>REDACTED&lt;span style="color:#56b6c2">}&lt;/span>.us-east-1.elb.amazonaws.com/apis/apps/v1/namespaces/argocd/deployments?limit&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#d19a66">500&lt;/span> &lt;span style="color:#d19a66">200&lt;/span> OK in &lt;span style="color:#d19a66">17&lt;/span> milliseconds
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NAME READY UP-TO-DATE AVAILABLE AGE
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argo-workflows-server 1/1 &lt;span style="color:#d19a66">1&lt;/span> &lt;span style="color:#d19a66">1&lt;/span> 91d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argo-workflows-workflow-controller 1/1 &lt;span style="color:#d19a66">1&lt;/span> &lt;span style="color:#d19a66">1&lt;/span> 44d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argocd-applicationset-controller 1/1 &lt;span style="color:#d19a66">1&lt;/span> &lt;span style="color:#d19a66">1&lt;/span> 23d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argocd-dex-server 1/1 &lt;span style="color:#d19a66">1&lt;/span> &lt;span style="color:#d19a66">1&lt;/span> 451d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argocd-notifications-controller 1/1 &lt;span style="color:#d19a66">1&lt;/span> &lt;span style="color:#d19a66">1&lt;/span> 449d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argocd-redis 1/1 &lt;span style="color:#d19a66">1&lt;/span> &lt;span style="color:#d19a66">1&lt;/span> 451d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argocd-repo-server 1/1 &lt;span style="color:#d19a66">1&lt;/span> &lt;span style="color:#d19a66">1&lt;/span> 451d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>argocd-server 3/3 &lt;span style="color:#d19a66">3&lt;/span> &lt;span style="color:#d19a66">3&lt;/span> 428d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>I0905 16:12:49.316961 &lt;span style="color:#d19a66">3929550&lt;/span> round_trippers.go:553&lt;span style="color:#56b6c2">]&lt;/span> GET https://&lt;span style="color:#56b6c2">{&lt;/span>REDACTED&lt;span style="color:#56b6c2">}&lt;/span>.us-east-1.elb.amazonaws.com/apis/apps/v1/namespaces/argocd/deployments?resourceVersion&lt;span style="color:#56b6c2">=&lt;/span>695374153&amp;amp;&lt;span style="color:#e06c75">watch&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#e5c07b">true&lt;/span> &lt;span style="color:#d19a66">200&lt;/span> OK in &lt;span style="color:#d19a66">2&lt;/span> milliseconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Uninstall Kyverno</title><link>https://perrotta.dev/2025/09/uninstall-kyverno/</link><pubDate>Fri, 05 Sep 2025 17:03:04 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/09/uninstall-kyverno/</guid><description>&lt;p>It&amp;rsquo;s always a bit frustrating to do it.&lt;/p>
&lt;p>Despite the excellent &lt;a href="https://kyverno.io/docs/installation/uninstallation/">upstream
documentation&lt;/a>, our
Kubernetes clusters often leave cruft behind when doing so.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% kubectl rollout restart sts -n argocd argocd-redis-ha-server
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>E0905 12:29:24.284879 &lt;span style="color:#d19a66">3908207&lt;/span> memcache.go:287&lt;span style="color:#56b6c2">]&lt;/span> couldn&lt;span style="color:#98c379">&amp;#39;t get resource list for wgpolicyk8s.io/v1alpha2: the server is currently unable to handle the request
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">E0905 12:29:24.287856 3908207 memcache.go:287] couldn&amp;#39;&lt;/span>t get resource list &lt;span style="color:#c678dd">for&lt;/span> reports.kyverno.io/v1: the server is currently unable to handle the request
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>E0905 12:29:24.290250 &lt;span style="color:#d19a66">3908207&lt;/span> memcache.go:121&lt;span style="color:#56b6c2">]&lt;/span> couldn&lt;span style="color:#98c379">&amp;#39;t get resource list for reports.kyverno.io/v1: the server is currently unable to handle the request
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">E0905 12:29:24.292666 3908207 memcache.go:121] couldn&amp;#39;&lt;/span>t get resource list &lt;span style="color:#c678dd">for&lt;/span> wgpolicyk8s.io/v1alpha2: the server is currently unable to handle the request
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>E0905 12:29:24.295959 &lt;span style="color:#d19a66">3908207&lt;/span> memcache.go:121&lt;span style="color:#56b6c2">]&lt;/span> couldn&lt;span style="color:#98c379">&amp;#39;t get resource list for reports.kyverno.io/v1: the server is currently unable to handle the request
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">E0905 12:29:24.298226 3908207 memcache.go:121] couldn&amp;#39;&lt;/span>t get resource list &lt;span style="color:#c678dd">for&lt;/span> wgpolicyk8s.io/v1alpha2: the server is currently unable to handle the request
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>E0905 12:29:24.302703 &lt;span style="color:#d19a66">3908207&lt;/span> memcache.go:121&lt;span style="color:#56b6c2">]&lt;/span> couldn&lt;span style="color:#98c379">&amp;#39;t get resource list for reports.kyverno.io/v1: the server is currently unable to handle the request
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">E0905 12:29:24.305009 3908207 memcache.go:121] couldn&amp;#39;&lt;/span>t get resource list &lt;span style="color:#c678dd">for&lt;/span> wgpolicyk8s.io/v1alpha2: the server is currently unable to handle the request
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">[&lt;/span>...&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>That output junk is emitted on every &lt;code>kubectl&lt;/code> command.&lt;/p>
&lt;p>This time the culprit was:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% kubectl get apiservice | egrep -i &lt;span style="color:#98c379">&amp;#34;(kyverno|wgpolicy)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>v1.reports.kyverno.io reports-server/kyverno-reports-server False &lt;span style="color:#56b6c2">(&lt;/span>MissingEndpoints&lt;span style="color:#56b6c2">)&lt;/span> 76d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>v1alpha2.wgpolicyk8s.io reports-server/kyverno-reports-server False &lt;span style="color:#56b6c2">(&lt;/span>MissingEndpoints&lt;span style="color:#56b6c2">)&lt;/span> 76d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Deleting these two entries resolves the issue:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% kubectl delete apiservice v1.reports.kyverno.io v1alpha2.wgpolicyk8s.io -n reports-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>JSON pointers: escaping</title><link>https://perrotta.dev/2025/09/json-pointers-escaping/</link><pubDate>Thu, 04 Sep 2025 16:00:47 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/09/json-pointers-escaping/</guid><description>&lt;p>&lt;a href="https://www.rfc-editor.org/rfc/rfc6901">RFC 6901: JSON Pointers&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>JSON Pointer defines a string syntax for identifying a specific value within a
JavaScript Object Notation (JSON) document.&lt;/p>
&lt;/blockquote>
&lt;p>I wanted to point out to a key named &lt;code>metadata -&amp;gt; annotations -&amp;gt; argocd.argoproj.io/tracking-id&lt;/code>, wherein the arrows represent nesting.&lt;/p>
&lt;p>There&amp;rsquo;s a problem: the slash (&lt;code>/&lt;/code>) cannot be used as is, it needs to be escaped.
And I always seem to forget how to escape it&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.&lt;/p>
&lt;p>&lt;strong>&lt;a href="https://www.rfc-editor.org/rfc/rfc6901#section-3">Cheatsheet&lt;/a>&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>&lt;code>~&lt;/code> -&amp;gt; &lt;code>~0&lt;/code>&lt;/li>
&lt;li>&lt;code>/&lt;/code> -&amp;gt; &lt;code>~1&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Real-world usage, from &lt;a href="https://argo-cd.readthedocs.io/en/stable/user-guide/diffing/">ArgoCD ignore differences&lt;/a>:&lt;/p>
&lt;pre tabindex="0">&lt;code>spec:
 ignoreDifferences:
 [...]
 # Workaround for a sync loop in External Secrets: https://github.com/argoproj/argo-cd/issues/18980
 - kind: Secret
 namespace: argocd
 jsonPointers:
 - /metadata/annotations/argocd.argoproj.io~1tracking-id
&lt;/code>&lt;/pre>&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>No, it&amp;rsquo;s not with a backslash (&lt;code>\/&lt;/code>). That I can remember!&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>claude: compact context</title><link>https://perrotta.dev/2025/09/claude-compact-context/</link><pubDate>Thu, 04 Sep 2025 15:00:57 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/09/claude-compact-context/</guid><description>&lt;p>These days, Claude Code warns you when you&amp;rsquo;re running &lt;a href="https://claudelog.com/faqs/what-is-claude-code-auto-compact/">out of
context&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>Context left until auto-compact: 5%&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>How Auto-Compact Works&lt;/p>
&lt;p>When your conversation approaches the context window limit, Claude Code
automatically:&lt;/p>
&lt;ol>
&lt;li>Analyzes the conversation to identify key information worth preserving&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;blockquote>
&lt;ol start="2">
&lt;li>Creates a concise summary of previous interactions, decisions, and code
changes&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;blockquote>
&lt;ol start="3">
&lt;li>Compacts the conversation by replacing old messages with the summary&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;blockquote>
&lt;ol start="4">
&lt;li>Continues seamlessly with the preserved context&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;p>It&amp;rsquo;s possible to run &lt;code>/compact&lt;/code> manually to compact the context sooner&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Let the machine do the garbage collection though! Why would you bother to
do so manually?&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>claude: ccusage</title><link>https://perrotta.dev/2025/09/claude-ccusage/</link><pubDate>Thu, 04 Sep 2025 14:55:15 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/09/claude-ccusage/</guid><description>&lt;p>&lt;a href="https://github.com/ryoppippi/ccusage">&lt;code>ccusage&lt;/code>&lt;/a> via &lt;a href="https://simonwillison.net/2025/Jul/14/ccusage/">Simon
Willison&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>Claude Code logs detailed usage information to the &lt;code>~/.claude/&lt;/code> directory.
&lt;code>ccusage&lt;/code> is a neat little Node.js tool which reads that information and shows
you a readable summary of your usage patterns, including the estimated cost in
USD per day.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>A CLI tool for analyzing Claude Code usage from local JSONL files.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>Usage&lt;/strong>:&lt;/p>
&lt;pre tabindex="0">&lt;code>% npx ccusage@latest
Need to install the following packages:
ccusage@16.2.3
Ok to proceed? (y)


 WARN Fetching latest model pricing from LiteLLM...

ℹ Loaded pricing for 1544 models

 ╭──────────────────────────────────────────╮
 │ │
 │ Claude Code Token Usage Report - Daily │
 │ │
 ╰──────────────────────────────────────────╯

┌────────────┬───────────────┬───────────┬───────────┬───────────────┬─────────────┬───────────────┬─────────────┐
│ Date │ Models │ Input │ Output │ Cache Create │ Cache Read │ Total Tokens │ Cost (USD) │
├────────────┼───────────────┼───────────┼───────────┼───────────────┼─────────────┼───────────────┼─────────────┤
│ 2025-08-05 │ - sonnet-4 │ 896 │ 30,430 │ 303,782 │ 7,232,685 │ 7,567,793 │ $3.77 │
├────────────┼───────────────┼───────────┼───────────┼───────────────┼─────────────┼───────────────┼─────────────┤
│ 2025-08-11 │ - sonnet-4 │ 58 │ 5,870 │ 83,682 │ 1,024,297 │ 1,113,907 │ $0.71 │
├────────────┼───────────────┼───────────┼───────────┼───────────────┼─────────────┼───────────────┼─────────────┤
│ 2025-08-12 │ - sonnet-4 │ 42 │ 6,758 │ 116,661 │ 777,241 │ 900,702 │ $0.77 │
[...]
&lt;/code>&lt;/pre>&lt;p>Neat!&lt;/p></description></item><item><title>GitHub: disable dependabot CLI notifications</title><link>https://perrotta.dev/2025/09/github-disable-dependabot-cli-notifications/</link><pubDate>Wed, 03 Sep 2025 10:51:49 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/09/github-disable-dependabot-cli-notifications/</guid><description>&lt;p>Good morning!&lt;/p>
&lt;pre tabindex="0">&lt;code>% git push
Enumerating objects: 1, done.
Counting objects: 100% (1/1), done.
Writing objects: 100% (1/1), 189 bytes | 189.00 KiB/s, done.
Total 1 (delta 0), reused 0 (delta 0), pack-reused 0 (from 0)
remote:
remote: GitHub found 247 vulnerabilities on org/repo&amp;#39;s default branch (8 critical, 86 high, 92 moderate, 61 low). To find out more, visit:
remote: https://github.com/org/repo/security/dependabot
[...]
&lt;/code>&lt;/pre>&lt;p>These are simply non-actionable by our team; we have a dedicated security team
to look into these matters. Even worse: the constant output makes us accustomed
to it, until it becomes background noise.&lt;/p>
&lt;p>GitHub allows us to
&lt;a href="https://docs.github.com/en/code-security/dependabot/dependabot-alerts/configuring-notifications-for-dependabot-alerts#configuring-notifications-for-dependabot-alerts">disable&lt;/a>
these CLI notifications: Settings &amp;gt; Notifications&lt;/p>
&lt;blockquote>
&lt;p>System &amp;gt; &amp;ldquo;Dependabot alerts: New vulnerabilities&amp;rdquo; &amp;gt; &amp;ldquo;Notify me&amp;rdquo;: &amp;ldquo;on GitHub&amp;rdquo;
only.&lt;/p>
&lt;/blockquote></description></item><item><title>claude --resume</title><link>https://perrotta.dev/2025/09/claude--resume/</link><pubDate>Tue, 02 Sep 2025 14:12:07 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/09/claude--resume/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: when working with &lt;a href="https://www.anthropic.com/claude-code">&lt;code>Claude Code&lt;/code>&lt;/a>, how to resume a session after
terminating the &lt;code>claude&lt;/code> process?&lt;/p>
&lt;p>Of course we could simply prompt the LLM agent again, but that is both (i) slow
and (ii) expensive. And I do not want to get into the intricacies of &lt;a href="https://docs.anthropic.com/en/docs/build-with-claude/prompt-caching">prompt
caching&lt;/a>.&lt;/p>
&lt;p>The ability to &lt;a href="https://github.com/anthropics/claude-code/issues/371">resume old
sessions&lt;/a> was recently
added. The tool has great defaults: by default, you see only sessions pertaining
to the directory you&amp;rsquo;re working on.&lt;/p>
&lt;p>For example, when I run it in my blog directory:&lt;/p>
&lt;pre tabindex="0">&lt;code>% claude --resume
 Modified Created # Messages Git Branch Summary
❯ 1. 1 week ago 1 week ago 148 master I would like to create a second RSS feed, for...…
 2. 1 week ago 1 week ago 113 master Ensure images respect the page width and do n...…
 3. 1 week ago 1 week ago 31 master Update XSLT. By: should be properly linkified…
 4. 1 week ago 1 week ago 12 master Add space after By: and Published: in the XSL...…
 5. 1 week ago 1 week ago 20 master Hugo XML Link Syntax Troubleshooting…
 6. 1 week ago 1 week ago 119 rss Create a XSLT for my RSS feed (this is a hugo...…
 7. 1 week ago 1 week ago 42 rss Hugo RSS XSLT Theme Styling and Design Match…
&lt;/code>&lt;/pre>&lt;p>When I run it from another directory:&lt;/p>
&lt;pre tabindex="0">&lt;code>% claude --resume
 Modified Created # Messages Git Branch Summary
❯ 1. 4m ago 8m ago 14 thiagowfx/miss Print out the dates in YYYY-MM-DD form in the...…
 2. 5m ago 12m ago 78 thiagowfx/miss Angular Date Filter Component Implementation…
 3. 14m ago 22m ago 78 thiagowfx/miss Do not allow whitespace in instance names in ...…
 4. 22m ago 46m ago 191 thiagowfx/miss Whitespace Trim Testing: Comprehensive React Unit Suite…
&lt;/code>&lt;/pre></description></item><item><title>Trash</title><link>https://perrotta.dev/2025/09/trash/</link><pubDate>Mon, 01 Sep 2025 15:37:50 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/09/trash/</guid><description>&lt;p>When using file managers, we&amp;rsquo;re used to moving files to the Trash instead of
deleting them immediately from our systems&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>. This is an universal pattern across
all major operating systems.&lt;/p>
&lt;p>When using the command line, we&amp;rsquo;re conditioned to using &lt;code>rm&lt;/code> for files and &lt;code>rm -r&lt;/code> for directories. This provides no chance for regret on accidental deletions.&lt;/p>
&lt;p>An evolution of this pattern is to use &lt;code>trash&lt;/code> in the command-line as well.&lt;/p>
&lt;p>Newer versions of macOS (&lt;a href="https://mjtsai.com/blog/2025/08/26/the-trash-command/">since
14&lt;/a>) come with
&lt;code>/usr/bin/trash&lt;/code>, exactly for this purpose. From &lt;code>man trash&lt;/code>:&lt;/p>
&lt;blockquote>
&lt;p>trash – Moves files and directories to the user trash folder&lt;/p>
&lt;/blockquote>
&lt;p>Linux systems can install
&lt;a href="https://repology.org/project/trash-cli/versions">&lt;code>trash-cli&lt;/code>&lt;/a>
(&lt;a href="https://github.com/andreafrancia/trash-cli">source&lt;/a>), which is available in
most distributions.&lt;/p>
&lt;p>Paired with &lt;a href="https://bneijt.nl/pr/autotrash/">&lt;code>autotrash&lt;/code>&lt;/a>, we attain a clever
pattern to keep our systems tidy:&lt;/p>
&lt;blockquote>
&lt;p>Autotrash is a simple Python script which will purge files from your trash
based on their age or the amount of free space left on the device. Using
autotrash -d 30 will delete files which have been in the trash for more then
30 days. It uses the FreeDesktop.org Trash Info files included in the new
GNOME system to find the correct files and the dates they where deleted.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>autotrash&lt;/code> can be easily integrated with the system cron and/or systemd timers.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Deletion with &lt;code>rm&lt;/code> is an
&lt;a href="https://man.archlinux.org/man/shred.1">illusion&lt;/a>.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>pre-commit: autoupdate</title><link>https://perrotta.dev/2025/09/pre-commit-autoupdate/</link><pubDate>Mon, 01 Sep 2025 12:05:52 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/09/pre-commit-autoupdate/</guid><description>&lt;p>When using &lt;a href="https://pre-commit.com/">&lt;code>pre-commit&lt;/code>&lt;/a>, you can take advantage of
its built-in &lt;code>pre-commit autoupdate&lt;/code> command to keep your hook dependencies
up-to-date.&lt;/p>
&lt;p>There&amp;rsquo;s one major drawback of adopting it ubiquitously: it is virtually
&lt;a href="https://stackoverflow.com/questions/74232399/is-it-possible-that-pre-commit-autoupdate-skips-a-single-linter">impossible&lt;/a>
to instruct it to skip certain repositories.&lt;/p>
&lt;p>It wouldn&amp;rsquo;t be hard to update it to ignore hook dependencies with skip byline
comments, but its author &lt;a href="https://stackoverflow.com/a/74240674/1745064">isn&amp;rsquo;t
keen&lt;/a> on implementing support for
it.&lt;/p>
&lt;p>So far I&amp;rsquo;ve been working around it by manually reverting undesired updates, but
that is super tedious and inefficient.&lt;/p>
&lt;p>Today I discovered a small utility,
&lt;a href="https://pypi.org/project/pre-commit-update/">&lt;code>pre-commit-update&lt;/code>&lt;/a>, which
explicitly supports that and was created precisely because of the limitation of
the original subcommand:&lt;/p>
&lt;blockquote>
&lt;p>pre-commit-update was created because there is no easy way to update your
hooks by using pre-commit autoupdate as it is not versatile enough.&lt;/p>
&lt;/blockquote>
&lt;p>The tool (which is thankfully also written in Python, for uniformity) supports a
config file to skip certain hooks from &lt;code>autoupdate&lt;/code>.&lt;/p></description></item><item><title>'It's never a good time'</title><link>https://perrotta.dev/2025/08/its-never-a-good-time/</link><pubDate>Fri, 29 Aug 2025 11:55:44 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/its-never-a-good-time/</guid><description>&lt;p>When is the best time&amp;hellip;&lt;/p>
&lt;ul>
&lt;li>to move countries?&lt;/li>
&lt;li>to have a baby?&lt;/li>
&lt;li>to switch jobs?&lt;/li>
&lt;li>to find a new apartment?&lt;/li>
&lt;li>to start a new hobby?&lt;/li>
&lt;li>to try out a new sport?&lt;/li>
&lt;li>to get promoted?&lt;/li>
&lt;li>to call your loved ones?&lt;/li>
&lt;li>to catch up with a long-time friend?&lt;/li>
&lt;li>to travel?&lt;/li>
&lt;li>to bootstrap a company?&lt;/li>
&lt;li>to join an open source community?&lt;/li>
&lt;li>to attend a beloved conference?&lt;/li>
&lt;li>to pray?&lt;/li>
&lt;li>to smile?&lt;/li>
&lt;li>to delete your social media accounts?&lt;/li>
&lt;li>to declutter and tidy up?&lt;/li>
&lt;li>to get that new haircut?&lt;/li>
&lt;/ul>
&lt;p>It turns out, &lt;a href="https://www.goodreads.com/book/show/58784475-tomorrow-and-tomorrow-and-tomorrow">it&amp;rsquo;s never a good
time&lt;/a>.&lt;/p>
&lt;p>There&amp;rsquo;s always something happening in the world.&lt;/p>
&lt;p>There&amp;rsquo;s always an inconvenience.&lt;/p>
&lt;p>An excuse.&lt;/p>
&lt;p>An obstacle.&lt;/p>
&lt;p>An inertia field exerting its effect in the entire environment.&lt;/p>
&lt;p>When is a good time?&lt;/p>
&lt;p>If you wait for it for too long, suddenly it may end up being too late.&lt;/p>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=XJIgHWnkcnA">The future starts with you&lt;/a>.&lt;/p></description></item><item><title>helm: diff manifests</title><link>https://perrotta.dev/2025/08/helm-diff-manifests/</link><pubDate>Thu, 28 Aug 2025 17:57:32 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/helm-diff-manifests/</guid><description>&lt;p>Lately I&amp;rsquo;ve been employing (with great success) the following pattern in order
to test whether changes to helm charts are harmless (and expected):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e5c07b">cd&lt;/span> path/to/my/helm/chart
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git checkout origin/master &lt;span style="color:#7f848e"># or main&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>helm template -f values.yaml . &amp;gt; golden
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git switch --create thiagowfx/my-feature-branch
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e"># develop, develop, develop&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>helm template -f values.yaml . &amp;gt; candidate
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>diff candidate golden &lt;span style="color:#7f848e"># or icdiff&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>diff&lt;/code> output will reliably demonstrate whether your changes are WAI.&lt;/p>
&lt;p>&lt;strong>Note&lt;/strong>: If needed, pass &lt;code>--release-name {foo}&lt;/code> to &lt;code>helm template&lt;/code>.&lt;/p>
&lt;p>This pattern is comparable to running a golden &lt;code>helm install&lt;/code> followed by a
&lt;a href="https://github.com/databus23/helm-diff">&lt;code>helm-diff&lt;/code>&lt;/a> (&lt;code>helm diff upgrade&lt;/code>)
candidate in the cluster.&lt;/p></description></item><item><title>Fact-checking when blogging</title><link>https://perrotta.dev/2025/08/fact-checking-when-blogging/</link><pubDate>Thu, 28 Aug 2025 10:00:09 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/fact-checking-when-blogging/</guid><description>&lt;p>An observation of lately: whenever I blog about software or technologies I&amp;rsquo;m
unfamiliar with (&amp;ldquo;learning in the open&amp;rdquo;), I tend to be more diligent than usual
(i.e. than if I were doing it privately, only for myself).&lt;/p>
&lt;p>Because I like to link to documentation and to add references as much as
possible, I tend to adopt a mindset of verifying that my assumptions and the
overall mental model of how things work are true.&lt;/p>
&lt;p>IMHO this is a good trait to adopt, which I attribute exclusively to the nature
of public blogging.&lt;/p></description></item><item><title>midnight commander: Fn keys</title><link>https://perrotta.dev/2025/08/midnight-commander-fn-keys/</link><pubDate>Thu, 28 Aug 2025 09:45:54 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/midnight-commander-fn-keys/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/08/midnight-commander-use-default-editor/">Previously&lt;/a>.&lt;/p>
&lt;p>It turns out it&amp;rsquo;s quite inconvenient to use Fn keys (F1, F2, &amp;hellip;) in Macbooks
and in my &lt;a href="https://perrotta.dev/2022/01/keychron-k2-review/">mechanical keyboard&lt;/a>,
because I need to press a key combo to do so (Fn + the corresponding function
key).&lt;/p>
&lt;p>This makes &lt;code>mc&lt;/code> unusable from a practical standpoint.&lt;/p>
&lt;p>We could
&lt;a href="https://superuser.com/questions/461452/is-there-a-way-to-change-shortcuts-in-midnight-commander">remap&lt;/a>
its keys (&lt;code>~/.config/mc/mc.keymap&lt;/code>), but this is not portable. The whole point
of learning how to use an universal application like midnight commander is to
stick to defaults as much as possible.&lt;/p>
&lt;p>There&amp;rsquo;s a
&lt;a href="https://stackoverflow.com/questions/59334351/how-can-i-bind-f3-behavior-on-key-5-on-numeric-keypad-in-midnight-commander">workaround&lt;/a> though!&lt;/p>
&lt;p>Instead of pressing F2 (which is effectively Fn + F2), press &lt;code>Esc&lt;/code> followed by
&lt;code>2&lt;/code>, emacs style. That&amp;rsquo;s much more ergonomic, because the key presses need not
be simultaneous.&lt;/p>
&lt;p>The most frequent combo I&amp;rsquo;ll use from now on is &lt;code>Esc + 0&lt;/code> (=F10) to quit &lt;code>mc&lt;/code>.&lt;/p></description></item><item><title>yazi</title><link>https://perrotta.dev/2025/08/yazi/</link><pubDate>Wed, 27 Aug 2025 22:05:37 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/yazi/</guid><description>&lt;p>&lt;a href="https://github.com/sxyazi/yazi">yazi&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>💥 Blazing fast terminal file manager written in Rust, based on async I/O.&lt;/p>
&lt;/blockquote>
&lt;p>I tried it for a couple of days and decided it&amp;rsquo;s not worth a switch from
&lt;a href="https://github.com/ranger/ranger">ranger&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>A VIM-inspired filemanager for the console&lt;/p>
&lt;/blockquote>
&lt;p>Why?&lt;/p>
&lt;ul>
&lt;li>&amp;ldquo;written in Rust&amp;rdquo;™ is never a reason &lt;em>by itself&lt;/em> to switch from familiar
software&lt;/li>
&lt;li>popularity is never a reason &lt;em>by itself&lt;/em> to switch from familiar software
(yazi has 50% more stars than ranger on GitHub)&lt;/li>
&lt;li>their core feature set is essentially the same&lt;/li>
&lt;li>muscle memory wins&lt;/li>
&lt;/ul>
&lt;p>Even though it is possible to map keybindings in &lt;code>yazi&lt;/code> to resemble &lt;code>ranger&lt;/code>, it
simply didn&amp;rsquo;t feel homy.
&lt;a href="https://github.com/thiagowfx/.dotfiles/commit/e2380e52a0d195c5800b4e8dd032c18dcf4f0c51">Sorry&lt;/a>.&lt;/p></description></item><item><title>midnight commander: use default editor</title><link>https://perrotta.dev/2025/08/midnight-commander-use-default-editor/</link><pubDate>Tue, 26 Aug 2025 14:55:25 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/midnight-commander-use-default-editor/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/08/git-ignore-changes-to-tracked-files/">Previously&lt;/a>.&lt;/p>
&lt;p>When using &lt;a href="https://midnight-commander.org/">midnight commander&lt;/a> to edit files
(with the default &lt;code>F4&lt;/code> keybinding), it defaults to using
&lt;a href="https://man.archlinux.org/man/mcedit.1">&lt;code>mcedit(1)&lt;/code>&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>mcedit - Internal file editor of GNU Midnight Commander&lt;/p>
&lt;/blockquote>
&lt;p>This is not great for my muscle memory.
I&amp;rsquo;d rather use my &lt;code>$EDITOR&lt;/code>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.&lt;/p>
&lt;pre tabindex="0">&lt;code>% GIT_PAGER=cat git show
commit 8ffb7995db8d845ca227a6e5360124bef3680113 (HEAD -&amp;gt; master, origin/master, origin/HEAD)
Author: Thiago Perrotta &amp;lt;{redacted}&amp;gt;
Date: Tue Aug 26 14:54:48 2025 +0200

 mc: use_internal_edit

diff --git mc/.config/mc/ini mc/.config/mc/ini
index 487267e..13b7643 100644
--- mc/.config/mc/ini
+++ mc/.config/mc/ini
@@ -1,2 +1,3 @@
 [Midnight-Commander]
 skin=modarin256
+use_internal_edit=false
&lt;/code>&lt;/pre>&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Currently: &lt;code>vim&lt;/code>.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>git: ignore changes to tracked files</title><link>https://perrotta.dev/2025/08/git-ignore-changes-to-tracked-files/</link><pubDate>Tue, 26 Aug 2025 14:46:44 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/git-ignore-changes-to-tracked-files/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/08/midnight-commander-colorscheme/">Previously&lt;/a>.&lt;/p>
&lt;p>Given this config file for &lt;a href="https://midnight-commander.org/">midnight
commander&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% head -n &lt;span style="color:#d19a66">2&lt;/span> ~/.dotfiles/mc/.config/mc/ini
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">[&lt;/span>Midnight-Commander&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">skin&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>modarin256
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip;properly installed via &lt;code>stow&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% &lt;span style="color:#56b6c2">(&lt;/span>&lt;span style="color:#e5c07b">cd&lt;/span> ~/.dotfiles &lt;span style="color:#56b6c2">&amp;amp;&amp;amp;&lt;/span> stow mc&lt;span style="color:#56b6c2">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Upon opening &lt;code>mc&lt;/code>, it writes a lot of configuration settings to that file:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">[Midnight-Commander]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">skin&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">modarin256&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">verbose&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">shell_patterns&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">auto_save_setup&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">preallocate_space&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">auto_menu&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">use_internal_view&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">use_internal_edit&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">clear_before_exec&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#98c379">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">[...]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>I could check them into source control, but I do not want to. They are defaults.&lt;/p>
&lt;p>So I tell &lt;code>git&lt;/code> to leave these additions alone:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% git update-index --skip-worktree mc/.config/mc/ini
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now &lt;code>git status&lt;/code> will not show the file.&lt;/p></description></item><item><title>midnight commander: colorscheme</title><link>https://perrotta.dev/2025/08/midnight-commander-colorscheme/</link><pubDate>Tue, 26 Aug 2025 14:09:58 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/midnight-commander-colorscheme/</guid><description>&lt;p>GNU &lt;a href="https://midnight-commander.org/">Midnight commander&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>is a visual, dual-pane file manager. It is released under the GNU General
Public License and therefore qualifies as Free Software.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Midnight Commander is a feature-rich, full-screen, text-mode application that
allows you to copy, move, and delete files and entire directory trees, search
for files, and execute commands in the subshell. Internal viewer, editor and
diff viewer are included.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://midnight-commander.org/img/mc-screenshot-cropped.png" alt="midnight commander">&lt;/p>
&lt;p>It&amp;rsquo;s available virtually &lt;a href="https://repology.org/project/mc/versions">everywhere&lt;/a>.&lt;/p>
&lt;p>I normally use &lt;a href="https://github.com/ranger/ranger">ranger&lt;/a>, but I wanted to give
&lt;code>mc&lt;/code> a try.&lt;/p>
&lt;p>There has always been one problem: its default colorscheme is absolutely
terrible. Its lack of contrast is flabbergasting.&lt;/p>
&lt;p>Well, I finally found a way to make it look better, without much fuss:&lt;/p>
&lt;ol>
&lt;li>Open &lt;code>mc&lt;/code>&lt;/li>
&lt;li>Click &amp;ldquo;Options&amp;rdquo; in the top file menu&lt;/li>
&lt;li>Click &amp;ldquo;Appearance&amp;rdquo;&lt;/li>
&lt;li>Change the skin to &lt;code>modarin256&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>It&amp;rsquo;s one of the fewest built-in colorscheme themes I could find that strikes a
good color contrast balance. Most other themes (including the default one) are
unreadable.&lt;/p>
&lt;p>You can preview all themes &lt;a href="https://skins.midnight-commander.org/">here&lt;/a>.&lt;/p>
&lt;p>There are lots of jokes about how to quit &lt;code>vim&lt;/code>, but do you know how to quit
&lt;code>mc&lt;/code>? Press &lt;code>F10&lt;/code> or type &lt;code>exit&amp;lt;CR&amp;gt;&lt;/code>.&lt;/p>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=I973iH79G-A">Credits&lt;/a>.&lt;/p></description></item><item><title>What is a valid email address?</title><link>https://perrotta.dev/2025/08/what-is-a-valid-email-address/</link><pubDate>Tue, 26 Aug 2025 01:18:05 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/what-is-a-valid-email-address/</guid><description>&lt;p>&lt;a href="https://e-mail.wtf/">Email is Easy&lt;/a>,
&lt;a href="https://email-is-good.com/2025/08/25/what-is-a-valid-email-address/">via&lt;/a> Chris
Coyier:&lt;/p>
&lt;blockquote>
&lt;p>Everyone knows what an email address is, right?&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Decide if each email address is valid or not. I used the email-addresses
library to verify against the relevant RFCs. Enjoy.&lt;/p>
&lt;/blockquote>
&lt;p>As for me?&lt;/p>
&lt;p>&lt;em>I scored 12/21 on &lt;a href="https://e-mail.wtf">https://e-mail.wtf&lt;/a> and all I got was this lousy text to share
&lt;del>on social media&lt;/del> on my blog&lt;/em>.&lt;/p></description></item><item><title>ArgoCD: git index.lock issue</title><link>https://perrotta.dev/2025/08/argocd-git-index.lock-issue/</link><pubDate>Sat, 23 Aug 2025 12:39:14 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/argocd-git-index.lock-issue/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: Every ArgoCD application is stuck in &lt;em>Unknown&lt;/em> state,
with the following error:&lt;/p>
&lt;pre tabindex="0">&lt;code>Failed to load target state: failed to generate manifest for source 1 of 2:
rpc error: code = Unknown desc = failed to initialize repository resources: rpc
error: code = Internal desc = Failed to checkout FETCH_HEAD: failed to checkout
FETCH_HEAD: `git checkout --force FETCH_HEAD` failed exit status 128: fatal:
Unable to create &amp;#39;&amp;lt;path to cached source&amp;gt;/.git/index.lock&amp;#39;: File exists. Another
git process seems to be running in this repository, e.g. an editor opened by
&amp;#39;git commit&amp;#39;. Please make sure all processes are terminated then try again. If
it still fails, a git process may have crashed in this repository earlier:
remove the file manually to continue.
&lt;/code>&lt;/pre>&lt;p>It is a lock contention race condition issue within the ArgoCD repo server
component, with the git &lt;code>index.lock&lt;/code>.&lt;/p>
&lt;p>The easiest way to address it is to restart the repo server:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>kubectl rollout restart deploy -n argocd argocd-repo-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Afterwards, refresh all applications in the cluster via the web UI:&lt;/p>
&lt;ul>
&lt;li>click Applications on the left-side nav bar&lt;/li>
&lt;li>click Refresh apps at the top&lt;/li>
&lt;li>select ALL applications, set refresh type to NORMAL&lt;/li>
&lt;li>click refresh&lt;/li>
&lt;/ul></description></item><item><title>YAML: JSON patch: test</title><link>https://perrotta.dev/2025/08/yaml-json-patch-test/</link><pubDate>Fri, 22 Aug 2025 16:49:58 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/yaml-json-patch-test/</guid><description>&lt;p>&lt;a href="https://datatracker.ietf.org/doc/html/rfc6902">RFC 6902&lt;/a>, JavaScript Object Notation (JSON) Patch:&lt;/p>
&lt;blockquote>
&lt;p>JSON Patch defines a JSON document structure for expressing a sequence of
operations to apply to a JavaScript Object Notation (JSON) document; it is
suitable for use with the HTTP PATCH method. The &amp;ldquo;application/json-patch+json&amp;rdquo;
media type is used to identify such patch documents.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://jsonpatch.me/">jsonpatch.me&lt;/a> has a sandbox to play with it.&lt;/p>
&lt;h2 id="example">Example&lt;/h2>
&lt;p>JSON:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;Hello World&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;#34;from&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;Unknown&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Patch (also a JSON!):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>[
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> { &lt;span style="color:#e06c75">&amp;#34;op&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;replace&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">&amp;#34;path&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;/message&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;Patching JSON is fun&amp;#34;&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> { &lt;span style="color:#e06c75">&amp;#34;op&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;add&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">&amp;#34;path&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;/with&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;jsonpatch.me&amp;#34;&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> { &lt;span style="color:#e06c75">&amp;#34;op&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;remove&amp;#34;&lt;/span>, &lt;span style="color:#e06c75">&amp;#34;path&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;/from&amp;#34;&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Result:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;Patching JSON is fun&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;#34;with&amp;#34;&lt;/span>: &lt;span style="color:#98c379">&amp;#34;jsonpatch.me&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="yaml">YAML&lt;/h2>
&lt;p>It&amp;rsquo;s also possible to use JSON Patch with YAML, because &lt;a href="https://yaml.org/spec/1.2-old/spec.html#id2759572">YAML is a superset of
JSON&lt;/a>:&lt;/p>
&lt;p>YAML:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">message&lt;/span>: &lt;span style="color:#98c379">&amp;#34;Hello World&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">from&lt;/span>: &lt;span style="color:#98c379">&amp;#34;Unknown&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The same JSON patch as before yields this result:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">message&lt;/span>: &lt;span style="color:#98c379">&amp;#34;Patching JSON is fun&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">with&lt;/span>: &lt;span style="color:#98c379">&amp;#34;jsonpatch.me&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>We could have expressed the patch in YAML form if we wanted to:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#e06c75">op&lt;/span>: replace
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">path&lt;/span>: /message
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">value&lt;/span>: Patching JSON is fun
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#e06c75">op&lt;/span>: add
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">path&lt;/span>: /with
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">value&lt;/span>: jsonpatch.me
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#e06c75">op&lt;/span>: remove
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">path&lt;/span>: /from
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="tests">Tests?&lt;/h2>
&lt;p>It&amp;rsquo;s intuitive to understand the basic JSON patch operations:&lt;/p>
&lt;ul>
&lt;li>add&lt;/li>
&lt;li>remove&lt;/li>
&lt;li>replace&lt;/li>
&lt;li>move&lt;/li>
&lt;li>copy&lt;/li>
&lt;/ul>
&lt;p>What comes off as surprising is that there&amp;rsquo;s also a
&lt;a href="https://datatracker.ietf.org/doc/html/rfc6902#section-4.6">&lt;em>test&lt;/em>&lt;/a> operation.&lt;/p>
&lt;p>At this point I would recommend the reader to look at the spec, it&amp;rsquo;s quite
readable.&lt;/p>
&lt;p>Here is an example of how I typically use &lt;em>test&lt;/em>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#e06c75">op&lt;/span>: test
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">path&lt;/span>: /spec/syncPolicy/syncOptions/3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">value&lt;/span>: ServerSideApply=true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#e06c75">op&lt;/span>: remove
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">path&lt;/span>: /spec/syncPolicy/syncOptions/3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Before &lt;a href="https://datatracker.ietf.org/doc/html/rfc6902#appendix-A.4">removing an array
element&lt;/a> (which must
be done by index), check that we&amp;rsquo;re removing the appropriate one.&lt;/p>
&lt;p>Why? Because it is error-prone not to do so. If someone reorders the array for
some reason, we would end up deleting the incorrect array element! Do you want
to be the one writing up the postmortem?&lt;/p></description></item><item><title>/security-review</title><link>https://perrotta.dev/2025/08/security-review/</link><pubDate>Fri, 22 Aug 2025 15:31:01 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/security-review/</guid><description>&lt;p>Anthropic, &lt;a href="https://support.anthropic.com/en/articles/11932705-automated-security-reviews-in-claude-code">Automated Security Reviews in Claude Code
&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>Claude Code now includes automated security review features to help you
identify and fix vulnerabilities in your code. This guide explains how to use
the &lt;code>/security-review&lt;/code> command and GitHub Actions to improve your code security.&lt;/p>
&lt;/blockquote>
&lt;p>Of course, there are also
&lt;a href="https://github.com/anthropics/claude-code-security-review/tree/main?tab=readme-ov-file#security-review-slash-command">docs&lt;/a>.&lt;/p>
&lt;p>It is merely a &lt;a href="https://github.com/anthropics/claude-code-security-review/blob/main/.claude/commands/security-review.md?plain=1">glorified system
prompt&lt;/a>,
which is exactly what I expected:&lt;/p>
&lt;blockquote>
&lt;p>Complete a security review of the pending changes on the current branch&lt;/p>
&lt;p>You are a senior security engineer conducting a focused security review of the changes on this branch.&lt;/p>
&lt;p>[&amp;hellip;]&lt;/p>
&lt;/blockquote>
&lt;p>The prompt employs the well-established pattern of outlining countless examples
and instructing the model to follow a certain output format.&lt;/p>
&lt;p>In 2025, the Gen AI arms race is mostly about (i) cost-benefit and (ii) user /
developer experience. Anthropic surely has a good taste in user experience; to
me, they often resemble Apple.&lt;/p></description></item><item><title>Emoter</title><link>https://perrotta.dev/2025/08/emoter/</link><pubDate>Fri, 22 Aug 2025 11:31:07 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/emoter/</guid><description>&lt;p>Adam Aaronson, &lt;a href="https://aaronson.org/emoter/">Emoter&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>Create your own custom emoji for Slack and Discord!&lt;/p>
&lt;/blockquote>
&lt;p>It is simple and effective.&lt;/p>
&lt;p>The more ways to increase expressiveness in everyday interactions with
teammates the better!&lt;/p></description></item><item><title>Python: f-string help</title><link>https://perrotta.dev/2025/08/python-f-string-help/</link><pubDate>Fri, 22 Aug 2025 00:30:05 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/python-f-string-help/</guid><description>&lt;p>&lt;a href="https://fstring.help/">Python f-strings&lt;/a>.&lt;/p>
&lt;p>&lt;a href="https://fstring.help/cheat/">Python f-string cheat sheets&lt;/a>.&lt;/p>
&lt;p>These one-pagers are wholesome.&lt;/p>
&lt;p>The ones I remember:&lt;/p>
&lt;pre tabindex="0">&lt;code>% python3
Python 3.13.7 (main, Aug 14 2025, 11:12:11) [Clang 17.0.0 (clang-1700.0.13.3)] on darwin
Type &amp;#34;help&amp;#34;, &amp;#34;copyright&amp;#34;, &amp;#34;credits&amp;#34; or &amp;#34;license&amp;#34; for more information.
&amp;gt;&amp;gt;&amp;gt; hello = &amp;#39;world&amp;#39;
&amp;gt;&amp;gt;&amp;gt; hello
&amp;#39;world&amp;#39;
&amp;gt;&amp;gt;&amp;gt; f&amp;#39;{hello}&amp;#39;
&amp;#39;world&amp;#39;
&amp;gt;&amp;gt;&amp;gt; f&amp;#39;{hello=}&amp;#39; # handy for debugging, or during coding interviews
&amp;#34;hello=&amp;#39;world&amp;#39;&amp;#34;
&amp;gt;&amp;gt;&amp;gt; f&amp;#39;{hello = }&amp;#39; # same as the above, but slightly more readable
&amp;#34;hello = &amp;#39;world&amp;#39;&amp;#34;
&lt;/code>&lt;/pre></description></item><item><title>Kubernetes: list all ImagePullBackOff container images</title><link>https://perrotta.dev/2025/08/kubernetes-list-all-imagepullbackoff-container-images/</link><pubDate>Thu, 21 Aug 2025 13:34:27 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/kubernetes-list-all-imagepullbackoff-container-images/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong> Upgrade the
&lt;a href="https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack">&lt;code>kube-prometheus-stack&lt;/code>&lt;/a>
helm chart in &lt;a href="https://portal.azure.cn/">Azure China&lt;/a> to the latest version.
&lt;em>Side effect&lt;/em>: Many container images are now missing from our internal
&lt;a href="https://azure.microsoft.com/en-us/products/container-registry">ACR&lt;/a> (Azure
Container Registry). They need to be synced with &lt;a href="https://github.com/containers/skopeo">&lt;code>skopeo&lt;/code>&lt;/a>.&lt;/p>
&lt;p>Which images need to be synced? Use the command below, it is quite readable&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>kubectl get pods --all-namespaces -o json | jq -r &lt;span style="color:#98c379">&amp;#39;.items[] | select(any(.status.containerStatuses[]; .state.waiting.reason == &amp;#34;ImagePullBackOff&amp;#34;)) | .metadata.namespace + &amp;#34;/&amp;#34; + .metadata.name + &amp;#34;\t&amp;#34; + ( [.status.containerStatuses[] | select(.state.waiting.reason == &amp;#34;ImagePullBackOff&amp;#34;).image] | join(&amp;#34;, &amp;#34;) )&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Sample run:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ubuntu@universe:~ $ kubectl get pods --all-namespaces -o json | jq -r &lt;span style="color:#98c379">&amp;#39;.items[]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379"> | select(any(.status.containerStatuses[]; .state.waiting.reason == &amp;#34;ImagePullBackOff&amp;#34;))
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379"> | .metadata.namespace + &amp;#34;/&amp;#34; + .metadata.name + &amp;#34;\t&amp;#34; +
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379"> ( [.status.containerStatuses[] | select(.state.waiting.reason == &amp;#34;ImagePullBackOff&amp;#34;).image] | join(&amp;#34;, &amp;#34;) )&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>monitoring/clustermon-kube-prometheus-operator-67c8b6c87c-w72km &lt;span style="color:#56b6c2">{&lt;/span>my-registry-name&lt;span style="color:#56b6c2">}&lt;/span>.azurecr.cn/quay.io/prometheus-operator/prometheus-operator:v0.83.0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>monitoring/clustermon-prometheus-node-exporter-v7bpt &lt;span style="color:#56b6c2">{&lt;/span>my-registry-name&lt;span style="color:#56b6c2">}&lt;/span>.azurecr.cn/quay.io/prometheus/node-exporter:v1.9.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>How to &lt;code>skopeo&lt;/code>? First, log in:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e5c07b">echo&lt;/span> -n &lt;span style="color:#98c379">&amp;#34;{password}&amp;#34;&lt;/span> | skopeo login &lt;span style="color:#56b6c2">{&lt;/span>my-registry-name&lt;span style="color:#56b6c2">}&lt;/span>.azurecr.cn --password-stdin --username &lt;span style="color:#56b6c2">{&lt;/span>my-username&lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>How do you get these credentials? Log in to the Azure China Portal, find the ACR
resource, navigate to Settings &amp;gt; Access keys.&lt;/p>
&lt;p>Then sync each image&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% skopeo sync &lt;span style="color:#98c379">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&lt;/span> --override-os linux --override-arch amd64 &lt;span style="color:#98c379">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&lt;/span> --src docker --dest docker &lt;span style="color:#98c379">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&lt;/span> quay.io/prometheus/node-exporter:v1.9.1 &lt;span style="color:#98c379">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&lt;/span> &lt;span style="color:#56b6c2">{&lt;/span>my-registry-name&lt;span style="color:#56b6c2">}&lt;/span>.azurecr.cn/quay.io/prometheus
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>I cannot promise I am able to craft this by hand without looking up man
pages or getting assistance from an LLM. &lt;em>C&amp;rsquo;est la vie&lt;/em>.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>If there are many images, consider using an
&lt;a href="https://www.gnu.org/software/bash/manual/html_node/Arrays.html">array&lt;/a> +
&lt;code>for&lt;/code> loop.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>XSLT in RSS feed</title><link>https://perrotta.dev/2025/08/xslt-in-rss-feed/</link><pubDate>Wed, 20 Aug 2025 14:03:18 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/xslt-in-rss-feed/</guid><description>&lt;p>&lt;a href="https://www.jwz.org/blog/2025/08/xslt/">There&amp;rsquo;s&lt;/a>
&lt;a href="https://simonwillison.net/2025/Aug/19/xslt/#atom-everything">some&lt;/a>
&lt;a href="https://www.osnews.com/story/143123/google-is-killing-the-open-web/">buzz&lt;/a>
&lt;a href="https://wok.oblomov.eu/tecnologia/google-killing-open-web/">around&lt;/a>
&lt;a href="https://github.com/whatwg/html/issues/11523">XSLT&lt;/a>
&lt;a href="https://www.jonmsterling.com/01DI/index.xml">recently&lt;/a>&lt;a href="https://mastodon.social/@Edent/115048990801167629">.&lt;/a>&lt;/p>
&lt;p>I have my own &lt;a href="https://en.wikipedia.org/wiki/Embrace,_extend,_and_extinguish">opinion&lt;/a> about the topic but I&amp;rsquo;m not here to discuss politics.&lt;/p>
&lt;p>I took the &lt;a href="https://en.wikipedia.org/wiki/Streisand_effect">opportunity&lt;/a> to style my RSS feed.&lt;/p>
&lt;p>The &lt;a href="https://perrotta.dev/index.xml">result&lt;/a>. Now it looks just like my blog!&lt;/p></description></item><item><title>Docker: AWS ECR: list recent image tags</title><link>https://perrotta.dev/2025/08/docker-aws-ecr-list-recent-image-tags/</link><pubDate>Mon, 18 Aug 2025 15:38:21 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/docker-aws-ecr-list-recent-image-tags/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: Given a docker repository hosted in
&lt;a href="https://aws.amazon.com/ecr/">ECR&lt;/a> (AWS), list its &lt;strong>most recent&lt;/strong> image tags.&lt;/p>
&lt;p>Assuming you&amp;rsquo;re already authenticated to AWS in the CLI:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% aws ecr describe-images &lt;span style="color:#98c379">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&lt;/span> --repository-name &lt;span style="color:#56b6c2">{&lt;/span>corp&lt;span style="color:#56b6c2">}&lt;/span>/&lt;span style="color:#56b6c2">{&lt;/span>repo&lt;span style="color:#56b6c2">}&lt;/span> &lt;span style="color:#98c379">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&lt;/span> --filter &lt;span style="color:#e06c75">tagStatus&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>TAGGED &lt;span style="color:#98c379">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&lt;/span> --query &lt;span style="color:#98c379">&amp;#39;reverse(sort_by(imageDetails, &amp;amp;imagePushedAt))[*].{Tag: imageTags[0], PushedAt: imagePushedAt}&amp;#39;&lt;/span> &lt;span style="color:#98c379">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#98c379">&lt;/span> &lt;span style="color:#56b6c2">[&lt;/span>--output table&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The output looks like this:&lt;/p>
&lt;pre tabindex="0">&lt;code>-------------------------------------------------------------------------------------------
| DescribeImages |
+-----------------------------------+-----------------------------------------------------+
| PushedAt | Tag |
+-----------------------------------+-----------------------------------------------------+
| 2025-08-14T14:44:49.285000+02:00 | 1.0.2 |
| 2025-08-14T14:07:53.526000+02:00 | app-839403421 |
| 2025-08-07T19:38:21.452000+02:00 | app-1134bfa1d |
| 2025-08-06T14:54:23.314000+02:00 | app-pr-5033-07f01dd66 |
| 2025-08-06T14:33:27.171000+02:00 | app-pr-5033-643536a2b |
| 2025-07-23T09:36:20.368000+02:00 | app-pr-4947-fe5f4c618 |
| 2025-04-17T03:17:30.937000+02:00 | 1.0.1 |
| 2024-12-18T18:50:18.990000+01:00 | latest |
| 2024-12-05T17:52:09.775000+01:00 | 1.0.0 |
+-----------------------------------+-----------------------------------------------------+
&lt;/code>&lt;/pre>&lt;p>If you omit &lt;code>--output table&lt;/code>, it emits JSON instead.&lt;/p>
&lt;p>This is faster than logging into the AWS Console.&lt;/p></description></item><item><title>Dockerfile: CMD and ENTRYPOINT: shell and exec forms</title><link>https://perrotta.dev/2025/08/dockerfile-cmd-and-entrypoint-shell-and-exec-forms/</link><pubDate>Mon, 18 Aug 2025 15:09:28 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/dockerfile-cmd-and-entrypoint-shell-and-exec-forms/</guid><description>&lt;p>Today I filed a github issue against the
&lt;a href="https://github.com/reteps/dockerfmt/">&lt;code>dockerfmt&lt;/code>&lt;/a> project, which I copy
verbatim here given its surprising behavior.&lt;/p>
&lt;h2 id="retepsdockerfmt33httpsgithubcomretepsdockerfmtissues33">&lt;a href="https://github.com/reteps/dockerfmt/issues/33">reteps/dockerfmt#33&lt;/a>&lt;/h2>
&lt;p>Consider this sample &lt;code>Dockerfile&lt;/code> (abridged version of a real-world scenario):&lt;/p>
&lt;pre tabindex="0">&lt;code>ENTRYPOINT sleep infinity
CMD sleep infinity
&lt;/code>&lt;/pre>&lt;p>Let&amp;rsquo;s run &lt;code>dockerfmt&lt;/code> (v0.3.7) in it:&lt;/p>
&lt;pre tabindex="0">&lt;code>% dockerfmt Dockerfile
ENTRYPOINT [&amp;#34;sleep&amp;#34;, &amp;#34;infinity&amp;#34;]
CMD [&amp;#34;sleep&amp;#34;, &amp;#34;infinity&amp;#34;]
&lt;/code>&lt;/pre>&lt;p>At first glance, everything looks OK. The problem is that this transformation is not a no-op.&lt;/p>
&lt;p>Looking at the docs:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.docker.com/reference/dockerfile/#cmd">https://docs.docker.com/reference/dockerfile/#cmd&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.docker.com/reference/dockerfile/#shell-and-exec-form">https://docs.docker.com/reference/dockerfile/#shell-and-exec-form&lt;/a>&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>If CMD is used to provide default arguments for the ENTRYPOINT instruction, both the CMD and ENTRYPOINT instructions should be specified in the &lt;a href="https://docs.docker.com/reference/dockerfile/#exec-form">exec form&lt;/a>.&lt;/p>
&lt;/blockquote>
&lt;p>The difference is:&lt;/p>
&lt;ul>
&lt;li>the original code yields &lt;code>sleep infinity&lt;/code> (correct!)&lt;/li>
&lt;li>the transformed code yields &lt;code>sleep infinity sleep infinity&lt;/code>, which is an error (sleep: &lt;code>no such argument sleep&lt;/code>)&lt;/li>
&lt;/ul>
&lt;p>One could argue that the original code is odd – the following would be conceptually simpler, and more idiomatic:&lt;/p>
&lt;pre tabindex="0">&lt;code>ENTRYPOINT [&amp;#34;sleep&amp;#34;]
CMD [&amp;#34;infinity&amp;#34;]
&lt;/code>&lt;/pre>&lt;p>Or even:&lt;/p>
&lt;pre tabindex="0">&lt;code>ENTRYPOINT [&amp;#34;sleep&amp;#34;, &amp;#34;infinity&amp;#34;]
&lt;/code>&lt;/pre>&lt;p>Nonetheless, IMHO &lt;code>dockerfmt&lt;/code> should not change the behavior in this case.&lt;/p>
&lt;h2 id="notes">Notes&lt;/h2>
&lt;p>&lt;a href="https://docs.docker.com/reference/dockerfile/#shell-and-exec-form">&lt;code>shell&lt;/code> and &lt;code>exec&lt;/code>
forms&lt;/a> have
distinct forms:&lt;/p>
&lt;ul>
&lt;li>&lt;code>INSTRUCTION [&amp;quot;executable&amp;quot;, &amp;quot;param1&amp;quot;, &amp;quot;param2&amp;quot;]&lt;/code> (exec form)&lt;/li>
&lt;li>&lt;code>INSTRUCTION command param1 param2&lt;/code> (shell form)&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>The exec form makes it possible to avoid shell string munging, and to invoke
commands using a specific command shell, or any other executable. It uses a
JSON array syntax, where each element in the array is a command, flag, or
argument.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>The shell form is more relaxed, and emphasizes ease of use, flexibility, and
readability. The shell form automatically uses a command shell, whereas the
exec form does not.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>dockerfmt&lt;/code>
&lt;a href="https://github.com/reteps/dockerfmt/blob/290b5f78fbf3134024eb3366880754beee5dbe69/lib/format.go#L483">prefers&lt;/a>
the exec form, for whatever reason.&lt;/p>
&lt;p>There&amp;rsquo;s even a &lt;a href="https://github.com/reteps/dockerfmt/blob/290b5f78fbf3134024eb3366880754beee5dbe69/lib/format.go#L480">code
comment&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>&lt;code>// this can technically change behavior. https://docs.docker.com/reference/dockerfile/#understand-how-cmd-and-entrypoint-interact&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>Surprise surprise! The issue I reported is precisely due to a change of
behavior.&lt;/p></description></item><item><title>GNU sed: follow symlinks</title><link>https://perrotta.dev/2025/08/gnu-sed-follow-symlinks/</link><pubDate>Thu, 14 Aug 2025 17:46:27 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/gnu-sed-follow-symlinks/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2025/08/fd-with-xargs-filenames-with-spaces/">Previously&lt;/a>.&lt;/p>
&lt;p>Today we will upgrade Terraform in the entire codebase:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>fd -e tf | ifne xargs gsed -i -e &lt;span style="color:#98c379">&amp;#39;s/required_version = &amp;#34;~&amp;gt; 1.6.6/required_version = &amp;#34;~&amp;gt; 1.10.0/g&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Easy, right?&lt;/p>
&lt;p>During code review, a teammate has pointed out that I replaced many symlinks.
How?! This was completely unintended!&lt;/p>
&lt;p>Eventually I figured out the reason. From &lt;a href="https://man.archlinux.org/man/sed.1">&lt;code>sed(1)&lt;/code>&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>&lt;code>--follow-symlinks&lt;/code>
follow symlinks when processing in place&lt;/p>
&lt;/blockquote>
&lt;p>It turns out it is necessary to pass &lt;code>--follow-symlinks&lt;/code> to preserve symlinks
when using &lt;code>-i&lt;/code> with GNU &lt;code>sed&lt;/code>.&lt;/p></description></item><item><title>Daily log</title><link>https://perrotta.dev/2025/08/daily-log/</link><pubDate>Wed, 13 Aug 2025 12:02:03 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/daily-log/</guid><description>&lt;p>It&amp;rsquo;s easy to get distracted when using computers connected to the internet.
Like, errhmm, when you are doing your job.&lt;/p>
&lt;p>I tend to minimize some distractions by reducing notifications and by
turning on do not disturb on my phone. Having / using less social media also
helps.&lt;/p>
&lt;p>What about Internet distractions in my work laptop though?&lt;/p>
&lt;p>Lately I&amp;rsquo;ve been trying out a new habit that appears to keep me more focused
throughout the day.&lt;/p>
&lt;p>First, I open my note-taking / second brain app (&lt;a href="https://logseq.com/">LogSeq&lt;/a>).&lt;/p>
&lt;p>Next, create a new journal page for it (&lt;code>Aug 13th, 2025&lt;/code> or &lt;code>2025-08-13&lt;/code>).&lt;/p>
&lt;p>One reason I like LogSeq is that it does it automatically for me, every day.&lt;/p>
&lt;p>Then I create a heading called &amp;ldquo;Daily log&amp;rdquo;&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.&lt;/p>
&lt;p>I think about what to work on next, typically based on ticket prioritization or
sprint planning or dealing with whatever fire is going on at the moment or a
&amp;ldquo;20%&amp;rdquo; project to improve overall code health.&lt;/p>
&lt;p>Then I type in &lt;code>/time&amp;lt;ENTER&amp;gt;&lt;/code>. LogSeq helpfully inserts the current time e.g.
&lt;code>13:14&lt;/code>. Afterwards, I write a single sentence about what I&amp;rsquo;m going to do. For
example:&lt;/p>
&lt;ul>
&lt;li>14:18 Sync docker images for bitnamilegacy&lt;/li>
&lt;li>14:45 Experiment with pruning in Argo&lt;/li>
&lt;/ul>
&lt;p>This is not intended to be a meticulous report, as it doesn&amp;rsquo;t impact me in any
way (e.g. for performance reviews).&lt;/p>
&lt;p>I merely observed that jotting one slice of idea down makes my intent concrete,
clear(er), and helps me stay focused on it, instead of thinking on the next
procrastination browser tab to open to get distracted with.&lt;/p>
&lt;p>There&amp;rsquo;s also a psychological effect wherein observing my accomplishments at the
end of the day simply feels good.&lt;/p>
&lt;p>And last but not least, it becomes easier for me to remember what I worked on
during the day, making my stand-up meetings more comprehensive.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Or &amp;ldquo;Daily&amp;rdquo;. The name is not important.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>"Fix typo"</title><link>https://perrotta.dev/2025/08/fix-typo/</link><pubDate>Wed, 13 Aug 2025 11:13:35 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/fix-typo/</guid><description>&lt;p>You, too, can make the &lt;del>word&lt;/del> world a better place,
&lt;a href="https://github.com/codespell-project/codespell/pull/3758">one&lt;/a>
&lt;a href="https://github.com/codespell-project/codespell/pull/3759">typo&lt;/a> at a time.&lt;/p>
&lt;p>The &lt;a href="https://github.com/codespell-project/codespell/">codespell&lt;/a> project can be
trivially adopted in a git repository via a &lt;a href="https://pre-commit.com/">pre-commit
hook&lt;/a>:&lt;/p>
&lt;pre tabindex="0">&lt;code>repos:
 - repo: https://github.com/codespell-project/codespell
 rev: 63c8f8312b7559622c0d82815639671ae42132ac # frozen: v2.4.1
 hooks:
 - id: codespell
&lt;/code>&lt;/pre></description></item><item><title>git ll</title><link>https://perrotta.dev/2025/08/git-ll/</link><pubDate>Tue, 12 Aug 2025 12:50:09 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/git-ll/</guid><description>&lt;p>In my &lt;code>~/.gitconfig&lt;/code> there&amp;rsquo;s an alias for &lt;code>git log&lt;/code>, inspired by &lt;a href="https://registerspill.thorstenball.com/p/how-i-use-git">Thorsten
Ball&lt;/a>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">[alias]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">ll&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#98c379">&amp;#34;!f() { git log --graph --pretty=&amp;#39;tformat:%C(always,yellow)%h%C(always,reset) %C(always,green)%ar%C(always,reset){%C(always,bold blue)%an%C(always,reset){%C(always,red)%d%C(always,reset) %s&amp;#39; \&amp;#34;$@\&amp;#34; | column -t -s &amp;#39;{&amp;#39; | less -XS; }; f&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>I wish I could get rid of the shell utilities (&lt;code>column&lt;/code> and &lt;code>less&lt;/code>), but they&amp;rsquo;re
necessary to properly align the columns.&lt;/p>
&lt;p>I also tried to get rid of the function wrapper (&lt;code>f()&lt;/code>): it works when you run
&lt;code>git ll&lt;/code>. However when you run &lt;code>git ll .&lt;/code> (=display the commit history from
files underneath the current directory only) it fails:&lt;/p>
&lt;pre tabindex="0">&lt;code>% git ll .
. is a directory
&lt;/code>&lt;/pre>&lt;p>Therefore it&amp;rsquo;s better to keep it around. I am satisfied with the current form.&lt;/p>
&lt;p>The output looks like this (image from upstream):&lt;/p>
&lt;p>&lt;img src="https://substackcdn.com/image/fetch/$s_!1Mdk!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbf41b48e-523f-4f82-abc0-db4b1d27c689_2310x1374.png" alt="git ll output">&lt;/p>
&lt;p>&lt;strong>Update(2025-08-21)&lt;/strong>: The following modification is better&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup> and has no
external dependencies:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-conf" data-lang="conf">[alias]
 ll = log --graph --pretty=tformat:&amp;#39;%C(always,yellow)%h%C(always,reset) %C(always,green)%&amp;lt;(25,trunc)%ar%C(always,reset) %C(always,bold blue)%&amp;lt;(20,trunc)%an%C(always,reset) %C(always,red)%d%C(always,reset) %s&amp;#39;
&lt;/code>&lt;/pre>&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>His original configuration is a separate shell function, which is
completely unnecessary. A git alias suffices. Keep it simple!&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>In the original implementation, &lt;code>git ll .&lt;/code> did not work as expected
(i.e. it did not display changes &lt;em>only&lt;/em> from the current directory).&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>git: --no-pager</title><link>https://perrotta.dev/2025/08/git--no-pager/</link><pubDate>Tue, 12 Aug 2025 12:21:22 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/git--no-pager/</guid><description>&lt;p>Let&amp;rsquo;s say you use color highlighting to visually inspect diffs with &lt;code>git&lt;/code>, such
as &lt;a href="https://github.com/dandavison/delta">&lt;code>delta&lt;/code>&lt;/a> or
&lt;a href="https://github.com/git/git/blob/master/contrib/diff-highlight/README">&lt;code>diff-highlight&lt;/code>&lt;/a>
or &lt;a href="https://github.com/mookid/diffr">&lt;code>diffr&lt;/code>&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Implication&lt;/strong>: whenever you run &lt;code>git diff&lt;/code>, &lt;code>git show&lt;/code>, or any other &lt;code>git&lt;/code>
command that produces a diff, it will emit colors (typically red and green).&lt;/p>
&lt;p>Colors are great for local visual inspection, but they are terrible for sharing.
They won&amp;rsquo;t be carried over with copy-and-paste.&lt;/p>
&lt;p>If you intend to share diff output (e.g. to a Q&amp;amp;A site, with teammates), it&amp;rsquo;s
better to emit &lt;code>-&lt;/code> and &lt;code>+&lt;/code>, as vanilla &lt;code>diff&lt;/code> does.&lt;/p>
&lt;p>The easiest way to do so is to pass &lt;code>--no-pager&lt;/code> to &lt;code>git&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>git --no-pager diff a83bc395
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git --no-pager show HEAD
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>For example, a recent commit in my
&lt;a href="https://github.com/thiagowfx/.dotfiles">dotfiles&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% git --no-pager show HEAD~1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>commit 52b1e91b0f1d93176ec768aa6158974fc401f335
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Author: Thiago Perrotta &amp;lt;&lt;span style="color:#56b6c2">{&lt;/span>redacted&lt;span style="color:#56b6c2">}&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Date: Thu Aug &lt;span style="color:#d19a66">7&lt;/span> 12:00:47 &lt;span style="color:#d19a66">2025&lt;/span> +0200
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fix mr
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>diff --git bin/.bin/sd-world bin/.bin/sd-world
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>index c46be0e..44c0b47 &lt;span style="color:#d19a66">100755&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>--- bin/.bin/sd-world
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>+++ bin/.bin/sd-world
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>@@ -58,7 +58,7 @@ &lt;span style="color:#c678dd">esac&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> run_if_exists &lt;span style="color:#98c379">&amp;#34;claude&amp;#34;&lt;/span> claude update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># myrepos&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-run_if_exists &lt;span style="color:#98c379">&amp;#34;mr&amp;#34;&lt;/span> mr -d ~ update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>+&lt;span style="color:#56b6c2">(&lt;/span>&lt;span style="color:#e5c07b">cd&lt;/span> ~ &lt;span style="color:#56b6c2">&amp;amp;&amp;amp;&lt;/span> run_if_exists &lt;span style="color:#98c379">&amp;#34;mr&amp;#34;&lt;/span> mr update&lt;span style="color:#56b6c2">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#7f848e"># source corp updates if any&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> run_if_exists &lt;span style="color:#98c379">&amp;#34;sd-world-corp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Note that &lt;code>--no-pager&lt;/code> is a &lt;code>git&lt;/code>-level option: it should be specified before
the git subcommand. The following does not work:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% git show HEAD~1 --no-pager
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>fatal: unrecognized argument: --no-pager
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>ArgoCD: app version notifications</title><link>https://perrotta.dev/2025/08/argocd-app-version-notifications/</link><pubDate>Tue, 12 Aug 2025 12:07:20 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/argocd-app-version-notifications/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: when using &lt;a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/notifications/">ArgoCD
notifications&lt;/a>,
starting off from their
&lt;a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/notifications/catalog/">catalog&lt;/a>,
print the app chart version in addition to existing information.&lt;/p>
&lt;p>More specifically, currently, a Slack notification message from Argo looks like
the following:&lt;/p>
&lt;pre tabindex="0">&lt;code>Cluster 37: Application heart-of-gold is unhealthy.
&lt;/code>&lt;/pre>&lt;p>We want to improve it to:&lt;/p>
&lt;pre tabindex="0">&lt;code>Cluster 37: Application heart-of-gold (~1.18.3) is unhealthy.
&lt;/code>&lt;/pre>&lt;p>The following diff (under a &lt;code>template&lt;/code> block) accomplishes that:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-diff" data-lang="diff">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">- {{if eq .serviceType &amp;#34;slack&amp;#34;}}:interrobang:{{end}} Cluster &amp;lt;{{.context.argocdUrl}}|*{{.context.clusterId}}*&amp;gt;: Application &amp;lt;{{.context.argocdUrl}}/applications/{{.app.metadata.name}}|`{{.app.metadata.name}}`&amp;gt; _sync_ by {{.app.status.operationState.operation.initiatedBy.username | default &amp;#34;_automation_&amp;#34; }} is _unknown_.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">&lt;/span>&lt;span style="color:#98c379;font-weight:bold">+ {{if eq .serviceType &amp;#34;slack&amp;#34;}}:interrobang:{{end}} Cluster &amp;lt;{{.context.argocdUrl}}|*{{.context.clusterId}}*&amp;gt;: Application &amp;lt;{{.context.argocdUrl}}/applications/{{.app.metadata.name}}|`{{.app.metadata.name}}`&amp;gt;{{if .app.spec.source.targetRevision}} ({{.app.spec.source.targetRevision}}){{else}}{{range .app.spec.sources}}{{if .targetRevision}} ({{.targetRevision}}){{break}}{{end}}{{end}}{{end}} _sync_ by {{.app.status.operationState.operation.initiatedBy.username | default &amp;#34;_automation_&amp;#34; }} is _unknown_.
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Diving into it with pretty-printing&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-gotemplate" data-lang="gotemplate">{{if .app.spec.source.targetRevision}}
 ({{.app.spec.source.targetRevision}})
{{else}}
 {{range .app.spec.sources}}
 {{if .targetRevision}}
 ({{.targetRevision}})
 {{break}}
 {{end}}
 {{end}}
{{end}}
&lt;/code>&lt;/pre>&lt;p>If there&amp;rsquo;s a single source in the helm chart, we extract its &lt;code>targetRevision&lt;/code>.&lt;/p>
&lt;p>Otherwise, when using a &lt;a href="https://argo-cd.readthedocs.io/en/latest/user-guide/multiple_sources/">multi-source
app&lt;/a>, we
extract the first available &lt;code>targetRevision&lt;/code>.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>These are
&lt;a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/applicationset/GoTemplate/">golang&lt;/a>
&lt;a href="https://pkg.go.dev/text/template">templates&lt;/a>.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>JIRA: create an issue with pre-populated fields</title><link>https://perrotta.dev/2025/08/jira-create-an-issue-with-pre-populated-fields/</link><pubDate>Mon, 11 Aug 2025 14:31:09 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/jira-create-an-issue-with-pre-populated-fields/</guid><description>&lt;p>It is somewhat tedious to create issues&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> in JIRA. It is a bloated and complex web
app, slow to load, with a myriad of fields to fill in.&lt;/p>
&lt;p>Most of these input fields do not significantly change when working within a
single team. The common exceptions are the &lt;strong>Summary&lt;/strong> (Issue title) and
&lt;strong>Description&lt;/strong>. Priority and Assignee can be determined later on, during bug
triage.&lt;/p>
&lt;p>It turns out JIRA supports &lt;a href="https://confluence.atlassian.com/jirakb/how-to-create-issues-using-direct-html-links-in-jira-159474.html">creating issues using direct links&lt;/a>.&lt;/p>
&lt;p>The documentation isn&amp;rsquo;t the most user-friendly&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup> but, upon figuring it out, you
can build a URL such as:&lt;/p>
&lt;pre tabindex="0">&lt;code>https://{company}.atlassian.net/secure/CreateIssueDetails!init.jspa?pid={project-id}&amp;amp;issuetype=10003&amp;amp;summary=Component%3A%20Title&amp;amp;description=&amp;amp;customfield_10249=SRE&amp;amp;labels=quick-win
&lt;/code>&lt;/pre>&lt;p>Notes:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Project ID&lt;/strong>: you can figure out which one to use by following their
&lt;a href="https://support.atlassian.com/jira/kb/how-to-get-the-id-of-a-jira-project-from-a-web-browser/">docs&lt;/a>.
&lt;strong>TL;DR&lt;/strong>: Navigate to &lt;code>&amp;lt;JIRA_BASE_URL&amp;gt;/rest/api/latest/project/{project-key}&lt;/code>, wherein
the project key is something such as &lt;code>INFRA&lt;/code> or &lt;code>POPS&lt;/code>. This returns a JSON
object, look for its top-level &lt;code>id&lt;/code> field.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Issue Type&lt;/strong>: 10003 = Story, 10004 = Task. If you want another type, see
&lt;a href="https://support.atlassian.com/jira/kb/finding-the-id-for-issue-types-in-jira-server-or-data-center/">docs&lt;/a>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Summary&lt;/strong> and &lt;strong>Description&lt;/strong> are self-descriptive. They need to be URL-escaped.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>customfield_12345&lt;/code> is for&amp;hellip;well, custom fields. For example, we have a
custom field to track which team the work item is assigned to.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>Bookmark the URL for quick access from your web browser bookmarks bar&lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>, or
perhaps from an app such as &lt;a href="https://www.raycast.com/">RayCast&lt;/a>.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&amp;ldquo;Issues&amp;rdquo; were &lt;a href="https://community.atlassian.com/forums/Jira-articles/It-s-here-Work-is-the-new-collective-term-for-all-items-you/ba-p/2954892">recently
renamed&lt;/a>
to &amp;ldquo;Work items&amp;rdquo;. Do you have an issue with this?&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>Google&amp;rsquo;s &lt;a href="https://developers.google.com/issue-tracker/guides/access-ui">Issue Tracker&lt;/a> (&lt;em>Buganizer&lt;/em>) supports a similar approach. For example, &lt;a href="https://goo.gle/cftbug">https://goo.gle/cftbug&lt;/a> redirects to &lt;a href="https://issues.chromium.org/issues/new?component=1456689&amp;amp;title=Chrome%20for%20Testing:%20&amp;amp;noWizard=true&amp;amp;pli=1&amp;amp;template=0">https://issues.chromium.org/issues/new?component=1456689&amp;amp;title=Chrome%20for%20Testing:%20&amp;amp;noWizard=true&amp;amp;pli=1&amp;amp;template=0&lt;/a> (I created this link back in the &lt;a href="https://goo.gle/chrome-for-testing">CfT&lt;/a> days).&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:3">
&lt;p>I prefer this option. The bookmark label (name) is &lt;code>+&lt;/code>, very mnemonic.&amp;#160;&lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>docker: dive into images</title><link>https://perrotta.dev/2025/08/docker-dive-into-images/</link><pubDate>Mon, 11 Aug 2025 13:20:08 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/docker-dive-into-images/</guid><description>&lt;p>Recently bitnami has &lt;a href="https://github.com/bitnami/charts/issues/35164">pulled the
plug&lt;/a> off their public docker
images offering&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.&lt;/p>
&lt;p>We are relying on their
&lt;a href="https://hub.docker.com/r/bitnami/kubectl">&lt;code>bitnami/kubectl&lt;/code>&lt;/a> image. Now what?&lt;/p>
&lt;p>We could build our own, or use another upstream image. Looking at the &lt;a href="https://hub.docker.com/search?q=kubectl">Docker
Hub&lt;/a> catalog, I was pleased to find
&lt;a href="https://hub.docker.com/r/rancher/kubectl">&lt;code>rancher/kubectl&lt;/code>&lt;/a> (backed by SUSE)
there.&lt;/p>
&lt;p>This is enough for our needs.&lt;/p>
&lt;p>It would have been trivial to build our own image otherwise if needed:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">FROM&lt;/span>&lt;span style="color:#98c379"> alpine:3.22&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">RUN&lt;/span> apk add --no-cache kubectl
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>How can we ensure these images are equivalent, for practical purposes?&lt;/p>
&lt;p>One way is to use &lt;a href="https://github.com/wagoodman/dive">&lt;code>dive&lt;/code>&lt;/a> to introspect
each of them:&lt;/p>
&lt;blockquote>
&lt;p>A tool for exploring each layer in a docker image&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% dive bitnami/kubectl:latest
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% dive rancher/kubectl:v1.30.14
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The rancher image has 50MB in size and contains &lt;em>only&lt;/em> the &lt;code>kubectl&lt;/code> binary.
There&amp;rsquo;s no shell, not even &lt;code>/bin/sh&lt;/code>.&lt;/p>
&lt;p>The bitnami image has 326MB and contains a bunch of other stuff.&lt;/p>
&lt;p>It turns out we will get some (unexpected) efficiency gains out of this
migration!&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Enshittification">&amp;ldquo;&amp;ldquo;&amp;ldquo;Recession&amp;rdquo;&amp;rdquo;&amp;rdquo;&lt;/a>.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Silence unknown callers</title><link>https://perrotta.dev/2025/08/silence-unknown-callers/</link><pubDate>Sat, 09 Aug 2025 18:11:39 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/silence-unknown-callers/</guid><description>&lt;p>I absolutely &lt;strong>never&lt;/strong> get any spam calls. This has been true for &lt;em>many and
many&lt;/em> years now.&lt;/p>
&lt;p>What is the formula to do so? Just be an uninteresting, boring person. Be
invisible. !next&lt;/p>
&lt;p>Sure, this is one way, but let&amp;rsquo;s get more practical and realistic. I have &lt;em>only&lt;/em>
three guidelines, assuming you do not want to live as an hermit&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>:&lt;/p>
&lt;h2 id="1-silence-unknown-callers">1) Silence unknown callers&lt;/h2>
&lt;p>Apple, &lt;a href="https://support.apple.com/en-ca/guide/iphone/iphe4b3f7823/ios">Block or avoid unwanted calls on iPhone&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>You can avoid unwanted calls by identifying callers, blocking certain people,
and sending unknown and spam callers directly to voicemail.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>&lt;strong>Turn on Call Identification&lt;/strong>&lt;/p>
&lt;p>iPhone can help identify incoming calls using information from Apple Business
Connect, supported carriers, and supported call identification apps.&lt;/p>
&lt;p>Go to Settings &amp;gt; Apps &amp;gt; Phone, then tap &amp;ldquo;Silence Unknown Callers&amp;rdquo;.&lt;/p>
&lt;/blockquote>
&lt;p>A must-have.
There&amp;rsquo;s absolutely &lt;em>no reason&lt;/em> to let strangers be able to interrupt you on a
whim.&lt;/p>
&lt;p>This can only work effectively if you do not feel
&lt;a href="https://en.wikipedia.org/wiki/Fear_of_missing_out">FOMO&lt;/a>. My philosophy is: if
there is a pressing matter, people or institutions will make an effort to reach
out, whether by multiple attempts or by employing alternate means (e.g. email?
WhatsApp?) to do so.&lt;/p>
&lt;p>&lt;strong>Exception&lt;/strong>: If you are waiting for a phone call but do not know the origin
number (e.g. from a pharmacy, medical doctor, job interview, prospective
landlord). In this case, turn this setting off temporarily.&lt;/p>
&lt;h2 id="2-disable-most-app-notifications">2) Disable most app notifications&lt;/h2>
&lt;p>There&amp;rsquo;s no reason to let your phone disturb you. It &lt;em>should&lt;/em> be a tool that
&lt;em>you&lt;/em> control, not the other way around. Disable notifications for most apps,
especially social media.&lt;/p>
&lt;p>&lt;strong>Alternatively&lt;/strong>: Enable &lt;a href="https://support.apple.com/en-us/105112">&amp;ldquo;Do Not
Disturb&amp;rdquo;&lt;/a> most of the time. These days
most phones can be configured to enable it on a configurable schedule, or based
on location (e.g. when you&amp;rsquo;re home, or at work).&lt;/p>
&lt;p>&lt;strong>Exception&lt;/strong>: Let your loved ones be able to reach you. iOS has settings to
allow certain apps and/or contacts to bypass DNS. Being reachable by loved ones
doesn&amp;rsquo;t need to entail emergencies only. Note that this only works if this is a
small list. If you decide that you love everyone (noble!), then you&amp;rsquo;ll need a
two-tier love system to decide who you love the most.&lt;/p>
&lt;h2 id="3-protect-your-crown-jewels">3) Protect your Crown Jewels&lt;/h2>
&lt;p>Tate Jarrow, &lt;a href="https://web.archive.org/web/20230204060013/https://onlinesafety.substack.com/p/protect-your-crown-jewels">Protect your Crown
Jewels!&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>[&amp;hellip;] you can reduce the majority of your risk by protecting the handful of
your most important assets – I call these your crown jewels. These are
probably only a fraction of your digital assets, and can be done much more
easily and quickly — so start there.&lt;/p>
&lt;/blockquote>
&lt;p>I rarely hand out my main phone number when signing up for various online
accounts. I don&amp;rsquo;t want to be reachable in the first place (see guideline 1)), so
why expose my number to third parties?&lt;/p>
&lt;p>I have a second phone number that I use only for chat apps (WhatsApp, Telegram,
etc), so that there is no need to leak my main phone number to acquaintances.
And I have a third phone number that I use whenever signup forms make it
mandatory to provide a number and when &amp;ldquo;0000000000&amp;rdquo; or &amp;ldquo;+12131234567&amp;rdquo; or similar
do not work.&lt;/p>
&lt;hr>
&lt;ol start="3">
&lt;li>is the most important. There was a point in my life when I would use my main
phone number for everything. Then I kept getting spam phone calls (and texts). I
would still ignore them anyway (1)) – it feels that I&amp;rsquo;ve been doing so since
forever – but it was annoying to get spammed.&lt;/li>
&lt;/ol>
&lt;p>It&amp;rsquo;s never too late to do 3): you can always get a new phone number and start
over.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;a href="https://pcaro.es/hermit/">Hermit&lt;/a>: One of my favorite monospace fonts,
mind you.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>ArgoCD: recovery when traefik is broken</title><link>https://perrotta.dev/2025/08/argocd-recovery-when-traefik-is-broken/</link><pubDate>Sat, 09 Aug 2025 15:24:53 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/argocd-recovery-when-traefik-is-broken/</guid><description>&lt;p>It&amp;rsquo;s Friday. The best day to push to prod™.
An internal scheduled upgrade for &lt;code>traefik&lt;/code> goes awry.
Internal services are no longer accessible.
HTTP requests won&amp;rsquo;t be properly routed.&lt;/p>
&lt;p>The most sensible SRE / DevOps will simply roll it back. Roll back first,
investigate later: it&amp;rsquo;s crucial to minimize downtime.&lt;/p>
&lt;p>How do we roll back?
We&amp;rsquo;re using GitOps, the most sensible approach is to make a new git commit by
submitting a pull request.
However, this is an emergency situation. Can we roll back faster?&lt;/p>
&lt;p>Sure, let&amp;rsquo;s make temporary changes directly in the cluster.&lt;/p>
&lt;p>The &lt;code>traefik&lt;/code> app is managed with ArgoCD. Let&amp;rsquo;s log in to the ArgoCD web UI and
roll back to the previous version.&lt;/p>
&lt;p>Oh, wait. We can&amp;rsquo;t. The ArgoCD web UI isn&amp;rsquo;t accessible, because traefik is
broken. &lt;em>Sighs&lt;/em>.&lt;/p>
&lt;p>Let&amp;rsquo;s use the ArgoCD CLI then.&lt;/p>
&lt;p>Aaaah, no. The ArgoCD CLI is really a REST client for the ArgoCD API. HTTP(S) is
not accessible, so the CLI won&amp;rsquo;t work either.&lt;/p>
&lt;p>What&amp;rsquo;s next? A plain &lt;code>helm&lt;/code> upgrade should work. But &lt;code>helm&lt;/code> is picky and will
refuse to touch manifests it doesn&amp;rsquo;t own. The manifests are managed by Argo.
&lt;code>helm&lt;/code> won&amp;rsquo;t budge. Oh gosh.&lt;/p>
&lt;p>Last option: the ArgoCD controllers are still running. We don&amp;rsquo;t need the ArgoCD
HTTPS API to communicate with them. Let&amp;rsquo;s simply edit the k8s manifests
directly.&lt;/p>
&lt;p>First we patch the root app (app-of-apps pattern):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>kubectl edit app -n argocd root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>We remove the &lt;code>automated&lt;/code> block, to effectively pause auto sync, otherwise our
subsequent changes to traefik would be immediately reverted:&lt;/p>
&lt;pre tabindex="0">&lt;code>spec:
# automated:
# prune: [..]
# selfHeal: [...]
&lt;/code>&lt;/pre>&lt;p>You can comment or delete the &lt;code>automated:&lt;/code> block, either is fine.&lt;/p>
&lt;p>Next, we need to remove traefik from all application project (app project) sync
windows, so that changes to it will be immediately applied:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>kubectl edit appproject -n argocd cluster
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The traefik entry got removed from all sync windows.&lt;/p>
&lt;p>Now, finally, let&amp;rsquo;s instruct Argo to roll traefik back.&lt;/p>
&lt;p>The broken version is 2.5.1, the previous working version was 2.4.1.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>kubectl edit app -n argocd traefik
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Update &lt;code>targetRevision: 2.4.1&lt;/code> under the &lt;code>helm&lt;/code> block.&lt;/p>
&lt;p>Wait a few seconds. Observe traefik pods as they are rolling restarted:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>kubectl get deploy -n kube-system traefik -w
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Finally, all services are once again accessible!&lt;/p>
&lt;p>From this point on, we can go back to &lt;code>git&lt;/code> and do a proper pull request revert
to reconcile the codebase with the live cluster state.&lt;/p>
&lt;p>This was an interesting exercise. I&amp;rsquo;m quite familiar with ArgoCD and GitOps at
this point, and I instinctively knew what to do in this situation, without
needing to consult the official documentation or even an LLM. I wouldn&amp;rsquo;t have
minded doing either of these if needed, but the point is that it feels good to
be well familiar with how a system works and how to apply your knowledge to fix
day-to-day problems.&lt;/p></description></item><item><title>fd with xargs: filenames with spaces</title><link>https://perrotta.dev/2025/08/fd-with-xargs-filenames-with-spaces/</link><pubDate>Fri, 08 Aug 2025 14:33:27 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/fd-with-xargs-filenames-with-spaces/</guid><description>&lt;p>&lt;strong>Problem statement&lt;/strong>: find all &lt;code>base/mongo&lt;/code> occurrences in &lt;code>kustomization.yaml&lt;/code>
files in the codebase.&lt;/p>
&lt;p>&lt;a href="https://perrotta.dev/2025/04/the-ack--xargs--sed-pattern/">My favorite approach&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% fd kustomization.yaml | ifne xargs -n &lt;span style="color:#d19a66">1&lt;/span> ack &lt;span style="color:#98c379">&amp;#34;base/mongo&amp;#34;&lt;/span> -l
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">[&lt;/span>...&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ack: scaffolding/cookiecutter/base/&lt;span style="color:#56b6c2">{{&lt;/span>: No such file or directory
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ack: cookiecutter.app_name: No such file or directory
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ack: &lt;span style="color:#56b6c2">}}&lt;/span>/kustomization.yaml: No such file or directory
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>But it looks horrible!&lt;/p>
&lt;p>The problem is that there is a file named as follows:&lt;/p>
&lt;pre tabindex="0">&lt;code>scaffolding/cookiecutter/base/{{ cookiecutter.app_name }}/kustomization.yaml
&lt;/code>&lt;/pre>&lt;p>&amp;hellip;more specifically, the spaces are the problem. It&amp;rsquo;s easy to fix it though:&lt;/p>
&lt;pre tabindex="0">&lt;code>% fd -0 kustomization.yaml | ifne xargs -0 -n 1 ack &amp;#34;base/mongo&amp;#34; -l
&lt;/code>&lt;/pre>&lt;p>&amp;hellip;adding &lt;code>-0&lt;/code> to &lt;code>fd&lt;/code> instructs it to print the results null-separated (&lt;code>\0&lt;/code>)
instead of newline (&lt;code>\n&lt;/code>) separated. And the corresponding switch in &lt;code>xargs&lt;/code>
instructs it to expect null-separated input.&lt;/p>
&lt;p>I especially like this approach because it&amp;rsquo;s easy to memorize.&lt;/p></description></item><item><title>GitHub: set up scheduled reminders on Slack</title><link>https://perrotta.dev/2025/08/github-set-up-scheduled-reminders-on-slack/</link><pubDate>Tue, 05 Aug 2025 12:03:10 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/github-set-up-scheduled-reminders-on-slack/</guid><description>&lt;p>If your organization uses GitHub and Slack, it&amp;rsquo;s neat to have daily
notifications be delivered to you, to remind you of pending pull request
reviews.&lt;/p>
&lt;p>How to configure: start from &lt;a href="https://github.com/settings/reminders">https://github.com/settings/reminders&lt;/a>. There will be
an entry in &amp;ldquo;Available organizations&amp;rdquo;. Click (+) &amp;ldquo;Configure reminder&amp;rdquo;.&lt;/p>
&lt;p>In the next screen (&lt;code>https://github.com/settings/reminders/{organization}&lt;/code>),
you&amp;rsquo;ll need to authorize the slack workspace integration.&lt;/p>
&lt;p>Once that is done, pick your settings. I like:&lt;/p>
&lt;ul>
&lt;li>Weekdays&lt;/li>
&lt;li>Times: 09:00 AM in your local timezone&lt;/li>
&lt;li>Check off &amp;ldquo;Review requests assigned to you&amp;rdquo;&lt;/li>
&lt;li>Optionally check off &amp;ldquo;Review requests assigned to your team&amp;rdquo; (I leave this
disabled as it&amp;rsquo;s too noisy)&lt;/li>
&lt;li>Check off &amp;ldquo;Enable real-time alerts for pull requests&amp;rdquo;
&lt;ul>
&lt;li>Then check off all checkboxes under it except &amp;ldquo;Your team&amp;rsquo;s pull request
review is requested&amp;rdquo; (no team notifications) and Your pull request has
failed checks (CI is too noisy).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>Now, once a weekday, the github app will slack you messages like these:&lt;/p>
&lt;pre tabindex="0">&lt;code>Reviews assigned to you on {org}/gitops
[gitops#13172] Forget the old RabbitMQ instance (jason-bourne)
 2 hours stale · 2 hours old · Waiting on @Thiago Perrotta, SRE

Reviews assigned to you on {org}/secret-project
[secret-project#49852] Deploy Container: Mooney&amp;#39;s proxy (joe-goldberg)
 5 days stale · 6 days old · Waiting on @Love Quinn
&lt;/code>&lt;/pre>&lt;p>Be kind to your teammates. Don&amp;rsquo;t leave them blocked on your reviews for more
than 24 hours!&lt;/p></description></item><item><title>terraform: bypass lock</title><link>https://perrotta.dev/2025/08/terraform-bypass-lock/</link><pubDate>Mon, 04 Aug 2025 11:49:16 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/terraform-bypass-lock/</guid><description>&lt;p>Terraform supports &lt;a href="https://developer.hashicorp.com/terraform/language/state/locking">state
locking&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>If supported by your backend, Terraform will lock your state for all
operations that could write state. This prevents others from acquiring the
lock and potentially corrupting your state.&lt;/p>
&lt;/blockquote>
&lt;p>Neat, right?&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% op run --env-file&lt;span style="color:#56b6c2">=&lt;/span>.env -- terraform plan
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>╷
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Error: Error acquiring the state lock
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Error message: operation error S3: PutObject, https response error
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ StatusCode: 412, RequestID: &lt;span style="color:#56b6c2">{&lt;/span>redacted&lt;span style="color:#56b6c2">}&lt;/span>, HostID:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ &lt;span style="color:#56b6c2">{&lt;/span>redacted&lt;span style="color:#56b6c2">}&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ api error PreconditionFailed: At least one of the pre-conditions you
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ specified did not hold
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Lock Info:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ ID: &lt;span style="color:#56b6c2">{&lt;/span>redacted&lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Path: &lt;span style="color:#56b6c2">{&lt;/span>redacted&lt;span style="color:#56b6c2">}&lt;/span>/chartmuseum.tfstate
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Operation: OperationTypePlan
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Who: &lt;span style="color:#56b6c2">{&lt;/span>redacted&lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Version: 1.10.5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Created: 2025-08-04 09:46:55.995791 +0000 UTC
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Info:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Terraform acquires a state lock to protect the state from being written
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ by multiple users at the same time. Please resolve the issue above and try
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ again. For most commands, you can disable locking with the &lt;span style="color:#98c379">&amp;#34;-lock=false&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ flag, but this is not recommended.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>It even uses a custom &lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status/412">HTTP
Status&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>The HTTP 412 Precondition Failed&lt;/strong> &lt;em>client error response status code&lt;/em>
indicates that access to the target resource was denied. This happens with
conditional requests on methods other than GET or HEAD when the condition
defined by the If-Unmodified-Since or If-Match headers is not fulfilled. In
that case, the request (usually an upload or a modification of a resource)
cannot be made and this error response is sent back.&lt;/p>
&lt;/blockquote>
&lt;p>If you&amp;rsquo;re sure no one else is working on that workspace, you can proceed with
&lt;code>-lock=false&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% op run --env-file&lt;span style="color:#56b6c2">=&lt;/span>.env -- terraform plan -lock&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#e5c07b">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uptime_check_http.chartmuseum: Refreshing state... &lt;span style="color:#56b6c2">[&lt;/span>&lt;span style="color:#e06c75">name&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>chartmuseum&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>data.aws_availability_zones.available: Reading...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>data.aws_availability_zones.available: Read &lt;span style="color:#e5c07b">complete&lt;/span> after 1s &lt;span style="color:#56b6c2">[&lt;/span>&lt;span style="color:#e06c75">id&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>us-east-1&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">[&lt;/span>...&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>That&amp;rsquo;s an one-off. A subsequent run without that argument will fail again:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% op run --env-file&lt;span style="color:#56b6c2">=&lt;/span>.env -- terraform plan
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>╷
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>│ Error: Error acquiring the state lock
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">[&lt;/span>...&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>In this case it would be better to simply remove the lock with
&lt;a href="https://developer.hashicorp.com/terraform/language/state/locking#force-unlock">&lt;code>force-unlock&lt;/code>&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% op run --env-file&lt;span style="color:#56b6c2">=&lt;/span>.env -- terraform force-unlock &lt;span style="color:#56b6c2">{&lt;/span>lock-id&lt;span style="color:#56b6c2">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Do you really want to force-unlock?
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Terraform will remove the lock on the remote state.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> This will allow &lt;span style="color:#e5c07b">local&lt;/span> Terraform commands to modify this state, even though it
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> may still be in use. Only &lt;span style="color:#98c379">&amp;#39;yes&amp;#39;&lt;/span> will be accepted to confirm.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Enter a value: yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Terraform state has been successfully unlocked!
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>The state has been unlocked, and Terraform commands should now be able to
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>obtain a new lock on the remote state.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>lock-id&lt;/code> can be obtained from the &lt;code>plan&lt;/code> output.&lt;/p>
&lt;p>Now we can &lt;code>plan&lt;/code> as usual:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% op run --env-file&lt;span style="color:#56b6c2">=&lt;/span>.env -- terraform plan
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uptime_check_http.chartmuseum: Refreshing state... &lt;span style="color:#56b6c2">[&lt;/span>&lt;span style="color:#e06c75">name&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>chartmuseum&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>data.aws_availability_zones.available: Reading...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>data.aws_availability_zones.available: Read &lt;span style="color:#e5c07b">complete&lt;/span> after 0s &lt;span style="color:#56b6c2">[&lt;/span>&lt;span style="color:#e06c75">id&lt;/span>&lt;span style="color:#56b6c2">=&lt;/span>us-east-1&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">[&lt;/span>...&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Dune 2000 soundtrack</title><link>https://perrotta.dev/2025/08/dune-2000-soundtrack/</link><pubDate>Mon, 04 Aug 2025 11:32:06 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/dune-2000-soundtrack/</guid><description>&lt;p>In my humble opinion, the original soundtrack (OST) of the
&lt;a href="https://dune2k.com/Duniverse/">dune2k&lt;/a> videogame is one of the best to listen
to while coding.&lt;/p>
&lt;p>&lt;a href="https://music.youtube.com/watch?v=l_yuGtZ9U0Y&amp;amp;list=RDAMVMl_yuGtZ9U0Y">YouTube
Music&lt;/a>.&lt;/p>
&lt;p>&lt;em>Long live the fighters!&lt;/em>&lt;/p></description></item><item><title>Block "Sign in to XXX with google.com"</title><link>https://perrotta.dev/2025/08/block-sign-in-to-xxx-with-google.com/</link><pubDate>Sat, 02 Aug 2025 21:26:25 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/block-sign-in-to-xxx-with-google.com/</guid><description>&lt;p>Jeff Johnson, &lt;a href="https://underpassapp.com/news/2025/7/5.html">Sign in with Google in Chrome&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>Many websites such as Yelp show an annoying &amp;ldquo;Sign in with Google&amp;rdquo; banner when
you visit.&lt;/p>
&lt;p>&lt;img src="https://underpassapp.com/news/2025/7/5-images/Safari.png" alt="Sign in with Google
banner">&lt;/p>
&lt;p>This is what Google calls the One Tap user experience. Fortunately, my web
browser extension StopTheMadness Pro hides &amp;ldquo;Sign in with Google&amp;rdquo; banners.&lt;/p>
&lt;/blockquote>
&lt;p>Annoying is an understatement.&lt;/p>
&lt;blockquote>
&lt;p>Although Chrome avoids the &amp;ldquo;Sign in with Google&amp;rdquo; banners, Google&amp;rsquo;s browser
still has its own custom annoyance. If you&amp;rsquo;re already signed in to your Google
account when you visit a participating website such as Yelp, Chrome will
display a One Tap dialog.&lt;/p>
&lt;/blockquote>
&lt;p>Jeff helpfully points out how to block these banners in Google Chrome:&lt;/p>
&lt;ul>
&lt;li>Navigate to &lt;code>chrome://settings/content/federatedIdentityApi&lt;/code>&lt;/li>
&lt;li>Switch the default behavior to &amp;ldquo;Block sign-in prompts from identity services&amp;rdquo;&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>If the courts and antitrust regulators are reading—they probably won&amp;rsquo;t read my
blog, but one can dream—this is yet another example of Google advantaging its
own browser Chrome over other web browsers.&lt;/p>
&lt;/blockquote></description></item><item><title>ArgoCD: all applications stuck on refresh</title><link>https://perrotta.dev/2025/08/argocd-all-applications-stuck-on-refresh/</link><pubDate>Fri, 01 Aug 2025 14:30:58 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/argocd-all-applications-stuck-on-refresh/</guid><description>&lt;p>The problem is very likely the Application Controller.&lt;/p>
&lt;p>You can restart it:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>kubectl rollout restart sts -n argocd argocd-application-controller
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Or inspect its logs:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>kubectl logs -n argocd argocd-application-controller-0 --tail&lt;span style="color:#56b6c2">=&lt;/span>&lt;span style="color:#d19a66">100&lt;/span> | less
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>While we&amp;rsquo;re here, make sure there is at least one replica running:&lt;/p>
&lt;pre tabindex="0">&lt;code>% kubectl get sts -n argocd argocd-application-controller
NAME READY AGE
argocd-application-controller 1/1 415d
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://github.com/argoproj/argo-cd/issues/11831">Upstream issue&lt;/a>.&lt;/p></description></item><item><title>PR reviews after vacation</title><link>https://perrotta.dev/2025/08/pr-reviews-after-vacation/</link><pubDate>Fri, 01 Aug 2025 02:15:02 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/08/pr-reviews-after-vacation/</guid><description>&lt;p>You send in a couple of pull requests for your teammates to review.&lt;/p>
&lt;p>Then you go on a break. Vacation. Time-off. Holiday. PTO. Pleasure has many
names.&lt;/p>
&lt;p>They had a lot of time to review your PRs. Surely there will be various comments
by the time you&amp;rsquo;re back, right?&lt;/p>
&lt;p>Several action items to be addressed. You&amp;rsquo;re already excited to &lt;del>move
mountains&lt;/del> move more protos, eh?!&lt;/p>
&lt;p>Certainly you will be 100% (&lt;em>hundred per-cent!&lt;/em>) unblocked the first day you&amp;rsquo;re
back to work, correct!?&lt;/p>
&lt;p>There will be no need to &amp;ldquo;friendly&amp;rdquo; ping anyone. Aaaah, so peaceful. So
productive. Corporate paradise.&lt;/p>
&lt;p>Do we live in the same world?&lt;/p>
&lt;hr>
&lt;h3 id="master-foo-and-the-absent-pull-requests1">Master Foo and the Absent Pull Requests&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/h3>
&lt;p>A novice once sent two pull‑requests before departing for a long holiday.&lt;/p>
&lt;p>Upon their return they asked the Master, &amp;ldquo;Have my PRs been reviewed?&amp;rdquo;&lt;/p>
&lt;p>The Master sat quietly. At last he said, &amp;ldquo;I sent no pings.&amp;rdquo;&lt;/p>
&lt;p>The novice frowned and said, &amp;ldquo;But my colleagues had all the time. There must be comments, requests, feedback.&amp;rdquo;&lt;/p>
&lt;p>The Master looked at the floor and replied, &amp;ldquo;What is unreviewed code?&amp;rdquo;&lt;/p>
&lt;p>The novice said nothing.&lt;/p>
&lt;p>Then the Master added: &amp;ldquo;What is urgent code that never landed?&amp;rdquo;&lt;/p>
&lt;p>An instant later, the novice was enlightened.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;em>Prompt&lt;/em>: Write an &amp;ldquo;unix koan&amp;rdquo; out of this.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>direnv: automatically load .env everywhere</title><link>https://perrotta.dev/2025/07/direnv-automatically-load-.env-everywhere/</link><pubDate>Thu, 31 Jul 2025 14:26:37 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/07/direnv-automatically-load-.env-everywhere/</guid><description>&lt;p>&lt;a href="https://perrotta.dev/2024/08/direnv-nested/">Previously&lt;/a>,
&lt;a href="https://perrotta.dev/2025/03/1password-cli--direnv-integration/">previously&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Problem statement&lt;/strong>: Given a monorepo with various scattered &lt;code>.env&lt;/code> files, how
to ensure each one of them is automatically loaded when changing directories?&lt;/p>
&lt;p>We could create sibling &lt;code>.envrc&lt;/code> files in each directory, with the following
content:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e">#!/bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#7f848e">&lt;/span>dotenv
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://direnv.net/man/direnv-stdlib.1.html#codedotenv-ltdotenvpathgtcode">Documentation&lt;/a>.&lt;/p>
&lt;p>But this is cumbersome!&lt;/p>
&lt;p>Also, perhaps your teammates simply do not want to use direnv.&lt;/p>
&lt;p>Here&amp;rsquo;s a more robust approach:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>% cat ~/.config/direnv/direnv.toml
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">[&lt;/span>global&lt;span style="color:#56b6c2">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e06c75">load_dotenv&lt;/span> &lt;span style="color:#56b6c2">=&lt;/span> &lt;span style="color:#e5c07b">true&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This ensures every &lt;code>.env&lt;/code> file is automatically loaded. No need to splatter
&lt;code>dotenv&lt;/code> everywhere!&lt;/p>
&lt;p>I have accidentally discovered this is possible via &lt;a href="https://github.com/direnv/direnv/issues/1478">this
issue&lt;/a>.&lt;/p></description></item><item><title>Writing blog posts on the go</title><link>https://perrotta.dev/2025/07/writing-blog-posts-on-the-go/</link><pubDate>Tue, 29 Jul 2025 13:23:10 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/07/writing-blog-posts-on-the-go/</guid><description>&lt;p>By design, and to introduce intentional friction, I am only allowed to blog with
a laptop. A new post necessarily involves a git commit of a new markdown file.&lt;/p>
&lt;p>Lately I&amp;rsquo;ve been experimenting with writing blog posts on the go. From my phone,
I simply open the Notes app and start to write.&lt;/p>
&lt;p>Text (and hypertext) is the only medium I need. The occasional markup is also
fine.&lt;/p>
&lt;p>It is harder to write technical posts on the go though. This is not necessarily
a caveat: it means I can focus instead on writing non-technical posts, like this
one. This is akin to how non-fiction books are better suited for audiobooks than
fiction ones. Sometimes form (and medium) shapes content.&lt;/p>
&lt;p>The draft notes are then eventually transcribed to Markdown and published.&lt;/p></description></item><item><title>Okta: enroll into 2FA</title><link>https://perrotta.dev/2025/07/okta-enroll-into-2fa/</link><pubDate>Sun, 27 Jul 2025 18:49:30 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/07/okta-enroll-into-2fa/</guid><description>&lt;p>More specifically, enroll into 2FA other than
&lt;a href="https://en.wikipedia.org/wiki/One-time_password">OTP&lt;/a>.&lt;/p>
&lt;ul>
&lt;li>Log into https://{company}.okta.com/&lt;/li>
&lt;li>Go to Settings (https://{company}.okta.com/enduser/settings)&lt;/li>
&lt;li>Under &amp;ldquo;Security Key or Biometric Authenticator&amp;rdquo;, click &amp;ldquo;Set up another&amp;rdquo;&lt;/li>
&lt;li>From this point, you could add &lt;em>either&lt;/em>:
&lt;ul>
&lt;li>a hardware security key (e.g. &lt;a href="https://www.yubico.com/">YubiCo&lt;/a>)&lt;/li>
&lt;li>a &lt;a href="http://passkeys.dev/">passkey&lt;/a>, which will be stored in your password
manager, iCloud Keychain (Apple devices) or web browser profile&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>A hardware security key needs to be plugged in during authentication, when it
needs to be gently tapped.&lt;/p>
&lt;p>A passkey does not require external hardware, but it requires you to be logged
into wherever it is stored (e.g. your password manager or your Apple ID).&lt;/p>
&lt;p>What is the motivation to do this?&lt;/p>
&lt;p>Previously, I would need to open up my laptop lid to touch ID, which is quite
inconvenient in clamshell mode (i.e. with the laptop lid closed).&lt;/p>
&lt;p>Now, touching the security key or signing in with the passkey eliminates the
need to do so.&lt;/p></description></item><item><title>Smartwatches</title><link>https://perrotta.dev/2025/07/smartwatches/</link><pubDate>Sat, 26 Jul 2025 12:30:57 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/07/smartwatches/</guid><description>&lt;p>Kev Quirk, &lt;a href="https://kevquirk.com/blog/i-don-t-see-the-point-of-smartwatches">I Don&amp;rsquo;t See the Point of
Smartwatches&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>Whether it&amp;rsquo;s Apple, Samsung, Google, Garmin, or any other &lt;em>smartwatch&lt;/em>
brand—they&amp;rsquo;re all utterly pointless as watches, in my opinion. Let&amp;rsquo;s call them
what they are: not &lt;em>smart watches&lt;/em>, but &lt;em>wrist phones&lt;/em>.&lt;/p>
&lt;p>[&amp;hellip;]&lt;/p>
&lt;p>&lt;strong>What are they good for?&lt;/strong>&lt;/p>
&lt;p>Activity tracking. That&amp;rsquo;s it.&lt;/p>
&lt;/blockquote>
&lt;p>I second this.&lt;/p>
&lt;p>Having used various smartwatches throughout the years&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>, eventually I &amp;ldquo;downgraded&amp;rdquo;
to a &amp;ldquo;dumb&amp;rdquo; / vanilla / plain watch.&lt;/p>
&lt;p>It &lt;a href="https://en.wikipedia.org/wiki/Unix_philosophy">does one thing, and does it
well&lt;/a>: it is a reliable
timekeeper!&lt;/p>
&lt;p>There&amp;rsquo;s no need to charge it. It just works. Technology™.&lt;/p>
&lt;p>Why are smartwatches inconvenient (not so great, if you will)? Because they
create more problems than they solve:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>They need to be &lt;strong>constantly charged&lt;/strong>. The upscale ones (e.g. Apple Watch) need
to be charged &lt;em>every single day&lt;/em>. Fitness tracker models need to be juiced
&lt;em>every week&lt;/em>, but that&amp;rsquo;s still quite frequent. The situation will change if
there&amp;rsquo;s ever a smartwatch that needs charging &lt;em>every month&lt;/em>, comparable to
e-book readers (e.g. the Kindle Paperwhite). It&amp;rsquo;s just much more practical not
to have to worry about charging.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Notifications&lt;/strong>. They are supposedly a feature, but we&amp;rsquo;re already so
bombarded with notifications on our phones and laptops all the time. Do we
really need yet another device to bring hourly anxiety to our lives, which are
already too busy and digital? There&amp;rsquo;s a way to partially address this, other
than simply disabling all notifications on the watch: get a fitness tracker
instead. Our attention span is already not so great nowadays; let&amp;rsquo;s not make
it even worse.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Durability&lt;/strong>. I assure you: regardless of whatever model you get today, in
two or three years from now you&amp;rsquo;ll feel
&lt;a href="https://en.wikipedia.org/wiki/Fear_of_missing_out">FOMO&lt;/a> when a newer version
gets released. Back when I owned them, don&amp;rsquo;t think I&amp;rsquo;ve ever kept a smartwatch
for more than 1-2 years. Sure, you can sell them, instead of simply disposing
of them; nonetheless, they will still lose a lot of their MSRP value, and
their maximum battery capacity will be reduced. They are not meant to
&lt;a href="https://en.wikipedia.org/wiki/Enshittification">last&lt;/a>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Security&lt;/strong>: If you have a dumb watch, you can travel pretty much anywhere
without worrying much about it getting stolen. It will likely not attract a
lot of attention in the first place; but, even if it gets stolen, it could be
easily replaced. Whereas a smartwatch tends to be flashier and more expensive
to replace. I used to intentionally leave my smartwatch at home when
travelling to more dangerous places (relatively speaking) – but then, what&amp;rsquo;s
the point of having one, right?&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>Earlier this year I was quite excited about the new
&lt;a href="https://store.repebble.com/">Pebble&lt;/a> watches. They were supposed to address
most of the aforementioned issues:&lt;/p>
&lt;blockquote>
&lt;p>For those unfamiliar with Pebble, it&amp;rsquo;s an e-paper smartwatch with simple
functionality, long battery life and a fun, quirky design. It first launched
on Kickstarter in 2012. The company was sold in 2016 to Fitbit. In January
2025, Google graciously open sourced PebbleOS, enabling anyone to build upon
the amazing Pebble software foundation.&lt;/p>
&lt;/blockquote>
&lt;p>Then, once their feature list got announced, my enthusiasm vanished. It doesn&amp;rsquo;t
feel that special anymore, especially not for the price point they&amp;rsquo;re asking.
Back in 2015-2016 I got a used Pebble Time for about $60. Now they&amp;rsquo;re trying to
sell a new model for $149. It simply doesn&amp;rsquo;t seem worth it.&lt;/p>
&lt;p>In the meantime, I&amp;rsquo;ll keep wearing my good ol&amp;rsquo; plain watch.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Pebble Time, Fitbit Blaze, Fitbit Charge 2 (or 3?), Apple Watch SE, Fitbit
Inspire 2, Garmin.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>vim: add word to spellchecker</title><link>https://perrotta.dev/2025/07/vim-add-word-to-spellchecker/</link><pubDate>Sat, 26 Jul 2025 12:13:42 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/07/vim-add-word-to-spellchecker/</guid><description>&lt;p>When you have the spellchecker from &lt;code>vim&lt;/code> turned on (&lt;code>:set spell&lt;/code>), it
highlights words that are not in the dictionary.&lt;/p>
&lt;p>False positives will occasionally be flagged.&lt;/p>
&lt;p>To
&lt;a href="https://superuser.com/questions/133208/how-to-make-vim-spellcheck-remember-a-new-word">add&lt;/a>
the current word under the cursor to the dictionary, hit &lt;code>zg&lt;/code>. From the &lt;code>vim&lt;/code>
manual:&lt;/p>
&lt;blockquote>
&lt;p>To add words to your own word list:&lt;/p>
&lt;p>zg Add word under the cursor as a good word to the first
name in &amp;lsquo;spellfile&amp;rsquo;. A count may precede the command
to indicate the entry in &amp;lsquo;spellfile&amp;rsquo; to be used. A
count of two uses the second entry.&lt;/p>
&lt;/blockquote>
&lt;p>Once you do so, you&amp;rsquo;ll see feedback text in the status bar:&lt;/p>
&lt;pre tabindex="0">&lt;code>Word &amp;#39;hacky&amp;#39; added to ~/.vim/spell/en.utf-8.add
&lt;/code>&lt;/pre>&lt;p>This file can be easily tracked in your dotfiles.&lt;/p>
&lt;pre tabindex="0">&lt;code>Word &amp;#39;dotfiles&amp;#39; added to ~/.vim/spell/en.utf-8.add
&lt;/code>&lt;/pre></description></item><item><title>Bicycle: replacing an inner tube</title><link>https://perrotta.dev/2025/07/bicycle-replacing-an-inner-tube/</link><pubDate>Fri, 25 Jul 2025 12:48:43 +0200</pubDate><author>serendipity@perrotta.dev (Thiago Perrotta)</author><guid>https://perrotta.dev/2025/07/bicycle-replacing-an-inner-tube/</guid><description>&lt;p>Flat tires happen sooner or later&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>; in my case, every few months.&lt;/p>
&lt;p>You can either patch (fix) the existing inner tube, or replace it with a new one
(&amp;lt;5€). In this post, &lt;a href="https://www.youtube.com/watch?v=T0F_hibWHlU">patching&lt;/a> is
out of scope.&lt;/p>
&lt;p>I keep forgetting the right technique to do so, hence here are a few notes.&lt;/p>
&lt;p>Whenever time is pressing or patience is low, just pay someone to do it for you.
In my experience, in Germany, the labor costs ~15-20€. For example, it&amp;rsquo;s
possible to do it at &lt;a href="https://www.decathlon.de/">Decathlon&lt;/a>, though typically
only during weekdays. With that said, it&amp;rsquo;s more economical (and satisfying!) to
do it yourself.&lt;/p>
&lt;p>&lt;strong>Sequence&lt;/strong>: (inner) tube -&amp;gt; wheel (rim) -&amp;gt; tire (or tyre)&lt;/p>
&lt;p>&lt;strong>Tools&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>2 tire levelers. It&amp;rsquo;s possible to do it with a single one, but it&amp;rsquo;s harder.&lt;/li>
&lt;li>A pump. It&amp;rsquo;s possible to postpone filling the tube to the end, but it&amp;rsquo;s
slightly harder.&lt;/li>
&lt;/ul>
&lt;h2 id="remove-the-tube">Remove the tube&lt;/h2>
&lt;p>&lt;a href="https://www.youtube.com/shorts/YpP9qi5fawU">Video&lt;/a>.&lt;/p>
&lt;p>This is the easier step.&lt;/p>
&lt;p>One tire lever is enough.&lt;/p>
&lt;p>Hold the lever facing away from you, insert it in the right orientation, and
then slide it alongside the tire.&lt;/p>
&lt;h2 id="get-the-right-tube">Get the right tube&lt;/h2>
&lt;p>&lt;a href="https://www.insportline.eu/advisor/168-how-to-pick-the-correct-tire-and-tube-size">How To Pick the Correct Tire and Tube Size?&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Tire size&lt;/strong> is mainly given in inches, with the tires being made in diameters of 12, 14, 16, 18, 20, 22, 24, 26, 27.5, &lt;strong>28&lt;/strong> and 29 inches.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>&lt;strong>700&lt;/strong>: This denotes the wheel diameter, specifically 700c, which is a common
size for road, hybrid, and gravel bikes. In the ISO/ETRTO system, this
corresponds to a 622 mm bead seat diameter.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://www.bicycling.com/repair/a20048610/the-difference-between-a-schrader-valve-and-a-presta/">Types of Bike Tire Valves Available&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>Bicycles typically come with one of two types of valves. Schrader valves are
the most common; they&amp;rsquo;re the same as those used on cars and are found on many
inexpensive bike models. Most higher-end bicycle tires use Presta, a valve
specifically designed for bikes. Here&amp;rsquo;s how to tell the difference:&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>You can put a Presta-specific tube in a rim drilled for Schrader valves, but
it&amp;rsquo;s not advisable for anything more than an emergency fix. Tubes and tires
tend to move slightly on the rim.&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;strong>Schrader&lt;/strong>: most common, thicker. Harder to deflate (need a thin, pointy
object to press down its inner pin).&lt;/li>
&lt;li>Presta: thinner, with a nut at its tip, more modern. Easier to deflate (just
press down its tip).&lt;/li>
&lt;/ul>
&lt;p>There&amp;rsquo;s also another type called &amp;ldquo;Dunlop&amp;rdquo;, it has similar thickness to
Schrader.&lt;/p>
&lt;p>My air pump supports both valve types.&lt;/p>
&lt;h2 id="insert-the-tube">Insert the tube&lt;/h2>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=tnP6coXzbLY">Video&lt;/a>.&lt;/p>
&lt;p>First of all: pay attention to the rotation direction of the wheel and the tire:
they
&lt;a href="https://www.reddit.com/r/bikewrench/comments/q61zqa/how_much_does_the_rotation_direction_matter_in/">should&lt;/a>
align. You only commit this mistake once.&lt;/p>
&lt;p>I have more luck by slightly inflating the tube first, and then inserting it in
the wheel (start with the valve). Afterwards, insert the tire in the wheel,
wrapping up the tube.&lt;/p>
&lt;p>Inserting the tire first, before the tube, yields failure and despair more often
than I would like.&lt;/p>
&lt;p>Do not inflate the tube too much, otherwise it becomes quite hard to add the
tire around it.&lt;/p>
&lt;p>Once everything is done, fill in the tube. Pay attention to how much air to pump
in.&lt;/p>
&lt;p>See also: &lt;a href="https://www.youtube.com/watch?v=hKvnaQ_9nG0">How to change an inner
tube&lt;/a> end-to-end
(&lt;a href="https://www.evanscycles.com/buying-guides/inner-tubes">via&lt;/a>).&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>And even sooner than &lt;a href="https://en.wikipedia.org/wiki/Meet_Joe_Black">death and taxes&lt;/a>.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item></channel></rss>